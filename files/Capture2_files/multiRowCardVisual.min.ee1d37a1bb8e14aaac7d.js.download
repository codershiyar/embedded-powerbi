"use strict";
this.parseTimeMarkers = this.parseTimeMarkers || {};
var marker = this.parseTimeMarkers['multiRowCardVisual.min.js'] || (this.parseTimeMarkers['multiRowCardVisual.min.js'] = {});
marker.startEval = window.jsCommon && window.jsCommon.performance && window.jsCommon.performance.now ? window.jsCommon.performance.now() : Date.now(); marker.isExternal = false;
if (window.perfTracking && window.perfTracking.startBundleEval) window.perfTracking.startBundleEval('multiRowCardVisual.min.js');var es6,powerbi,__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,i=1,a=arguments.length;i<a;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};!function(j){var B,d,k,t,e,l,H,o,U,A,z,W,r,n,a,s,i;function c(t,e){this.applyParams(!0,t,e)}function K(t){this.isInteractivityOverflowHidden=!1,t&&(this.interactivityEnabled=t.interactivityEnabled,this.behavior=t.behavior)}function u(t){t.append("div").classed("imgCon",!0).append("img")}function g(t,e){t.selectAll(".imgCon").styles({height:p(e.maxHeight)}).selectAll("img").styles({"max-height":p(e.maxHeight),"max-width":p(e.maxWidth)})}function p(t){return t+"px"}B=j.visuals||(j.visuals={}),d=j.visuals.builder,k=j.visuals.KpiUtil.getKpiImageMetadata,t=jsCommon.CssConstants.createClassAndSelector,e=j.visuals.LoadMoreDataStatus,l=jsCommon.PixelConverter,H=jsCommon.UrlUtils,o=jsCommon.CssConstants,U=B.Font.Family.semibold.css,A=B.Font.Family.regular.css,z="foregroundNeutralSecondaryAlt",W="foregroundNeutralTertiary",r=B.outline.none,n=B.outline.leftOnly,a=t("row"),s=":tabbable",c.prototype.applyParams=function(t,e,i){t?(this.weight=null==e?0:e,this.color=null==i?"black":i):(this.weight=0,this.color="black")},c.prototype.getCSS=function(){var t=[];return _.isNumber(this.weight)&&(t.push(this.weight+"px"),this.color&&t.push(this.color),t.push("solid")),t.join(" ")},i=c,K.prototype.init=function(t){this.options=t,this.style=t.style,this.featureSwitches=t.featureSwitches;var e=this.currentViewport=t.viewport,i=t.interactivity,i=(i&&"hidden"===i.overflow&&(this.isInteractivityOverflowHidden=!0),this.featureSwitches.multiRowCardSelection&&this.interactivityEnabled&&this.behavior&&(this.interactivityService=B.createInteractivityService(t.host)),this.element=$("<div></div>").addClass(K.MultiRowCardRoot.class).css({height:p(e.height)}));t.element.append(i),this.initializeCardRowSelection()},K.prototype.destroy=function(){this.listView&&this.listView.destroy()},K.prototype.onDataChanged=function(t){var e,i,a,o=this,r=t.dataViews;r&&0<r.length?(e=(r=this.dataView=r[0]).table.columns,i=r.table.rows,t=t.operationKind!==j.VisualDataChangeOperationKind.Append,a=this.data=K.converter(r,e.length,i.length,this.style,this.options.host,this.isInteractivityOverflowHidden),this.setCardDimensions(),this.listView.data(a.dataModel,function(t){return a.dataModel.indexOf(t)},t)):(this.listView.empty(),this.data={dataModel:[],dataColumnCount:0,cardTitleSettings:B.DataLabelViewModel.getDefaultLabelSettings({show:!0,labelColor:(r=function(t){return B.ColorHelper.getThemeColor(o.style,t)})(z),fontSize:13,fontFamily:U,style:this.style,textClassName:"dataTitle"}),categoryLabelsSettings:B.DataLabelViewModel.getDefaultLabelSettings({show:!0,labelColor:r(W),fontSize:9,fontFamily:A,style:this.style,textClassName:"largeLightLabel"}),dataLabelsSettings:B.DataLabelViewModel.getDefaultLabelSettings({show:!0,labelColor:r(B.ForegroundColorName),fontSize:10,fontFamily:A,style:this.style,textClassName:"largeLabel"}),cardSettings:K.getCardSettings(null,this.style)}),this.dataLabelHeight=l.toString(j.TextMeasurementService.estimateSvgTextHeight(B.FontProperties.toTextProperties(this.data.dataLabelsSettings.fontProperties))),this.categoryLabelHeight=l.toString(j.TextMeasurementService.estimateSvgTextHeight(B.FontProperties.toTextProperties(this.data.categoryLabelsSettings.fontProperties))),this.titleLabelHeight=l.toString(j.TextMeasurementService.estimateSvgTextHeight(B.FontProperties.toTextProperties(this.data.cardTitleSettings.fontProperties))),this.waitingForData=!1},K.getCardSettings=function(t,e){var t=t&&t.metadata&&t.metadata.objects?t.metadata.objects:null,e=B.ColorHelper.create(e),i={outline:j.DataViewObjects.getValue(t,B.multiRowCardProps.card.outline,r),outlineStyle:j.DataViewObjects.getValue(t,B.multiRowCardProps.card.outlineStyle,0),color:e.getColorForProperty(t,B.multiRowCardProps.card.outlineColor,"foregroundNeutralLight"),weight:j.DataViewObjects.getValue(t,B.multiRowCardProps.card.outlineWeight,1)},a=j.DataViewObjects.getValue(t,B.multiRowCardProps.card.barShow,!0);return{outlineSettings:i,barSettings:{outline:a?n:B.outline.none,outlineStyle:a?8:0,color:e.getColorForProperty(t,B.multiRowCardProps.card.barColor,"foregroundNeutralTertiary"),weight:j.DataViewObjects.getValue(t,B.multiRowCardProps.card.barWeight,3)},cardPadding:j.DataViewObjects.getValue(t,B.multiRowCardProps.card.cardPadding,K.DefaultStyle.row.marginBottom),cardBackground:j.DataViewObjects.getFillColor(t,B.multiRowCardProps.card.cardBackground,K.DefaultStyle.row.background)}},K.prototype.onResizing=function(t){var e,i=this.currentViewport.height===t.height;this.currentViewport=t,this.element.css("height",p(t.height)),this.dataView&&(e=this.maxColPerRow,this.maxColPerRow=this.getMaxColPerRow(),e=e===this.maxColPerRow,i&&e||this.listView.viewport(t))},K.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},K.prototype.onRestoreSelection=function(t){return!!this.interactivityService&&this.interactivityService.restoreSelection(t.selection)},K.converter=function(t,e,i,a,o,r){function n(t){return B.ColorHelper.getThemeColor(a,t)}void 0===r&&(r=!1);var l,s=[],d=t.table.rows,c=t.table.columns,u=B.DataLabelViewModel.getDefaultLabelSettings({show:!0,labelColor:n(z),fontSize:13,fontFamily:U,style:a,textClassName:"dataTitle"}),g=B.DataLabelViewModel.getDefaultLabelSettings({show:!0,labelColor:n(W),fontSize:9,fontFamily:A,style:a,textClassName:"largeLightLabel"}),p=B.DataLabelViewModel.getDefaultLabelSettings({show:!0,labelColor:n(B.ForegroundColorName),fontSize:10,fontFamily:A,style:a,textClassName:"largeLabel"});t.metadata&&t.metadata.objects&&(l=j.DataViewObjects.getObject(t.metadata.objects,"cardTitle"),B.DataLabelViewModel.updateLabelSettingsFromLabelsObject(l,u,void 0,a),l=j.DataViewObjects.getObject(t.metadata.objects,"dataLabels"),B.DataLabelViewModel.updateLabelSettingsFromLabelsObject(l,p,void 0,a),l=j.DataViewObjects.getObject(t.metadata.objects,"categoryLabels"),B.DataLabelViewModel.updateLabelSettingsFromLabelsObject(l,g,void 0,a));for(var h=0,m=i;h<m;h++){for(var f,b=d[h],w=null,y=!0,S=!1,C=!1,v=!1,L=[],x=0;x<e;x++){var V,D=c[x],I=k(D,b[x]),P=void 0,I=(P=(P=I?I.class:P)||B.valueFormatter.formatVariantMeasureValueWithDataPointObjects(b[x],b.objects&&b.objects[x],D,K.formatStringProp,!0),void 0!==I&&void 0!==I.caption),T=c[x].displayName,M=(!y||r||D.type.numeric||(null==w?(w=x,f=P,S=B.converterHelper.isWebUrlColumn(D)&&H.isValidHttpUrl(f),C=B.converterHelper.isImageUrlColumn(D)&&H.isValidImageUrl(P),v=I):null!=w&&(y=!1,w=null)),void 0);t.table.identity&&void 0!==(V=null==(V=_.find(c,function(t){return!t.isMeasure}))?void 0:V.queryName)&&(M=(new B.SelectionIdBuilder).withMeasure(c[x].queryName).withColumnIdentity(t.table.identity[h],V).createSelectionId()),L.push({caption:P,details:T,showURL:B.converterHelper.isWebUrlColumn(D)&&H.isValidHttpUrl(P),showImage:B.converterHelper.isImageUrlColumn(D)&&H.isValidImageUrl(P),showKPI:I,columnIndex:x,identity:M,selected:!1})}if(null!=w){for(var F=L.slice(0,w),O=L.slice(w+1),R=0,N=O;R<N.length;R++)N[R].columnIndex--;L=F.concat(O)}f=null==f?o.getLocalizedString("NullValue"):f,s.push({title:null!=w?f:void 0,showTitleAsURL:S,showTitleAsImage:C,showTitleAsKPI:v,cardItemsData:L})}return{dataModel:s,dataColumnCount:s[0]?s[0].cardItemsData.length:0,cardTitleSettings:u,categoryLabelsSettings:g,dataLabelsSettings:p,cardSettings:K.getCardSettings(t,a)}},K.prototype.initializeCardRowSelection=function(){var r=this,n=this.isInteractivityOverflowHidden,t={rowHeight:void 0,enter:function(t){t=t.append("div").classed(K.Card.class,!0),r.interactivityEnabled&&(t.attr("tabindex",0),t.on("keydown.row",function(){var t=d3.event,e=t.keyCode;9===e&&!t.shiftKey||39===e||40===e?r.navigateForward():(9===e&&t.shiftKey||37===e||38===e)&&r.navigateBackward()})),n?t.classed("mrtile",!0):r.cardHasTitle&&t.append("div").classed(K.Title.class,!0).each(function(t){t.showTitleAsImage?u(d3.select(this)):t.showTitleAsURL?d3.select(this).append("a"):t.showTitleAsKPI&&d3.select(this).append("div").classed(K.KPITitle.class,!0).classed(t.title,!0).styles({display:"inline-block",verticalAlign:"sub"})}),t=t.selectAll(K.CardItemContainer.selector).data(function(t){return t.cardItemsData}),t=t.enter().append("div").classed(K.CardItemContainer.class,!0).merge(t);t.append("div").classed(K.Caption.class,!0).each(function(t){t.showURL?d3.select(this).append("a"):t.showImage?u(d3.select(this)):t.showKPI&&d3.select(this).append("div").classed(t.caption,!0).styles({display:"inline-block",verticalAlign:"sub"})}),t.append("div").classed(K.Details.class,!0)},update:function(t){var e=r.getStyle(),i=r.getBorderStyles(e.row.border,e.row.padding),i=(t.styles(i).styles({"margin-bottom":n||r.isSingleRowCard?"0px":p(e.row.marginBottom),background:e.row.background}),!n&&r.cardHasTitle&&(t.selectAll(K.Title.selector).filter(function(t){return!t.showTitleAsImage&&!t.showTitleAsKPI}).styles({"font-size":l.fromPoint(e.title.fontSize),"font-family":e.title.family,"line-height":r.titleLabelHeight,height:r.titleLabelHeight,color:e.title.color,"font-style":e.title.italic,"font-weight":e.title.bold,"text-decoration":e.title.underline}),t.selectAll(K.Title.selector).filter(function(t){return!t.showTitleAsURL&&!t.showTitleAsImage&&!t.showTitleAsKPI}).text(function(t){return t.title}).attr("title",function(t){return t.title}),t.selectAll(K.TitleUrlSelector).text(function(t){return t.title}).attrs({href:function(t){return t.title},target:"_blank",rel:"noopener noreferrer"}),t.selectAll(K.TitleImageSelector).attr("src",function(t){return t.title}),g(t.selectAll(K.Title.selector),e.imageTitle),t.selectAll(K.KPITitle.selector).each(function(t){d3.select(this).classed(t.title)})),t.selectAll(K.Card.selector).attr("aria-label",function(t){return r.getFormattedCardData(t)})),a=r.getBorderStyles(e.card.border,e.card.padding),o=(i.styles(a),i.selectAll(K.Caption.selector).filter(function(t){return!t.showImage}).styles({"line-height":r.dataLabelHeight,height:r.dataLabelHeight,"font-size":l.fromPoint(e.caption.fontSize),"font-family":e.caption.family,"font-style":e.caption.italic,"font-weight":e.caption.bold,"text-decoration":e.caption.underline}).filter(function(t){return!t.showKPI}).styles({color:e.caption.color}).filter(function(t){return!t.showURL}).text(function(t){return t.caption}).attr("title",function(t){return t.caption}),i.selectAll(K.CaptionImageSelector).attr("src",function(t){return t.caption}).styles(e.imageCaption),p(e.cardItemContainer.padding.top)),a=i.selectAll(K.CardItemContainer.selector);a.styles({"padding-top":function(t){return r.isInFirstRow(t.columnIndex)?"":o},"padding-right":function(t){return r.isLastRowItem(t.columnIndex,r.dataView.metadata.columns.length)?"0px":p(e.cardItemContainer.paddingRight)},width:function(t){return r.getColumnWidth(t.columnIndex,r.data.dataColumnCount)}}),r.interactivityService&&r.interactivityService.bind(a.data(),r.behavior,{cardItems:a,rows:t,titles:t.selectAll(K.Title.selector),hasSelection:r.interactivityService.hasSelection()}),g(i.selectAll(K.Caption.selector),e.imageCaption),i.selectAll(K.CaptionUrlSelector).attrs({href:function(t){return t.caption},target:"_blank",rel:"noopener noreferrer"}).text(function(t){return t.caption}),e.details.isVisible&&i.selectAll(K.Details.selector).text(function(t){return t.details}).styles({"font-size":l.fromPoint(e.details.fontSize),"font-family":e.details.family,"line-height":r.categoryLabelHeight,height:r.categoryLabelHeight,color:e.details.color,"font-style":e.details.italic,"font-weight":e.details.bold,"text-decoration":e.details.underline}).attr("title",function(t){return t.details}),r.interactivityEnabled&&null!=r.targetFocusCardIndex&&(a=t.filter(function(t){return r.data.dataModel.indexOf(t)===r.targetFocusCardIndex}).node(),r.targetFocusCardIndex=null,a)&&$(a).find(":tabbable").get(0).focus()},loadMoreData:function(){return r.onLoadMoreData()},viewport:this.currentViewport,baseContainer:d3.select(this.element.get(0)),scrollEnabled:!this.isInteractivityOverflowHidden,isReadMode:function(){return 1!==r.options.host.getViewMode()}};this.listView=B.ListViewFactory.createListView(t)},K.prototype.navigateForward=function(){var r=this,t=d3.event,t=(this.targetFocusCardIndex=void 0,t.preventDefault(),t.stopPropagation(),$(t.target).parent(a.selector).get(0));t&&t.nextElementSibling?$(t.nextElementSibling).find(s).get(0).focus():B.InteractivityUtils.tryToSelectD3Target(function(t){var e,t=r.data.dataModel.indexOf(t)+1,i=r.listView.getCurrentPosition(),a=i.endIndex-i.startIndex,o=r.data.dataModel.length;a<o&&t>=i.endIndex&&(e=(t=(r.targetFocusCardIndex=t)+1)-i.endIndex,r.listView.performScrollToFrame(i.startIndex+e,t,o,a,!0))})},K.prototype.navigateBackward=function(){var i=this,t=d3.event,t=(this.targetFocusCardIndex=void 0,t.preventDefault(),t.stopPropagation(),$(t.target).parent(a.selector).get(0));t&&t.previousElementSibling?$(t.previousElementSibling).find(s).get(0).focus():B.InteractivityUtils.tryToSelectD3Target(function(t){var t=i.data.dataModel.indexOf(t)-1,e=i.listView.getCurrentPosition();0<=t&&t<e.startIndex&&(i.targetFocusCardIndex=t,e=e.endIndex-e.startIndex,i.listView.performScrollToFrame(t,t+e,i.data.dataModel.length,e,!0))})},K.prototype.getBorderStyles=function(t,e){var i=null!=t&&null!=t.top,a=null!=t&&null!=t.right,o=null!=t&&null!=t.bottom,r=null!=t&&null!=t.left,n=null!=e&&null!=e.top,l=null!=e&&null!=e.right,s=null!=e&&null!=e.bottom,d=null!=e&&null!=e.left;return{"border-top":i?t.top.getCSS():"","border-right":a?t.right.getCSS():"","border-bottom":o?t.bottom.getCSS():"","border-left":r?t.left.getCSS():"","padding-top":i&&n?p(e.top):"","padding-right":a&&l?p(e.right):"","padding-bottom":o&&s?p(e.bottom):"","padding-left":r&&d?p(e.left):""}},K.prototype.getFormattedCardData=function(t){var e=t.title?"".concat(t.title,". "):"",e=_.reduce(t.cardItemsData,function(t,e){return"".concat(t).concat(e.details," ").concat(e.caption,". ")},e);return"".concat(e).concat(this.data.dataModel.indexOf(t)+1," ").concat(this.options.host.getLocalizedString("Of")," ").concat(this.data.dataModel.length,".")},K.prototype.getMaxColPerRow=function(){var t=this.currentViewport.width,e=this.getStyle().cardItemContainer.minWidth,i=this.data.dataColumnCount,t=Math.floor(t/e)||1;return Math.min(i,t)},K.prototype.getRowIndex=function(t){return Math.floor(+t/this.getMaxColPerRow())},K.prototype.getStyle=function(){var t=K.DefaultStyle,e=this.getCustomStyles();if(!this.isInteractivityOverflowHidden)return $.extend(!0,{},t,e);for(var i=this.currentViewport.width,a={},o=0,r=K.tileMediaQueries;o<r.length;o++){var n=r[o];if(i<=n.maxWidth){a=n.style;break}}return $.extend(!0,{},t,e,a)},K.prototype.getSurroundSettings=function(t){var e=new i(t.weight,t.color),t=this.featureSwitches.outlineDropdownToCheckboxes?t.outlineStyle:t.outline;return{top:B.outline.showTop(t)?e:null,right:B.outline.showRight(t)?e:null,bottom:B.outline.showBottom(t)?e:null,left:B.outline.showLeft(t)?e:null}},K.prototype.getCustomStyles=function(){var t=this.data.dataLabelsSettings,e=this.data.categoryLabelsSettings,i=this.data.cardTitleSettings,a=this.data.cardSettings;return{row:{border:this.getSurroundSettings(a.outlineSettings),marginBottom:a.cardPadding,background:a.cardBackground},card:{border:this.getSurroundSettings(a.barSettings)},details:{fontSize:e.fontProperties.size.pt,family:e.fontProperties.family,color:e.fontProperties.color,isVisible:e.show,bold:e.bold?o.boldValue:o.normalValue,italic:e.italic?o.italicValue:o.normalValue,underline:e.underline?o.underlineValue:o.noneValue},caption:{fontSize:t.fontProperties.size.pt,family:t.fontProperties.family,color:t.fontProperties.color,bold:t.bold?o.boldValue:o.normalValue,italic:t.italic?o.italicValue:o.normalValue,underline:t.underline?o.underlineValue:o.noneValue},title:{fontSize:i.fontProperties.size.pt,family:i.fontProperties.family,color:i.fontProperties.color,bold:i.bold?o.boldValue:o.normalValue,italic:i.italic?o.italicValue:o.normalValue,underline:i.underline?o.underlineValue:o.noneValue}}},K.prototype.getColumnWidth=function(t,e){var i,a=this.getMaxColPerRow();return e<=a?100/e+"%":(i=e%a,this.getRowIndex(t)<Math.ceil(+e/a)||0==i?100/a+"%":100/i+"%")},K.prototype.isLastRowItem=function(t,e){return t+1===e||(e=this.getMaxColPerRow())-t%e==1},K.prototype.isInFirstRow=function(t){return t<this.getMaxColPerRow()},K.prototype.setCardDimensions=function(){this.cardHasTitle=!1;var t=this.data.dataModel;!this.isInteractivityOverflowHidden&&t&&0<t.length&&(this.cardHasTitle=void 0!==t[0].title,this.isSingleRowCard=1===t.length)},K.prototype.onLoadMoreData=function(){return this.waitingForData?e.WaitingForData:this.dataView.metadata&&this.dataView.metadata.segment?(this.options.host.loadMoreData(),this.waitingForData=!0,e.TriggeredLoadMore):e.NoOperation},K.getDataLabelSettingsOptions=function(t,e,i,a){return{enumeration:t,dataLabelsSettings:e,show:a=void 0===a?!1:a,fontSize:!0,fontFamily:!0,style:i,bold:!0,italic:!0,underline:!0}},K.prototype.getCalloutValueCard=function(){var e=this,t=this.data.dataLabelsSettings,i=__assign({},B.multiRowCardObjectProps.dataLabels),i={cardBuilder:new d.FormattingCardBuilder(new d.FormattingCardUidBuilder("labels"),"Visual_CallOutValues",i,function(t){return e.options.host.getLocalizedString(t)}),dataLabelsProps:i,featureSwitches:this.featureSwitches,hostServices:this.options.host,options:K.getDataLabelSettingsOptions(void 0,t,this.style),omitGroupDisplayNames:!0,omitDescription:!0,instanceKind:3};return B.DataLabelViewModel.getDataLabelsFormattingModel(i)},K.prototype.getCategoryLabelCard=function(){var e=this,t=this.data.categoryLabelsSettings,i=__assign({},B.multiRowCardObjectProps.categoryLabels),i={cardBuilder:new d.FormattingCardBuilder(new d.FormattingCardUidBuilder("categoryLabels"),"Visual_CategoryLabels",i,function(t){return e.options.host.getLocalizedString(t)}),dataLabelsProps:i,featureSwitches:this.featureSwitches,hostServices:this.options.host,options:K.getDataLabelSettingsOptions(void 0,t,this.style,!0),omitGroupDisplayNames:!0,customDescription:"Visual_CategoryLabelOptionsDescription",instanceKind:3};return B.DataLabelViewModel.getDataLabelsFormattingModel(i)},K.prototype.getCardsCard=function(){function e(t){return i.options.host.getLocalizedString(t)}var i=this,t=this.data.cardTitleSettings,a=this.data.cardSettings,o=a.outlineSettings,r=a.barSettings,n=__assign(__assign({},B.multiRowCardObjectProps.cardTitle),B.multiRowCardObjectProps.card),l=new d.FormattingCardBuilder(new d.FormattingCardUidBuilder("card"),"Cards",n,function(t){return i.options.host.getLocalizedString(t)}),t={cardBuilder:l,dataLabelsProps:B.multiRowCardObjectProps.cardTitle,featureSwitches:this.featureSwitches,hostServices:this.options.host,options:K.getDataLabelSettingsOptions(void 0,t,this.style),instanceKind:3},s=(B.DataLabelViewModel.addDataLabelsValuesFormattingGroup(t,void 0,"Title",this.isInteractivityOverflowHidden||!this.cardHasTitle),l.addGroup("style",function(t){t.withDisplayName("Visual_Axis_Style"),i.featureSwitches.outlineDropdownToCheckboxes?t.addSimpleSlice(n.outlineStyle.propertyName,new d.FlagSelectionBuilder({descriptor:n.outlineStyle,value:o.outlineStyle}).build(),function(t){return t.withCustomDisplayName("Visual_Border_Position")}):t.addSimpleSlice(n.outline.propertyName,new d.DropdownBuilder({descriptor:n.outline,value:o.outline}).build(),function(t){return t.withCustomDisplayName("Visual_Border_Position")}),(i.featureSwitches.outlineDropdownToCheckboxes?0!==o.outlineStyle:o.outline!==B.outline.none)&&t.addSimpleSlice(n.outlineColor.propertyName,new d.ColorPickerBuilder({descriptor:n.outlineColor,value:{value:o.color}}).build()).addSimpleSlice(n.outlineWeight.propertyName,new d.NumUpDownBuilder({descriptor:n.outlineWeight,value:o.weight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:10}}}).build()),t.addSimpleSlice(n.cardBackground.propertyName,new d.ColorPickerBuilder({descriptor:__assign(__assign({},n.cardBackground),{instanceKind:i.featureSwitches.expressionBasedFormatting?3:1}),value:{value:a.cardBackground}}).build()).addSimpleSlice(n.cardPadding.propertyName,new d.SliderBuilder({descriptor:n.cardPadding,value:a.cardPadding,options:{minValue:{type:0,value:0},maxValue:{type:1,value:20},unitSymbol:B.visualLocKeys.PixelUnitSymbol},localize:e}).build())}),this.featureSwitches.outlineDropdownToCheckboxes?0!==r.outlineStyle:r.outline!==B.outline.none);return l.addGroup("bar",function(t){t.withDisplayName("Visual_Outline_AccentBar").addTopLevelToggle(n.barShow.propertyName,function(){return new d.ToggleSwitchBuilder({descriptor:n.barShow,value:s}).build()}),t.addSimpleSlice(n.barColor.propertyName,new d.ColorPickerBuilder({descriptor:__assign(__assign({},n.barColor),{instanceKind:i.featureSwitches.expressionBasedFormatting?3:1}),value:{value:r.color}}).build(),function(t){return t.withCustomDisplayName("Visual_Reference_Line_Color")}).addSimpleSlice(n.barWeight.propertyName,new d.NumUpDownBuilder({descriptor:n.barWeight,value:r.weight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:10}}}).build(),function(t){return t.withCustomDisplayName("Visual_General_Properties_Width")})}),l.build()},K.prototype.getFormattingModel=function(){var t=this;return new B.builder.FormattingModelBuilder(function(){return t.getCalloutValueCard()},function(){return t.getCategoryLabelCard()},function(){return t.getCardsCard()}).build()},K.prototype.enumerateObjectInstances=function(t){var e=new B.ObjectEnumerationBuilder,i=this.data.cardTitleSettings,a=this.data.dataLabelsSettings,o=this.data.categoryLabelsSettings;switch(t.objectName){case"cardTitle":!this.isInteractivityOverflowHidden&&this.cardHasTitle&&B.DataLabelViewModel.enumerateDataLabels(K.getDataLabelSettingsOptions(e,i,this.style),this.featureSwitches,void 0,{objectName:"cardTitle"});break;case"dataLabels":B.DataLabelViewModel.enumerateDataLabels(K.getDataLabelSettingsOptions(e,a,this.style),this.featureSwitches,void 0,{objectName:"dataLabels"});break;case"categoryLabels":B.DataLabelViewModel.enumerateDataLabels(K.getDataLabelSettingsOptions(e,o,this.style,!0),this.featureSwitches,void 0,{objectName:"categoryLabels"});break;case B.multiRowCardProps.card.outlineStyle.objectName:this.enumerateCard(e)}return e.complete()},K.prototype.enumerateCard=function(t){var e=this.data.cardSettings,i=B.multiRowCardProps.card,a={},o=e.outlineSettings;this.featureSwitches.outlineDropdownToCheckboxes?a[i.outlineStyle.propertyName]=o.outlineStyle:a[i.outline.propertyName]=o.outline;(this.featureSwitches.outlineDropdownToCheckboxes?0!==o.outlineStyle:o.outline!==B.outline.none)&&(a[i.outlineColor.propertyName]=o.color,a[i.outlineWeight.propertyName]=o.weight);var o=e.barSettings,r=this.featureSwitches.outlineDropdownToCheckboxes?0!==o.outlineStyle:o.outline!==B.outline.none;(a[i.barShow.propertyName]=r)&&(a[i.barColor.propertyName]=o.color,a[i.barWeight.propertyName]=o.weight),a[i.cardPadding.propertyName]=e.cardPadding,a[i.cardBackground.propertyName]=e.cardBackground,t.pushInstance({selector:null,objectName:i.outlineStyle.objectName,properties:a,propertyInstanceKind:{barColor:this.featureSwitches.expressionBasedFormatting?3:1,cardBackground:this.featureSwitches.expressionBasedFormatting?3:1}})},K.formatStringProp={objectName:"general",propertyName:"formatString"},K.MultiRowCardRoot=t("multiRowCard"),K.Card=t("card"),K.Title=t("title"),K.CardItemContainer=t("cardItemContainer"),K.Caption=t("caption"),K.Details=t("details"),K.TitleUrlSelector=K.Title.selector+" a",K.CaptionUrlSelector=K.Caption.selector+" a",K.TitleImageSelector=K.Title.selector+" img",K.CaptionImageSelector=K.Caption.selector+" img",K.KPITitle=t("kpiTitle"),K.DefaultStyle={row:{border:null,marginBottom:20,background:void 0,padding:{top:5,right:5,bottom:5,left:5}},card:{border:null,padding:{top:10,right:10,bottom:10,left:10}},cardItemContainer:{paddingRight:20,minWidth:120,padding:{top:7}},imageCaption:{maxHeight:75,maxWidth:100},imageTitle:{maxHeight:75,maxWidth:100}},K.tileMediaQueries=[{maxWidth:250,style:{cardItemContainer:{minWidth:110},imageCaption:{maxHeight:45}}},{maxWidth:490,style:{cardItemContainer:{minWidth:130},imageCaption:{maxHeight:52}}},{maxWidth:750,style:{cardItemContainer:{minWidth:120},imageCaption:{maxHeight:53}}},{maxWidth:Number.MAX_VALUE,style:{cardItemContainer:{padding:{top:5}}}}],B.MultiRowCard=K}(powerbi=powerbi||{}),function(t){((t=t.powerbi||(t.powerbi={})).visuals||(t.visuals={})).importMultiRowCardModule=function(){}}(es6=es6||{}),function(t){var o,a,r;function e(){}o=t.visuals||(t.visuals={}),a=jsCommon.BrowserUtils,r=jsCommon.SelectionUtility,e.prototype.bindEvents=function(t,e,i){var a=this;this.cardItems=t.cardItems,this.cardItems.style("pointer-events","visible").on("click",function(t){return a.handleClick(t,e)}).on("contextmenu",function(t){return a.handleContextMenu(t,e)}),this.titles=t.titles,this.titles.style("pointer-events","visible").on("click",function(t){return a.handleClick(_.first(t.cardItemsData),e)}),this.rows=t.rows,this.rows.on("keydown",function(t){return a.handleKeyDown(_.first(t.cardItemsData),e)}),this.renderSelection(t.hasSelection)},e.prototype.renderSelection=function(e){this.cardItems.style("opacity",function(t){return o.ColumnUtil.getFillOpacity(t.selected,!1,e,!1)}),this.titles.style("opacity",function(t){return o.ColumnUtil.getFillOpacity(null==(t=_.first(t.cardItemsData))?void 0:t.selected,!1,e,!1)})},e.prototype.handleClick=function(t,e){var i=o.InteractivityUtils.getPositionOfLastInputEvent(),a=jsCommon.SelectionUtility.getMultiSelectMode(d3.event);e.handleSelection(t,a,i)},e.prototype.handleKeyDown=function(t,e){var i,a=d3.event;13===a.keyCode&&(a.preventDefault(),a.stopPropagation(),a=o.InteractivityUtils.getPositionOfLastInputEvent(),i=r.getMultiSelectMode(d3.event),e.handleSelection(t,i,a))},e.prototype.handleContextMenu=function(t,e){var i;a.isCtrlOrMeta(d3.event)||(d3.event.preventDefault(),o.EventBubblingUtil.markAsHandled(d3.event),i=o.InteractivityUtils.getPositionOfLastInputEvent(),e.handleContextMenu(t,i))},o.MultiRowCardBehavior=e}(powerbi=powerbi||{}),function(t){var e;(e=t.visuals||(t.visuals={})).initializeMultiRowCardFactoryES6=function(){e.setCreateMultiRowCard(function(e){return es6.powerbi.visuals.importMultiRowCardModule().then(function(t){return new t.MultiRowCard(e)})})}}(powerbi=powerbi||{});
this.parseTimeMarkers = this.parseTimeMarkers || {};
var marker = this.parseTimeMarkers['multiRowCardVisual.min.js'] || (this.parseTimeMarkers['multiRowCardVisual.min.js'] = {});
marker.endEval = window.jsCommon && window.jsCommon.performance && window.jsCommon.performance.now ? window.jsCommon.performance.now() : Date.now(); marker.isExternal = false;
