'use strict'; 
"use strict";
this.parseTimeMarkers = this.parseTimeMarkers || {};
var marker = this.parseTimeMarkers['reportembed.bundle.min.js'] || (this.parseTimeMarkers['reportembed.bundle.min.js'] = {});
marker.startEval = window.jsCommon && window.jsCommon.performance && window.jsCommon.performance.now ? window.jsCommon.performance.now() : Date.now(); marker.isExternal = false;
if (window.perfTracking && window.perfTracking.startBundleEval) window.perfTracking.startBundleEval('reportembed.bundle.min.js');var powerbi,__extends=this&&this.__extends||(function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}})(),__awaiter=this&&this.__awaiter||function(e,n,s,l){return new(s=s||Promise)(function(i,t){function o(e){try{a(l.next(e))}catch(e){t(e)}}function r(e){try{a(l.throw(e))}catch(e){t(e)}}function a(e){var t;e.done?i(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,r)}a((l=l.apply(e,n||[])).next())})},__generator=this&&this.__generator||function(o,r){var a,n,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(i){return function(e){var t=[i,e];if(a)throw new TypeError("Generator is already executing.");for(;l;)try{if(a=1,n&&(s=2&t[0]?n.return:t[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,t[1])).done)return s;switch(n=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,n=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))l.label=t[1];else if(6===t[0]&&l.label<s[1])l.label=s[1],s=t;else{if(!(s&&l.label<s[2])){s[2]&&l.ops.pop(),l.trys.pop();continue}l.label=s[2],l.ops.push(t)}}t=r.call(o,l)}catch(e){t=[6,e],n=0}finally{a=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}};!(function(e){var t,i;(t=(t=e.dataServices||(e.dataServices={})).constants||(t.constants={})).contentPackDirtyShowNotification="contentPackDirty",t.reportDeletedEventName="reportDeleted",t.onDatasetAddedEventName="onDatasetAdded",t.deleteModelFailedEventName="deleteModelFailed",t.deleteModelStartedEventName="deleteModelStarted",t.onDashboardShallowEditEventName="onDashboardShallowEdit",t.mergeDashboardContainerModelsReportsAndPackagesEventName="mergeDashboardContainerModelsReportsAndPackages",t.updateDashboardContainerEventName="updateDashboardContainer",t.addOrUpdateDashboardEventName="addOrUpdateDashboard",t.samplesContentProviderId=-1,t.initialDashboardContainerLoadingState="#loading#",t.initialDashboardContainerErrorState="#error#",t.initialDashboardContainerReadyEventName="initialDashboardContainerReady",t.CannotDeleteModelPublishedToOrganizationalAppHeader="CannotDeleteModelPublishedToOrganizationalApp",t.seenDashboardsStorageKey="seenSharedDashboards",t.ScopedInstanceProviderName="dataServices",t.dashboardElementName=".dashboard",(i=t.workbook||(t.workbook={})).reloadExcelWorkbookEventName="reloadExcelWorkbook",i.pinClickedEventName="pinClicked",i.editInExcelOnlineClickedEventName="editInExcelOnlineClicked",i.editInExcelClickedEventName="editInExcelClicked",i.calculateWorkbookClickedEventName="calculateWorkbookClicked",i.openWorkbookContextMenuEventName="openWorkbookContextMenu",i.renameWorkbookEventName="renameWorkbook",i.editWorkbookEventName="editWorkbook",i.scheduleRefreshWorkbookEventName="scheduleRefreshWorkbook",i.refreshNowWorkbookEventName="refreshNowWorkbook",i.excelWebAppScriptsLoaded="excelWebAppScriptsLoaded",i.defaultKeepOriginalContentSize=!1,t.SingleValueRealTimeWindow=250,t.MultipleValueRealTimeWindow=6e4,t.RealTimeIntervals=[1,5,10,15,20,25,30,45,60],t.RealTimeDataSourceName="_RealTimeSchema_",t.modelPlaceholderImageUrl="/"+e.getBuild()+"/images/modelPlaceholder.png",(i=t.upgrader||(t.upgrader={})).TileConfigVersion="1.6",i.NoVisualType="No visual type"})(powerbi=powerbi||{}),(function(t){var i=t.telemetry||(t.telemetry={}),e=jsCommon.Utility,o=t.telemetryEventFactory,r=t.telemetry.EventFactories;e?e.generateGuid:Function.prototype,i.TileDataUpdateExceptionEventName="PBI.TileDataUpdateException",i.TileDataUpdateException=r[i.TileDataUpdateExceptionEventName]=function(e){return o({name:i.TileDataUpdateExceptionEventName,info:e,category:t.TelemetryCategory.CriticalError,loggers:i.TileDataUpdateExceptionLoggers})},i.DashboardTileErrorEventName="PBI.Dashboard.TileError",i.DashboardTileError=r[i.DashboardTileErrorEventName]=function(e){return o({name:i.DashboardTileErrorEventName,info:e,category:t.TelemetryCategory.CriticalError,loggers:i.DashboardTileErrorLoggers})}})(powerbi=powerbi||{}),(function(e){var t;e=(e=e.dataServices||(e.dataServices={})).contracts||(e.contracts={}),(t=e.TileType||(e.TileType={}))[t.composite=0]="composite",t[t.iframe=1]="iframe",t[t.image=2]="image",t[t.model=3]="model",t[t.ssrs=4]="ssrs",t[t.workbook=5]="workbook",t[t.report=6]="report",t[t.realTime=8]="realTime",(t=e.EwaNamedItemType||(e.EwaNamedItemType={}))[t.NamedRange=0]="NamedRange",t[t.Parameter=1]="Parameter",t[t.Table=2]="Table",t[t.PivotTable=3]="PivotTable",t[t.Chart=4]="Chart",t[t.WebExtension=5]="WebExtension",(t=e.QueryResultErrorType||(e.QueryResultErrorType={}))[t.PowerBIServiceException=0]="PowerBIServiceException",t[t.DSRException=1]="DSRException"})(powerbi=powerbi||{}),(function(e){(e=(e=e.dataServices||(e.dataServices={})).contracts||(e.contracts={})).BuiltInThemeNamesResourceValues={Light:"Light",Dark:"Dark","Color-blind friendly":"Color_Blind_Friendly",Custom:"Custom"},e.createBuiltInThemesFactory=function(){var e={Light:{name:"Light",foreground:"#000000",background:"#EAEAEA",dataColors:["#01B8AA","#374649","#FD625E","#F2C80F","#5F6B6D","#8AD4EB","#FE9666","#A66999"],tiles:{background:"#FFFFFF",color:"#000000"},visualStyles:{"*":{"*":{"*":[{color:{solid:{color:"#000000"}}}]}}}},Dark:{name:"Dark",foreground:"#FFFFFF",background:"#484644",dataColors:["#51CFBE","#F55965","#FE9666","#92BEFF","#B577DF","#29B9EF","#3599B8","#DFBFBF"],tableAccent:"#E2A84E",tiles:{background:"#2B2B30",color:"#FFFFFF"},visualStyles:{"*":{"*":{"*":[{color:{solid:{color:"#FFFFFF"}}},{labelColor:{solid:{color:"#CECECE"}}}]}}}},"Color-blind friendly":{name:"Color-blind friendly",background:"#EAEAEA",foreground:"#000000",dataColors:["#074650","#009292","#FE6DB6","#FEB5DA","#480091","#B66DFF","#B5DAFE","#6DB6FF","#914800","#23FD23"],tiles:{background:"#FFFFFF",color:"#000000"},visualStyles:{"*":{"*":{"*":[{color:{solid:{color:"#000000"}}}]}}}}};return e}})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.dataServices||(e.dataServices={})).models||(e.models={})).ContentPackItems||(e.ContentPackItems={}))[e.Dashboard=0]="Dashboard",e[e.Report=1]="Report",e[e.Model=2]="Model",e[e.Workbook=3]="Workbook"})(powerbi=powerbi||{}),(function(e){(e=(e=e.dataServices||(e.dataServices={})).models||(e.models={})).AppModelIconColors=["#000","#FFF"],e.AppModelIconBackgroundColors=[{color:"#374649",fontColor:"#FFF"},{color:"#01B8AA",fontColor:"#000"},{color:"#FD625E",fontColor:"#FFF"},{color:"#F2C80F",fontColor:"#000"},{color:"#5F6B6D",fontColor:"#000"},{color:"#8AD4EB",fontColor:"#000"},{color:"#FE9666",fontColor:"#000"},{color:"#A66999",fontColor:"#000"},{color:"#3599B8",fontColor:"#000"},{color:"#DFBFBF",fontColor:"#000"}],e.ServiceAppFallbackColors={color:"#374649",fontColor:"#FFF"},e.AppModelIcons=["financial","emi","group","realtime","image","pc1","paintbrush","world","streaming-data","user","barchart","gauge","globe","piedouble","areachart","comment","visualinteraction","code","shapes","piechart","stackedcolumn","scatter","database","home","insight"]})(powerbi=powerbi||{}),(function(e){var t,i,o,r;function a(e){this.contract=e,this.isEnabled=!0,this.isUsedByContentPack=!1,this.isLoaded=e&&null!=e.tiles,this.hitCount=0,this.lazyTiles=null,this.uniqueId="".concat(o.Dashboard,"_").concat(this.contract.id)}t=e.dataServices||(e.dataServices={}),i=t.models||(t.models={}),o=e.common.contracts.ContentTileType,r=jsCommon.Lazy,i.DashboardAsyncLayoutDelayMs=100,a.prototype.getPermissions=function(){var e;return this.getPermissionsCallback&&null!=(e=this.getPermissionsCallback())?e:this.contract&&this.contract.permissions},a.prototype.increaseHitCount=function(){this.hitCount++},Object.defineProperty(a.prototype,"tiles",{get:function(){return this.lazyTiles||(this.lazyTiles=new r(function(){return[]})),this.lazyTiles.getValue()},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"id",{get:function(){return this.contract.id},set:function(e){this.contract.id=e},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"folderId",{get:function(){return this.contract.folderId},set:function(e){this.contract.folderId=e},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"objectId",{get:function(){return this.contract.objectId},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"canEdit",{get:function(){return t.DashboardUtils.isWriteable(this.contract)&&!(this.gridLayoutService&&this.gridLayoutService.strategy.isLayoutLocked)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"contentTileType",{get:function(){return o.Dashboard},enumerable:!1,configurable:!0}),a.prototype.isFilled=function(){return this.contract.tiles&&this.tiles.length===this.contract.tiles.length},a.prototype.calculateLayout=function(){this.layoutRequired=!1;var e=this.tiles;if(!_.isEmpty(e))for(var t=0,i=e;t<i.length;t++)i[t].calculateLayout()},a.prototype.applyLayout=function(){var e=this.tiles;if(!_.isEmpty(e))for(var t=0,i=e;t<i.length;t++)i[t].applyLayout()},a.prototype.runLayoutIfRequired=function(){this.layoutRequired&&(this.calculateLayout(),this.applyLayout())},a.prototype.scheduleDelayedLayout=function(e){var t=this;void 0===e&&(e=!1),this.layoutRequired||(this.layoutRequired=!0,e)||setTimeout((function(){t.layoutRequired&&(t.calculateLayout(),t.applyLayout())}),i.DashboardAsyncLayoutDelayMs)},a.prototype.findTile=function(t){return _.find(this.tiles,(function(e){return e.id===t}))},a.prototype.findTileByObjectIdOrOriginalObjectId=function(t,i){if(t||i)return _.find(this.tiles,(function(e){return!_.isEmpty(t)&&e.contract.objectId===t||!_.isEmpty(i)&&e.contract.originalTileObjectId===i}))},a.prototype.getTileIndex=function(t){return _.findIndex(this.tiles,(function(e){return e.id===t}))},a.prototype.getTileContractIndex=function(t){return _.findIndex(this.contract.tiles,(function(e){return e.id===t}))},a.prototype.getUniquePackageId=function(){var e=this.contract;return e.originalPackageId||(e.packageIds&&1===e.packageIds.length?e.packageIds[0]:void 0)},a.prototype.hasModel=function(t){return _.some(this.tiles,(function(e){return e.contract.modelId===t}))},a.prototype.hasOwnerInfo=function(){return!_.isEmpty(this.ownerFullname)||!_.isEmpty(this.ownerMail)},i.Dashboard=a})(powerbi=powerbi||{}),(function(e){function t(e){this.contract=e}e=(e=e.dataServices||(e.dataServices={})).models||(e.models={}),t.prototype.getPermissions=function(){var e;return(e=this.getPermissionsCallback?this.getPermissionsCallback():e)||this.contract&&this.contract.permissions},t.prototype.hasUpdate=function(){return this.version&&this.latestVersion&&this.version!==this.latestVersion},e.Package=t})(powerbi=powerbi||{}),(function(e){var r,i;function a(e,t){this.datasetInfo=e,this.definition=t}r=e.dataServices||(e.dataServices={}),e=r.models||(r.models={}),i=window,Object.defineProperty(a.prototype,"databaseName",{get:function(){return this.datasetInfo.databaseName},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"primaryKey",{get:function(){return this.datasetInfo.resourceKey},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"secondaryKey",{get:function(){return this.datasetInfo.resourceKeySecondary},enumerable:!1,configurable:!0}),a.prototype.getPushUrl=function(){var e=window.tenantId,t=window.apiUri,e=("https://wabi-staging-us-east-redirect.analysis.windows.net"===i.clusterUri&&(t="https://powerbistagingapi.analysis.windows.net"),"/beta/"+e+"/datasets/"+this.databaseName+"/rows"),t=jsCommon.Utility.urlCombine(t,e),e={};return e.key=this.primaryKey,jsCommon.QueryStringUtil.addOrUpdateQueryStringToUrl(t,e)},a.createRealTimeDatasetDefinition=function(e,t,i){var i=i.schema(r.constants.RealTimeDataSourceName).entities,i=_.head(i),o=[];return _.map(i.properties,(function(e){o.push({name:e.displayName,dataType:a.convertToRealTimeDataType(e.type)})})),{name:e,columns:o,mode:t,tableName:i.name}},a.convertToRealTimeDataType=function(e){switch(e.primitiveType){case 3:case 4:return 1;case 7:return 2;case 1:return 0;case 5:return 3}},e.RealTimeModel=a})(powerbi=powerbi||{}),(function(o){var t,e,r,i,a;function n(e,t,i){void 0===i&&(i=!0);var o=r.call(this)||this;return o.displayWidth=e,o.displayHeight=t,o.ignoreScrollbarWidth=i,o.minNumOfColumns=2,o.isLayoutLocked=!0,o}t=o.dataServices||(o.dataServices={}),e=t.models||(t.models={}),i=o.common.models.DefaultGridLayoutStrategy,a=o.common.directives.InViewport,__extends(n,r=i),n.prototype.calculateDisplayPositions=function(e){r.prototype.calculateDisplayPositions.call(this,e),this.scaleDashboard(e)},n.prototype.scaleDashboard=function(e){var e=this.getDashboardSize(e),t=n.calculateDashboardScaleFactor(e.width,this.displayWidth);t<=0||(e={transform:"scale("+t+")",width:e.width+"px",height:this.displayHeight/t+"px",left:0},$(o.dataServices.constants.dashboardElementName).css(e),a.getRefreshAllHandler()())},n.prototype.getDashboardSize=function(e){var t=this.getMaxColumnInLayout(e),e=this.getMaxRowInLayout(e),i=(t<this.minNumOfColumns&&(t=this.minNumOfColumns),o.common.GridLayoutConstants.defaultGridItemSpacing);return{width:t*this.gridWidth+i+this.getScrollbarWidth(),height:e*this.gridHeight+i}},n.calculateDashboardScaleFactor=function(e,t){return t/e},n.prototype.getMaxRowInLayout=function(e){return _.maxBy(_.map(e,(function(e){return e.displayRow-1+e.displaySize.rowSpan})))},n.prototype.getMaxColumnInLayout=function(e){return _.maxBy(_.map(e,(function(e){return e.displayCol-1+e.displaySize.colSpan})))},n.prototype.getScrollbarWidth=function(){var e;return null==this.scrollbarWidth&&(this.ignoreScrollbarWidth?this.scrollbarWidth=0:(e=t.DashboardUtils.calcDashboardScrollbarWidth(),this.scrollbarWidth=e<0?0:e/2)),this.scrollbarWidth},i=n,e.PhoneLandscapeTileLayoutStrategy=i})(powerbi=powerbi||{}),(function(a){var e,i,t,o;function r(e){this.isLayoutLocked=!0,this.willOverrideDisplayPosition=!0,this.gridItemSpacing=i.tileSpacing,this.isDynamic=!1,this.tileTypeRowSpanMap={},this.visualTypeRowSpanMap={},this.gridWidth=e-this.gridItemSpacing,this.gridHeight=Math.round(this.gridWidth*i.aspectRatio),this.gridMinWidthOnResize=this.gridWidth-i.resizeBuffer,this.gridMinHeightOnResize=this.gridHeight-i.resizeBuffer,this.gridMaxWidthOnResize=this.gridWidth*a.common.models.gridLayoutConstants.getGridMaxColSpan(),this.gridMaxHeightOnResize=this.gridHeight*a.common.models.gridLayoutConstants.getGridMaxColSpan(),this.tileTypeRowSpanMap[t.report]=i.mediumTileRowSpan,this.visualTypeRowSpanMap[a.visuals.plugins.card.name]=i.smallTileRowSpan,this.visualTypeRowSpanMap[a.visuals.plugins.animatedNumber.name]=i.smallTileRowSpan,this.visualTypeRowSpanMap[a.visuals.plugins.textbox.name]=i.smallTileRowSpan}e=(e=a.dataServices||(a.dataServices={})).models||(e.models={}),t=a.dataServices.contracts.TileType,(o=i=e.PhoneTileLayoutConstants||(e.PhoneTileLayoutConstants={})).tileSpacing=12,o.smallTileRowSpan=4,o.defaultTileRowSpan=6,o.mediumTileRowSpan=7,o.largeTileRowSpan=9,o.resizeBuffer=10,o.aspectRatio=.1111,r.prototype.calculateDisplayPositions=function(e){for(var t=1,i=0,o=a.dataServices.DashboardUtils.orderItems(_.map(e,(function(e){return{pos:e.getLayoutPosition(),item:e}})));i<o.length;i++){var r=o[i];r.displayCol=1,r.displayRow=t,this.calculateDisplaySize(r),t+=r.displaySize.rowSpan}this.removeScale()},r.prototype.calculateDisplaySize=function(e){var t=this.getRowSpan(e);e.displaySize={colSpan:1,rowSpan:t}},r.prototype.getRowSpan=function(e){var e=e.gridItem,t=this.tileTypeRowSpanMap[e.type];return(t=!t&&e.composite&&null!==(e=e.composite)?this.visualTypeRowSpanMap[e.visual.type]:t)||i.defaultTileRowSpan},r.prototype.removeScale=function(){$(a.dataServices.constants.dashboardElementName).removeAttr("style")},o=r,e.PhonePortraitTileLayoutStrategy=o})(powerbi=powerbi||{}),(function(e){var t,i,o;function r(e,t){e=i.call(this,e,t)||this;return e.maxColumnsToDisaply=7,e.minColumnsToDisplay=3,e.portionOfNextColumn=.2,e}t=(t=e.dataServices||(e.dataServices={})).models||(t.models={}),o=e.common.GridLayoutConstants,i=t.PhoneLandscapeTileLayoutStrategy,__extends(r,i),r.prototype.getDashboardSize=function(e){var t=this.getMaxColumnInLayout(e),e=this.getMaxRowInLayout(e),i=(t>this.maxColumnsToDisaply?t=this.maxColumnsToDisaply+this.portionOfNextColumn:t<this.minColumnsToDisplay&&(t=this.minColumnsToDisplay),o.defaultGridItemSpacing);return{width:t*this.gridWidth+i,height:e*this.gridHeight+i}},t.TabletTileLayoutStrategy=r})(powerbi=powerbi||{}),(function(i){var o,r,a,t,n,s,l,b;function c(e,t){return e.webUri&&e.etagHash?"".concat(e.webUri,"/_layouts/WopiFrame.aspx?sourcedoc={").concat(e.etagHash,"}&action=").concat(t):""}function e(e,t,i,o,r,a,n,s,l,c,u,d,p,h,m,g,y,f,v,T){this.authenticationService=e,this.explorationSerializer=t,this.featureSwitchService=i,this.geocoder=o,this.geolocationService=r,this.localizationService=a,this.moduleLoader=n,this.permissionService=s,this.promiseFactory=l,this.reportModelConverter=c,this.telemetryService=u,this.themeService=d,this.tileConfigUpgraderService=p,this.visualHostTooltipService=h,this.visualPluginOps=m,this.visualPlugins=g,this.appModelConverter=y,this.$injector=f,this.datasetModelConverter=v,this.packageModelConverter=T}o=i.dataServices||(i.dataServices={}),r=o.models||(o.models={}),a=jsCommon.ArrayExtensions,t=i.common.models.CdsaContentTile,n=jsCommon.Lazy,s=i.common.models.Report,l=o.contracts.TileType,r.createDataServiceModelConverter=function(e,t,i,o,r,a,n,s,l,c,u,d,p,h,m,g,y,f,v,T){return new b(e,t,i,o,r,a,n,s,l,c,u,d,p,h,m,g,y,f,v,T)},r.getWorkbookActionUrl=c,e.prototype.setModelMerger=function(e){this.modelMerger=e},e.prototype.convertCompositeTile=function(e){return this.tileModelConverter.convertCompositeTile(e)},e.prototype.convertTileData=function(e){return this.tileModelConverter.convertTileData(e)},e.prototype.convertDashboard=function(e,t,i,o){var r=this,a=this.convertDashboardShallow(e);return e.tiles&&(a.lazyTiles=new n(function(){return _.map(e.tiles,(function(e){return r.convertTile(e,t,i,o)}))})),a},e.prototype.convertDashboardShallow=function(e){var t=this,i=new r.Dashboard(e);return i.getPermissionsCallback=function(){return t.permissionService.getDashboardEffectivePermissions(e)},i.dataClassificationId=e.dataClassificationId,i.folderId=e.folderId,this.modelMerger.mergeDashboardShallow(i,e),i},e.prototype.convertIframeTile=function(e){var t,i;return e&&e.type===l.iframe?(t=new r.IframeTileModel(e),i=this.convertTileConfig(e),this.convertTileLayoutConfig(e),i&&i.iframe&&(t.srcUrl=i.iframe.srcUrl,t.embedCode=i.iframe.embedCode),t.isLoading=r.TileFactory.isTileLoading(e),t):null},e.prototype.convertImageTile=function(e){var t;return e&&e.type===l.image?(t=new r.ImageTileModel(e),this.convertTileLayoutConfig(e),t.displayText=e.displayText,t.subDisplayText=e.subDisplayText,"number"!=typeof t.contract.reportId||e.config?(t.isStatic=!1,t.imageUrl=this.getImageUrl(e)):(t.isStatic=!0,t.imageUrl=o.constants.modelPlaceholderImageUrl),t.isLoading=r.TileFactory.isTileLoading(e),t):null},e.prototype.convertContentPackBase=function(e){return this.appModelConverter.convertContentPackBase(e)},e.prototype.convertAppModelBase=function(e){return this.appModelConverter.convertAppModelBase(e)},e.prototype.convertInstalledAppModel=function(e,t){return this.appModelConverter.convertInstalledAppModel(e,t)},e.prototype.convertModel=function(e){return this.datasetModelConverter.convertModel(e)},e.prototype.convertModelTile=function(e){var t;return e&&e.type===l.model?(t=new r.ModelTileModel(e),this.convertTileLayoutConfig(e),t.displayText=e.displayText,t.isLoading=r.TileFactory.isTileLoading(e),t.subDisplayText=e.subDisplayText,t):null},e.prototype.convertCdsaModel=function(e){var t=this.convertCdsaModelShallow(e);return t.permissions=e.permissions,t.name=e.name,t.displayName=e.displayName,t.description=e.description,t.id=e.id,t},e.prototype.convertCdsaModelShallow=function(e){return new t(e)},e.prototype.convertPackage=function(e){return this.packageModelConverter.convertPackage(e)},e.prototype.convertRealTimeTile=function(e){var t={authenticationService:this.authenticationService,featureSwitchService:this.featureSwitchService,geocoder:this.geocoder,geolocationService:this.geolocationService,localizationService:this.localizationService,moduleLoader:this.moduleLoader,promiseFactory:this.promiseFactory,telemetryService:this.telemetryService,themeService:this.themeService,tileModelConverter:this.tileModelConverter,visualHostTooltipService:this.visualHostTooltipService,visualPlugin:this.visualPlugins,visualPluginOps:this.visualPluginOps};return i.dataServices.models.convertRealTimeTile(e,t)},e.prototype.convertReport=function(e){return this.reportModelConverter.convertReport(e)},e.prototype.convertReportTile=function(e){return e&&e.type===l.report?(this.convertTileLayoutConfig(e),new r.ReportTileModel(e)):null},e.prototype.convertSpecificTileShallow=function(e,t){switch(this.convertTileLayoutConfig(e),e.type){case l.composite:var i=this.convertTileConfig(e);i&&i.visualContainer&&(t.composite=new r.SingleVisualCompositeTileModel(e,this.visualPlugins,this.visualPluginOps,this.featureSwitchService,this.geolocationService,this.geocoder,this.promiseFactory,this.moduleLoader,this.telemetryService,this.themeService,this.authenticationService,this.localizationService,this.visualHostTooltipService,this.licenseUIManagerFactory)),t.composite&&(i=o.ContractUtils.getMasterLayoutPosition(e),t.composite.size={rowSpan:i.height,colSpan:i.width},t.composite.isLoading=r.TileFactory.isTileLoading(e));break;case l.iframe:t.iframe=new r.IframeTileModel(e),t.iframe.isLoading=r.TileFactory.isTileLoading(e);break;case l.image:t.image=new r.ImageTileModel(e),t.image.isLoading=r.TileFactory.isTileLoading(e);break;case l.model:t.model=new r.ModelTileModel(e),t.model.isLoading=r.TileFactory.isTileLoading(e);break;case l.ssrs:t.model=new r.SsrsTileModel(e),t.model.isLoading=r.TileFactory.isTileLoading(e);break;case l.workbook:t.workbook=new r.WorkbookTileModel(e,t),t.workbook.isLoading=r.TileFactory.isTileLoading(e);break;case l.report:t.model=new r.ReportTileModel(e),t.model.isLoading=r.TileFactory.isTileLoading(e);break;case l.realTime:this.convertTileConfig(e),t.realTime=new r.RealTimeTileModel(e,this.visualPlugins,this.visualPluginOps,this.featureSwitchService,this.geolocationService,this.geocoder,this.promiseFactory,this.moduleLoader,this.telemetryService,this.themeService,this.authenticationService,this.localizationService,this.visualHostTooltipService)}},e.prototype.convertSsrsTile=function(e){if(!e||e.type!==l.ssrs)return null;this.convertTileLayoutConfig(e);var t=new r.SsrsTileModel(e);return e.config&&(t.imageUrl=this.getSsrsImageUrl(e)),t.isLoading=r.TileFactory.isTileLoading(e),t},e.prototype.convertTile=function(e,t,i,o){this.convertTileLayoutConfig(e);var r=this.convertTileShallow(e,t,i);return this.modelMerger.mergeTile(r,e,t,i,o),null!=e.reportId&&(t=this.getTileReport(e.reportId,i))&&(r.report=r.report||new s(t),this.fillReport(r.report,t)),r},e.prototype.convertTileLayoutConfig=function(e){return this.tileModelConverter.convertTileLayoutConfig(e)},e.prototype.convertTileAction=function(e){var t,i=e.$action;if(!i){if(e.action&&0===e.action.indexOf("{"))try{t=JSON.parse(e.action)}catch(e){}else t={action:e.action};i=e.$action=t}return i},e.prototype.convertTileConfig=function(e){return this.tileModelConverter.convertTileConfig(e)},e.prototype.convertTileShallow=function(e,t,i){this.convertTileLayoutConfig(e);var o=new r.Tile(e,this.localizationService,this.forceOpenCustomLinksInNewTab);return this.modelMerger.mergeTileShallow(o,e,t,i),o},e.prototype.convertWorkbook=function(e){var t=this,i=this.convertWorkbookShallow(e);return e&&(i.id=e.id,i.modelId=e.modelId,i.viewUrl=this.getWorkbookViewUrl(e),i.editUrl=this.getWorkbookEditUrl(e),i.embedUrl=this.getWorkbookEmbedView(e),i.name=e.name,i.displayName=e.displayName,i.description=e.description,i.fileName=e.fileName,i.packageId=e.packageId,i.isNew=e.isNew,i.getPermissionsCallback=function(){return t.permissionService.getWorkbookEffectivePermissions(e)}),i},e.prototype.convertWorkbookShallow=function(e){return new r.Workbook(e)},e.prototype.convertWorkbookTile=function(e,t,i){if(!e||e.type!==l.workbook)return null;this.convertTileLayoutConfig(e);i=new r.WorkbookTileModel(e,i),i.displayText=e.displayText,i.subDisplayText=e.subDisplayText,i.isLoading=r.TileFactory.isTileLoading(e),i.image=e.tileDataBinaryBase64Encoded,e.$config.workbookTile&&e.$config.workbookTile.keepOriginalContentSize?i.keepOriginalContentSize=e.$config.workbookTile.keepOriginalContentSize:i.keepOriginalContentSize=o.constants.workbook.defaultKeepOriginalContentSize,e=e.$config.workbookTile;return t&&(e&&(i.embedUrl=t.embedUrl+"&item="+e.item),t.contract)&&(i.webUri=t.contract.webUri),i},e.prototype.fillDashboardChildren=function(e,t,i,o){var r=this,a=e.contract;e.displayName!==a.displayName&&(e.displayName=a.displayName),a.tiles&&(e.lazyTiles=new n(function(){return a.tiles.map((function(e){return r.convertTile(e,t,i,o)}))}))},e.prototype.fillReport=function(e,t){this.reportModelConverter.fillReport(e,t)},e.prototype.getImageUrl=function(e){e=this.convertTileConfig(e);if(e&&e.imageTile)return e.imageTile.imageUrl},e.prototype.getSsrsImageUrl=function(e){e=this.convertTileConfig(e);if(e&&e.ssrsTile)return e.ssrsTile.imageUrl},e.prototype.getTileModel=function(t,e){var i,o;return i=e&&-1!==(o=a.indexOf(e,(function(e){return e&&e.id===t})))?e[o]:i},e.prototype.getTileReport=function(t,e){var i,o;return i=e&&-1!==(o=a.indexOf(e,(function(e){return e&&e.id===t})))?e[o]:i},e.prototype.getTileWorkbook=function(t,i,e){var o,r;return o=e&&-1!==(r=a.indexOf(e,(function(e){return e.id===t&&e.packageId===i})))?e[r]:o},e.prototype.resolveTilePackage=function(t,e){var i;t.packageId&&-1!==(i=a.indexOf(e,(function(e){return e.id===t.packageId})))&&(t.tilePackage=e[i])},e.prototype.getWorkbookViewUrl=function(e){return c(e,"view")},e.prototype.getWorkbookEditUrl=function(e){return c(e,"edit")},e.prototype.getWorkbookEmbedView=function(e){return c(e,"embedview")},Object.defineProperty(e.prototype,"forceOpenCustomLinksInNewTab",{get:function(){var t;try{t=this.$injector.get("forceOpenCustomLinksInNewTab")}catch(e){t=!1}return t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"licenseUIManagerFactory",{get:function(){return this._licenseUIManagerFactory||(this._licenseUIManagerFactory=this.$injector.get("licenseUIManagerFactory")),this._licenseUIManagerFactory},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileModelConverter",{get:function(){return this._tileModelConverter||(this._tileModelConverter=r.createTileModelConverter(this.geolocationService,this.telemetryService,this.visualPlugins,this.visualPluginOps,this.featureSwitchService,this.geocoder,this.promiseFactory,this.moduleLoader,this.tileConfigUpgraderService,this.explorationSerializer,this.themeService,this.authenticationService,this.localizationService,this.visualHostTooltipService,this.licenseUIManagerFactory)),this._tileModelConverter},enumerable:!1,configurable:!0}),b=e})(powerbi=powerbi||{}),(function(e){var a,d,o,i,r,n;function t(e,t){this.modelConverter=e,this.permissionService=t}a=e.dataServices||(e.dataServices={}),d=a.models||(a.models={}),o=jsCommon.ArrayExtensions,i=jsCommon.Lazy,r=e.common.helpers.UserInfoHelper,d.createDataServiceModelMerger=function(e,t){return new n(e,t)},t.prototype.mergeDashboard=function(e,t,n,s,l){var c=this,u=this.modelConverter.convertDashboard(t,n,s,l),d=(e.contract=t,e.displayName=u.displayName,e.getPermissionsCallback=function(){return c.permissionService.getDashboardEffectivePermissions(t)},e.contract.modelIds=t.modelIds,e.contract.reportIds=t.reportIds,e.contract.packageIds=t.packageIds,e.contract.workbookIds=t.workbookIds,e.qnaEnabled=t.qnaEnabled,e.gravityEnabled=t.gravityEnabled,e.annotationsEnabled=t.annotationsEnabled,e.isSharedFromSecurityGroup=t.isSharedFromSecurityGroup,e.isHidden=t.isHidden,e.tiles);e.lazyTiles=new i(function(){var e=[];if(!_.isEmpty(u.tiles))for(var t=_.keyBy(d,(function(e){return e&&e.id})),i=0,o=u.tiles;i<o.length;i++){var r=o[i],a=t[r.id];a?(e.push(a),c.mergeTile(a,r.contract,n,s,l)):e.push(r)}return e})},t.prototype.mergeArtifactOwnerInfo=function(e,t){e.ownerFullname=r.getFullName(t.givenName,t.familyName),e.ownerMail=t.emailAddress,t.userObjectId&&(e.ownerUserObjectId=t.userObjectId),t.groupObjectId&&(e.ownerGroupObjectId=t.groupObjectId),e.contract.ownerInfo||(e.contract.ownerInfo=t)},t.prototype.mergeDashboardShallow=function(e,t){var i,o=this;t.displayName&&(e.displayName=t.displayName),void 0!==t.permissions&&(e.getPermissionsCallback=function(){return o.permissionService.getDashboardEffectivePermissions(t)},e.contract.permissions=t.permissions),t.modelIds&&(e.contract.modelIds=t.modelIds),t.reportIds&&(e.contract.reportIds=t.reportIds),t.workbookIds&&(e.contract.workbookIds=t.workbookIds),t.packageIds&&(e.contract.packageIds=t.packageIds),void 0!==t.isStaging&&(e.contract.isStaging=t.isStaging),void 0!==t.qnaEnabled&&(e.qnaEnabled=t.qnaEnabled),void 0!==t.gravityEnabled&&(e.gravityEnabled=t.gravityEnabled),void 0!==t.annotationsEnabled&&(e.annotationsEnabled=t.annotationsEnabled),void 0!==t.isSharedFromSecurityGroup&&(e.isSharedFromSecurityGroup=t.isSharedFromSecurityGroup),void 0!==t.isHidden&&(e.isHidden=t.isHidden),void 0!==t.ownerInfo&&(i=t.ownerInfo,this.mergeArtifactOwnerInfo(e,i)),e.sharedTime=t.sharedTime||"/Date(0)/"},t.prototype.mergeDashboardTiles=function(e,t){var i=t.models||[],o=t.reports||[],r=t.workbooks||[],a=t.packages||[],t=e.contract.tiles;if(t)for(var n=0,s=t;n<s.length;n++){var l=s[n];this.modelConverter.resolveTilePackage(l,a)}t=e.tiles;if(t)for(var c=0,u=t;c<u.length;c++){var d=u[c];this.mergeTile(d,d.contract,i,o,r)}},t.prototype.mergeModelContentProviderId=function(e,t){if(e)for(var i=0,o=e;i<o.length;i++){var r=o[i];r.contentProviderId=r.contentProviderId||a.ContractUtils.findContentProviderId(t,r.packageId)}},t.prototype.mergeTileShallow=function(e,t,i,o){this.modelConverter.convertTileLayoutConfig(t),e.contract=t,e.type=t.type,this.mergeTileLayoutConfig(e,t),e.displayText=t.displayText,e.subDisplayText=t.subDisplayText,e.backgroundImageUrl=this.modelConverter.getImageUrl(t),e.errorCode=t.errorCode;o=this.modelConverter.getTileReport(t.reportId,o);t.query&&t.query.modelQuery&&(e.utterance=t.query.modelQuery.utterance),e.action=this.modelConverter.convertTileAction(t),e.config=this.modelConverter.convertTileConfig(t),e.isLoading=d.TileFactory.isTileLoading(t),e.isLocked=d.TileFactory.isTileLocked(t),t.modelId&&(i=this.modelConverter.getTileModel(t.modelId,i))&&(e.vsName=i.vsName,e.dbName=i.dbName),t.reportId&&(e.report=e.report||this.modelConverter.convertReport(o),e.report.id=t.reportId),o&&(this.modelConverter.fillReport(e.report,o),e.action||(e.action={action:"/openReport"})),this.modelConverter.convertSpecificTileShallow(t,e)},t.prototype.mergeTileLayoutConfig=function(e,t){var i;t.$layoutConfig,e.layoutPosition.x&&e.layoutPosition.y&&e.layoutPosition.width&&e.layoutPosition.height||(t=o.extendWithId(t.$layoutConfig.layouts),i=(i=e.gridLayoutContext)?i.getActiveLayout():0,(t=t.withId(i))&&this.mergeLayoutPosition(e.layoutPosition,t.position))},t.prototype.mergeLayoutPosition=function(e,t){t&&(e.x=e.x||t.x,e.y=e.y||t.y,e.width=e.width||t.width,e.height=e.height||t.height)},t.prototype.mergeTile=function(e,t,i,o,r,a){var n=e.composite,s=e.realTime,n=(this.mergeTileShallow(e,t,i,o),e.composite=this.modelConverter.convertCompositeTile(t),n&&e.composite&&(e.composite.setDataLoadEventDelegate(n.dataLoadEventDelegate),e.composite.copyDependencies(n),n instanceof d.SingleVisualCompositeTileModel&&e.composite instanceof d.SingleVisualCompositeTileModel&&this.mergeVisual(e.composite.visual,n.visual),n.tileDataIsVolatile)&&n.tileData&&n.tileData.data&&(e.composite.tileData=n.tileData),e.iframe=this.modelConverter.convertIframeTile(t),e.image=this.modelConverter.convertImageTile(t),e.model=this.modelConverter.convertModelTile(t),e.ssrs=this.modelConverter.convertSsrsTile(t),this.modelConverter.convertRealTimeTile(t));if(this.updateTileRealTimeModel(e,s,n),e&&e.reportTile?(s=e.reportTile.exploration,e.reportTile=this.modelConverter.convertReportTile(t),e.reportTile.exploration=s):e.reportTile=this.modelConverter.convertReportTile(t),_.isEmpty(r)||(n=this.modelConverter.getTileWorkbook(t.workbookId,t.packageId,r))&&(s=this.modelConverter.convertWorkbook(n),e.workbook=this.modelConverter.convertWorkbookTile(t,s,e)),o){r=this.modelConverter.getTileReport(t.reportId,o);r?(e.report=e.report||this.modelConverter.convertReport(r),this.modelConverter.fillReport(e.report,r)):e.report=null,e.contractsReport=this.modelConverter.getTileReport(t.reportId,o)}else if(a){for(var l=void 0,c=0,u=a.length;c<u;c++)if(t.reportId===a[c].id){l=a[c];break}l&&(e.report=e.report||l,this.modelConverter.fillReport(e.report,l.contract),e.contractsReport=l.contract)}t.modelId&&(e.contractsModel=this.modelConverter.getTileModel(t.modelId,i))},t.prototype.mergeWorkbook=function(e,t){var i=this;e&&t&&(e.contract=t,e.id=t.id||e.id,e.getPermissionsCallback=function(){return i.permissionService.getWorkbookEffectivePermissions(t)},e.name=t.name||e.name,e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,e.packageId=t.packageId||e.packageId)},t.prototype.mergeInstalledAppModel=function(e,t,i){t=this.modelConverter.convertInstalledAppModel(t,i);delete t.isFavorite,delete t.isFavoriteDisabled,delete t.favoriteInfo,_.extend(e,t)},t.prototype.updateTileRealTimeModel=function(e,t,i){e.realTime=i,t&&e.realTime&&e.realTime.copyRealTimeModelDependencies(t)},t.prototype.mergeVisual=function(e,t){t.visual&&e.type===t.type&&(e.visual=t.visual),e.viewport=t.viewport},n=t,d.DataServiceModelMerger=n})(powerbi=powerbi||{}),(function(l){var m,e,g,y,c,u,f,d,v,T,o;function r(e,t){t=t,(function(e,t,i,o,r,a,n,s,l){o&&(e.layoutType=o);i&&(e.elements=i);r&&(e.queryMetadata=r);n&&(e.heading1=n);a&&(e.heading2=a);s&&(e.heading3=s);t&&(e.transform=u.serializeTransformActions(u.serializeDataViewTransformActions(t,l&&l.objects)))})(o={$visualContainer:(i=e).visualContainer,$modelExtensions:i.modelExtensions,themeCollection:l.visualHost.ThemeUtils.cloneThemeCollection(i.themeCollection),dataSourceVariables:i.dataSourceVariables},i.dataTransforms,i.elements,i.tileLayoutType,i.queryMetadata,i.tileFilterDetails,i.tileHeading,i.tileSubDisplay,t);var i=o,t={version:v},o=null==(o=null==(o=e.visualContainer.config.singleVisual.vcObjects)?void 0:o.title)?void 0:o.find((function(e){return!e.selector}));return t.hideTitle=!1===(null==(o=null==(o=null==o?void 0:o.properties)?void 0:o.show)?void 0:o.value),null!=e.realTimeDataWindow?((o=i).dataWindow=e.realTimeDataWindow,t.realTimeVisual=o):t.visualContainer=i,t}function a(e,t){var i=[],e=(function(e,t){e=[{id:1,title:t.get("AddWidgetModal_IframeOption_Title"),description:t.get("AddWidgetModal_IframeOption_Description"),iconClass:"pbi-glyph-iframe",template:"<edit-iframe-widget></edit-iframe-widget>",defaultTileContract:{type:T.iframe,$action:{action:null,targetUrl:"",openInSameTab:!1},$config:{iframe:{srcUrl:"",embedCode:""},version:"1.0",widget:{id:1,name:"webContent"}},$layoutConfig:m.ContractUtils.createMasterLayoutConfig()},disabled:!e,tooltip:e?void 0:t.get("Dashboard_WebContentTiles_Disabled")},{id:2,title:t.get("Image"),description:t.get("AddWidgetModal_ImageOption_Description"),iconClass:"pbi-glyph-image",template:"<edit-image-widget></edit-image-widget>",defaultTileContract:{type:T.image,$action:{action:null,targetUrl:"",openInSameTab:!1},$config:{imageTile:{imageUrl:""},version:"1.0",widget:{id:2,name:"image"}},$layoutConfig:m.ContractUtils.createMasterLayoutConfig()}},{id:3,title:t.get("Textbox"),description:t.get("AddWidgetModal_TextOption_Description"),iconClass:"pbi-glyph-font",template:"<edit-text-widget></edit-text-widget>",defaultTileContract:{type:T.composite,$action:{action:null,targetUrl:"",openInSameTab:!1},$config:{version:"1.0",visualContainer:{layoutType:0,$visualContainer:{name:o.generateGuid(),config:{singleVisual:{objects:{},visualType:"textbox"}}},themeCollection:{}},widget:{id:3,name:"textbox"}},$layoutConfig:m.ContractUtils.createMasterLayoutConfig()}},{id:4,title:t.get("AddWidgetModal_VideoOption_Title"),description:t.get("AddWidgetModal_VideoOption_Description"),iconClass:"pbi-glyph-slideshow",template:"<edit-video-widget></edit-video-widget>",defaultTileContract:{type:T.iframe,$action:{action:null,targetUrl:"",openInSameTab:!1},$config:{iframe:{srcUrl:"",embedCode:""},version:"1.0",widget:{id:4,name:"video"}},$layoutConfig:m.ContractUtils.createMasterLayoutConfig()}}];return{title:t.get("Add_Widgets_Section_Title"),tiles:e}})(e,t),t=(e&&!_.isEmpty(e.tiles)&&i.push(e),(e=[]).push({id:6,title:(t=t).get("Realtime_TileTitle"),description:t.get("Realtime_TileDetails"),iconClass:"pbi-glyph-streaming-data",defaultTileContract:{type:T.realTime,$action:{action:null,targetUrl:"",openInSameTab:!1},$config:{realTimeVisual:{dataWindow:null,layoutType:0,$visualContainer:{name:o.generateGuid(),config:{singleVisual:null}},themeCollection:{}},version:"1.0"},$layoutConfig:m.ContractUtils.createMasterLayoutConfig({width:y.gridItemSmallLandscapeColSpan,height:y.gridItemSmallLandscapeRowSpan})}}),{title:t.get("Add_Realtime_Section_Title"),tiles:e});return _.isEmpty(t.tiles)||i.push(t),_.cloneDeep(i)}function n(e,t,i,o,r){var a=y.gridItemMediumLandscapeColSpan,n=y.gridItemMediumLandscapeRowSpan,i=(m.TileUtils.getVisualType(e)===l.visuals.plugins.card.name&&(a=y.gridItemSmallLandscapeColSpan,n=y.gridItemSmallLandscapeRowSpan),i?{modelQuery:{sq:JSON.stringify(i)}}:null),a=m.ContractUtils.createMasterLayoutConfig({width:a,height:n}),n={id:++g,type:t,query:i,$config:e,tileData:o?(function(e){if(void 0!==e)return JSON.stringify(e,(function(e,t){return e&&e.charAt&&"$"===e.charAt(0)?void 0:t}))})(o.data):null,tileDataSet:o,layoutConfig:JSON.stringify(a),$layoutConfig:a},t=e.visualContainer;return t&&(n.displayText=t.heading1,n.subDisplayText=t.heading3),r&&(n.modelId=r.id),n}m=l.dataServices||(l.dataServices={}),e=m.models||(m.models={}),y=l.common.GridLayoutConstants,c=l.data.services.DataViewObjectSerializer,u=l.data.services.DataViewTransformActionsSerializer,f=l.common.models.gridLayoutConstants,d=l.data.SQExpr,v=m.constants.upgrader.TileConfigVersion,T=m.contracts.TileType,o=jsCommon.Utility,e=e.TileFactory||(e.TileFactory={}),g=100,e.findModel=function(e,t,i){for(var o=0,r=i.length;o<r;o++){var a=i[o];if(a.vsName===e&&a.dbName===t)return a}},e.createCompositeTile=function(e,t,i,o){return n(e,T.composite,t,i,o)},e.createTileConfig=r,e.createTileForPinData=function(e,t,i){return t=r(e,t),e.tileDataType&&(t.tileDataType=e.tileDataType),(t=n(t,null!=e.realTimeDataWindow?T.realTime:T.composite,e.query,e.dataViewSource,i)).publishState=2,e.action&&(t.action=JSON.stringify(e.action)),null!=e.utterance&&(t.query.modelQuery.utterance=e.utterance),e.name&&(t.name=e.name),t.reportId=e.reportId,e.modelId&&(t.modelId=e.modelId),e.packageId&&(t.packageId=e.packageId),t.resourcePackageIds=e.resourcePackageIds,t},e.createNonVisualTileFromExisting=function(e){var t=_.omitBy({id:++g,type:e.type,query:e.query,action:e.action,$config:e.$config,tileData:e.tileData,tileDataSet:e.tileDataSet,publishState:e.publishState,displayText:e.displayText,subDisplayText:e.subDisplayText,modelId:e.modelId,reportId:e.reportId,workbookId:e.workbookId,packageId:e.packageId,name:e.name},(function(e){return void 0===e})),e=m.ContractUtils.getMasterLayoutPosition(e),e=m.ContractUtils.createMasterLayoutConfig({height:e.height,width:e.width});return t.$layoutConfig=e,t.layoutConfig=JSON.stringify(e),t},e.createReportTileForExploreData=function(e,t,i,o,r,a,n,s,l,c,u,d){var p,h={version:v},s=((s||l)&&(h.reportTile={pod:s,filters:l}),c&&(p={modelQuery:{utterance:c}}),2*y.defaultGridWidth),l=2*y.defaultGridHeight,c=u?u/s:2,u=d?d/l:2,s=(0===Math.round(c)&&(c=2),0===Math.round(u)&&(c=2),Math.round(y.gridItemMediumLandscapeColSpan*c)),d=Math.round(y.gridItemMediumLandscapeRowSpan*u),s=s>f.getGridMaxColSpan()?f.getGridMaxColSpan():s,d=d>f.getGridMaxRowSpan()?f.getGridMaxRowSpan():d,l=m.ContractUtils.createMasterLayoutConfig({width:s,height:d});return{id:++g,type:T.report,displayText:r,subDisplayText:a,action:JSON.stringify(n),reportId:e,sectionId:o,modelId:t,packageId:i,publishState:2,query:p,config:h?JSON.stringify(h):void 0,$config:h,layoutConfig:JSON.stringify(l),$layoutConfig:l}},e.isTileLoading=function(e){return 1===e.publishState},e.isTileLocked=function(e){return 20===e.errorCode},e.getTileGalleryGroups=a,e.getTileTemplate=function(t,e){for(var i=0,o=a(!0,e);i<o.length;i++){var r=o[i],r=_.find(r.tiles,(function(e){return e.id===t}));if(null!=r)return r.template}return null},e.serializeTileConfig=function(e,t,i,o){var r,a,n,s;if(e)return(a=(r=_.cloneDeep(e)).realTimeVisual||r.visualContainer)&&(o?(n=e.realTimeVisual||e.visualContainer,a.visualContainer=t.serializeVisualContainer(n.$visualContainer)):(o=a.$visualContainer.config.singleVisual,(s=l.data.DataViewObjectDefinitions.getValue(o.vcObjects,{objectName:"stylePreset",propertyName:"name"},void 0))&&d.isConstant(s)&&s.value&&(a.stylePresetName=s.value),a.visual=o.visualType,a.columnProperties=o.columnProperties,(s=(n=e.realTimeVisual||e.visualContainer).$visualContainer.config.singleVisual.objects)&&(i=i.capabilities(o.visualType))&&i.objects&&(a.objects=c.serializeObjects(s,i.objects)),(o=e.visualContainer&&n.$visualContainer.config.singleVisual.vcObjects)&&(a.vcObjects=c.serializeObjects(o,l.explore.contracts.VisualContainer.CommonObjectDescriptors)),r.visualContainer&&(r.visual=a,delete r.visualContainer),r.version="0.1"),a.$modelExtensions&&(a.modelExtensions=t.serializeModelExtensions(a.$modelExtensions)),delete a.$visualContainer,delete a.$modelExtensions),JSON.stringify(r)}})(powerbi=powerbi||{}),(function(e){var t,i,o,r;function a(e){var t=i.call(this,void 0===e?0:e.id,1,void 0===e?0:e.packageId)||this;return t.contract=e,t}t=(t=e.dataServices||(e.dataServices={})).models||(t.models={}),o=e.common.contracts.ContentTileType,r=jsCommon.EnumExtensions,e=e.common.models.ReportResource,__extends(a,i=e),a.prototype.getPermissions=function(){var e;return(e=this.getPermissionsCallback?this.getPermissionsCallback():e)||this.contract&&this.contract.permissions},Object.defineProperty(a.prototype,"contentTileType",{get:function(){return o.Workbook},enumerable:!1,configurable:!0}),a.prototype.isOwner=function(){return r.hasFlag(this.getPermissions(),7)},a.prototype.isPersonalized=function(){var e=this.getPermissions();return r.hasFlag(e,11)&&!r.hasFlag(e,7)},a.prototype.isEditable=function(){var e=this.editUrl;return this.isOwner()&&null!=e&&""!==e},Object.defineProperty(a.prototype,"displayNameWithExtension",{get:function(){var e=jsCommon.FileUtils.getFileExtension(this.contract.sourceFilePath);return this.displayName.concat(".").concat(e)},enumerable:!1,configurable:!0}),e=a,t.Workbook=e})(powerbi=powerbi||{}),(function(n){var l,o,t,s,r,i,c,a,u,e,g;function d(e,t,i){this.useSmallPlotArea=!1,this.contract=e,this.visualPluginService=t,this.pluginOps=i}function p(e,t,i,o,r,a,n,s,l,c,u,d,p,h){var m=g.call(this,e,t,i)||this,e=(m.featureSwitchService=o,m.geolocationService=r,m.geocoder=a,m.promiseFactory=n,m.moduleLoader=s,m.telemetryService=l,m.themeService=c,m.authenticationService=u,m.localizationService=d,m.visualHostTooltipService=p,m.requiresResize=!1,h&&(m.licenseUIManager=h.create()),{onNotifyLicense:function(e){return m.onNotifyLicense(e)},onClearLicenseNotification:function(){return m.onClearLicenseNotification()},onNotifyFeatureBlocked:function(e){return m.onNotifyFeatureBlocked(e)}});return m._visual={hostServices:m.createHostServices(h?e:void 0),themeCollection:{}},m}l=n.dataServices||(n.dataServices={}),o=l.models||(l.models={}),t=n.explore.services.createVisualHostServices,s=n.data.services.DataViewTransformActionsSerializer,r=n.common.models.gridLayoutConstants,i=n.common.helpers.ModelConverterHelper,c=n.data.SQExpr,a=n.explore.util.ThemeUtils,u=n.explore.util.VisualContainerUtils,Object.defineProperty(d.prototype,"type",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"tileData",{get:function(){return null},set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"tileDataIsVolatile",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"isError",{get:function(){return this._isError},set:function(e){this._isError=e,this.onErrorDelegate&&this.onErrorDelegate()},enumerable:!1,configurable:!0}),d.prototype.isDataStale=function(e){return!1},Object.defineProperty(d.prototype,"heading1",{get:function(){return this.config.heading1||""},enumerable:!1,configurable:!0}),d.prototype.setDependencies=function(e){this.dataProxy=e},d.prototype.setDataLoadEventDelegate=function(e){this.dataLoadEventDelegate=e},d.prototype.copyDependencies=function(e){e.dataProxy&&this.setDependencies(e.dataProxy)},e=d,o.CompositeTileModel=e,o.staleDataDeltaInMs=36e5,__extends(p,g=e),Object.defineProperty(p.prototype,"type",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"visual",{get:function(){return this._visual},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"themeCollection",{get:function(){return this._visual&&this._visual.themeCollection},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"heading1",{get:function(){var e,t,i,o=this.config.heading1||"";return this.visual&&((t=this.visual.dataTransforms)&&(e=t.selects),(t=this.visual.data)&&(i=t.dataView),!1!==this.cachedShow&&void 0===this.cachedHeading&&(t=u.evaluateObjectDefinitions(this.themeCollection,this.themeService,this.config.$visualContainer,this.featureSwitchService.featureSwitches,!1,i,e)).dataViewObjects&&(void 0===this.cachedShow&&(this.cachedShow=n.DataViewObjects.getValue(t.dataViewObjects,{objectName:"title",propertyName:"show"},!0)),this.cachedShow)&&(null!==(i=n.DataViewObjects.getValue(t.dataViewObjects,{objectName:"title",propertyName:"text"},null))?this.cachedHeading=i:_.isEmpty(o)&&(o=" ")),this.cachedHeading)||o},enumerable:!1,configurable:!0}),p.prototype.setThemeName=function(e){this.ensureVisual();var t=this._visual.themeCollection;t.customTheme=t.customTheme||a.getThemeMetadata(e,1),t.customTheme.name=e},p.prototype.isDataStale=function(e){var t;return!!e&&(t=this.contract,!!(t=(t=i.convertRefreshTimeToJsDateTime(t.tileDataUpdatedTime))&&t.getTime()))&&e-t>o.staleDataDeltaInMs},p.prototype.setData=function(e,t,i){try{this.ensureVisual(),this._visual.data=e,this._visual.dataTransforms=t,this._visual.type=i,this.clearCache()}catch(e){this.telemetryService.logEvent(n.telemetry.TileDataUpdateException,{visualType:i,source:e.fileName,lineNumber:e.lineNumber,columnNumber:e.columnNumber,stack:e.stack,message:e.message})}},p.prototype.createHostServices=function(e){return t({geocoder:this.geocoder,geolocation:this.geolocationService,localizationService:this.localizationService,moduleLoader:this.moduleLoader,promiseFactory:this.promiseFactory,visualHostTooltipService:this.visualHostTooltipService,authenticationService:this.authenticationService,canExpandCollapse:function(){return!0},onNotifyLicense:e&&e.onNotifyLicense,onClearLicenseNotification:e&&e.onClearLicenseNotification,onNotifyFeatureBlocked:e&&e.onNotifyFeatureBlocked})},p.prototype.ensureVisual=function(){this._visual||(this._visual={hostServices:this.createHostServices(),themeCollection:{}},this.calculateLayout())},Object.defineProperty(p.prototype,"config",{get:function(){return this._config},set:function(e){var t,i,o,r,a;this._config=e,this._visual&&(a=(t=e.$visualContainer.config.singleVisual).visualType,this._visual.type=a,r=n.data.DataViewObjectDefinitions.getValue(t.vcObjects,{objectName:"stylePreset",propertyName:"name"},void 0),this._visual.stylePresetName=r&&c.isConstant(r)&&r.value,this._visual.themeCollection=_.cloneDeep(e.themeCollection),(r=this.visualPluginService.capabilities(a))&&(i=r.objects,o=t.objects),a=jsCommon.JsonExtensions.tryParseJSON(e.transform),this._visual.dataTransforms=a?s.deserializeDataViewTransformActions(a,r):s.createTransformActions(e.queryMetadata,e.elements,i,o))},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"tileData",{get:function(){return this._tileData},set:function(e){this._tileData=e,this.readDataView(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"tileDataIsVolatile",{get:function(){return this.contract.tileDataIsVolatile},enumerable:!1,configurable:!0}),p.prototype.refreshData=function(){this.readDataView(!1)},p.prototype.setDependencies=function(e){var t=!this.dataProxy&&this._tileData&&!this.isLoading;g.prototype.setDependencies.call(this,e),t&&this.refreshData()},p.prototype.readDataView=function(s){return __awaiter(this,void 0,n.Promise,(function(){var t,i,o,r,a,n;return __generator(this,(function(e){switch(e.label){case 0:if(o=this._visual.type,this.visual&&!this.requiresData())return this._visual.data={dataView:null},[2];if(this._tileData,!(t=this.dataProxy))return[2];if(this.contract.queryResultError&&((i=l.TileUtils.getTileErrorDetailsFromQueryResultError(this.contract.queryResultError,this.localizationService))?(this.isError=!0,this.errorDetails=i,this.errorText=i.message):this.errorText=this.localizationService.get("Tile_ErrorText")),!this._tileData||!this._tileData.data)return this.isLoading=!this.isError,[2];i=this._tileData,o={type:i.type,query:{dataSources:null,command:i.data},allowResultFromClientCache:s,perfId:o,kinds:this.pluginOps.dataViewKinds(o)},r=null,this.dataLoadEventDelegate&&(r=this.dataLoadEventDelegate(),this.dataLoadEventDelegate=null),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,t.execute(o)];case 2:return n=e.sent(),a={dataView:n&&n.dataReaderResult?n.dataReaderResult.dataView:null,dataViewSource:n&&n.dataViewSource?n.dataViewSource:null},n=n.dataReaderResult.error,this._visual.data=a,this.isError=this.isError||null!=n,r&&(this.isError?r.reject():r.resolve()),[3,4];case 3:return e.sent(),this.isError=!0,r&&r.reject(),[3,4];case 4:return[2]}}))}))},p.prototype.applyLayout=function(e,t){var i;this.requiresResize&&(t||(t=this.visual)&&t.visual&&(i=t.visual,e=e===r.changeType.resized?2:e===r.changeType.resizing?1:void 0,i.update({viewport:t.viewport,dataViews:t.dataViews,suppressAnimations:!0,type:n.VisualUpdateType.Resize,resizeMode:e})),this.requiresResize=!1)},p.prototype.calculateLayout=function(e,t,i){void 0===i&&(i=1),e&&(this.viewport&&this.viewport.height===e.height&&this.viewport.width===e.width||(this.requiresResize=!0),this.viewport=e),null!=t&&this.useSmallPlotArea!==t&&(this.useSmallPlotArea=t,this.requiresResize=!0),this.viewport&&(e=this.viewport.height,t=this.viewport.width,1!==(this._config&&this._config.layoutType)&&(this.useSmallPlotArea?e-=o.TileConstants.VisualSmallVerticalMargin:e-=o.TileConstants.VisualVerticalMargin,t-=o.TileConstants.VisualHorizontalMargin),this._visual)&&(this._visual.viewport={height:e,width:t,scale:i})},p.prototype.canResizeTo=function(e){var t=this._visual&&this._visual.visual;return!!t&&(!t.canResizeTo||t.canResizeTo(n.common.GridLayoutConstants.getDefaultGridItemViewport(e)))},p.prototype.getErrorLocId=function(e,t){return""},p.prototype.requiresData=function(){var e=this.visual,t=this.pluginOps;if(e){if(e&&e.type){if(!t)return!0;if(!t.isQueryVisual(e.type))return!1}return!0}},p.prototype.updateVisualInteractivityOptions=function(e){var t=this.visualPluginService.getInteractivityOptions(this._visual.type);void 0!==t.isInteractiveLegend&&(t.isInteractiveLegend=t.isInteractiveLegend&&e),this._visual.interactivityOptions=t},p.prototype.clearCache=function(){this.cachedHeading=void 0},p.prototype.onNotifyLicense=function(e){0!==e&&this.licenseUIManager.displayNotification(e)},p.prototype.onNotifyFeatureBlocked=function(e){this.licenseUIManager.displayFeatureBlockedBanner(e)},p.prototype.onClearLicenseNotification=function(){this.licenseUIManager.clearNotification()},e=p,o.SingleVisualCompositeTileModel=p})(powerbi=powerbi||{}),(function(t){var e;function i(e){this.contract=e}e=(e=t.dataServices||(t.dataServices={})).models||(e.models={}),i.prototype.canResizeTo=function(e){return e.rowSpan===t.common.GridLayoutConstants.gridItemMediumLandscapeRowSpan||e.colSpan===t.common.GridLayoutConstants.gridItemSmallLandscapeColSpan},i.prototype.getErrorLocId=function(e,t){return""},e.IframeTileModel=i})(powerbi=powerbi||{}),(function(t){var e;function i(e){this.contract=e}e=(e=t.dataServices||(t.dataServices={})).models||(e.models={}),Object.defineProperty(i.prototype,"imageUrl",{get:function(){return this._imageUrl},set:function(e){(this._imageUrl=e)&&!this.isStatic&&0!==e.indexOf("data:")&&(this._imageUrl=jsCommon.Utility.getAbsoluteUri(e))},enumerable:!1,configurable:!0}),i.prototype.canResizeTo=function(e){return e.rowSpan===t.common.GridLayoutConstants.gridItemMediumLandscapeRowSpan||e.colSpan===t.common.GridLayoutConstants.gridItemSmallLandscapeColSpan},i.prototype.getErrorLocId=function(e,t){return""},e.ImageTileModel=i})(powerbi=powerbi||{}),(function(t){var e;function i(e){this.contract=e}e=(e=t.dataServices||(t.dataServices={})).models||(e.models={}),i.prototype.canResizeTo=function(e){return e.rowSpan===t.common.GridLayoutConstants.gridItemSmallLandscapeRowSpan},i.prototype.getErrorLocId=function(e,t){return""},e.ModelTileModel=i})(powerbi=powerbi||{}),(function(r){var a,n,h,s,l,t;function e(e,t,i,o,r,a,n,s,l,c,u,d,p){e=h.call(this,e,t,i,o,r,a,n,s,l,c,u,d,p)||this;return e._visual=null,e._localizationService=d,e}a=r.dataServices||(r.dataServices={}),n=a.models||(a.models={}),s=a.constants.SingleValueRealTimeWindow,l=r.data.EmptyDataClientError,t=r.data.FailedRealTimeUpdateClientError,h=n.SingleVisualCompositeTileModel,__extends(e,h),e.prototype.setModelId=function(t){return __awaiter(this,void 0,r.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.contract.modelId=t,[4,this.initialize()];case 1:return e.sent(),[2]}}))}))},e.prototype.getRealTimeModelId=function(){return __awaiter(this,void 0,r.Promise,(function(){var i,o=this;return __generator(this,(function(e){return this.datasetStore?(i=this.contract,[2,this.datasetStore.findAll(i.modelId,!0).then((function(e){var t;if(!_.isEmpty(e))return{id:(t=(t=(t=_.find(e,(function(e){return null==i.packageId||e.packageId===i.packageId})))||_.find(e,(function(e){return jsCommon.EnumExtensions.hasFlag(e.permissions,7)})))||_.first(e)).id,originalModelId:t.originalModelId,tableName:o.getSchemaTableName(),schema:o.getRealTimeConceptualSchema(),packageId:i.packageId}}))]):[2,void 0]}))}))},e.prototype.setRealTimeModelDependencies=function(e,t,i,o,r){h.prototype.setDependencies.call(this,e),this.visualQueryGenerator=t,this.conceptualSchemaProxy=i,this.realTimeDataService=o,this.datasetStore=r},e.prototype.copyRealTimeModelDependencies=function(i){return __awaiter(this,void 0,r.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(i.schema&&(this.schema=i.schema),i.dataProxy&&i.realTimeDataService&&i.visualQueryGenerator&&i.conceptualSchemaProxy)?(this.setRealTimeModelDependencies(i.dataProxy,i.visualQueryGenerator,i.conceptualSchemaProxy,i.realTimeDataService,i.datasetStore),i.onErrorDelegate&&!this.onErrorDelegate&&(this.onErrorDelegate=i.onErrorDelegate),[4,i.getRealTimeModelId()]):[2];case 1:return t=e.sent(),this.realTimeDataService.replaceListener(t,i,this),[2]}}))}))},e.prototype.onDataChanged=function(){return __awaiter(this,void 0,r.Promise,(function(){var t,i,o,r,a=this;return __generator(this,(function(e){switch(e.label){case 0:return(this.visualQueryGenerator,this.dataProxy,this.singleVisualConfig)?(t=s,(i=this.config)&&i.dataWindow&&(t=i.dataWindow),[4,this.getDatasources()]):[2];case 1:return i=e.sent(),!(o=this.visualQueryGenerator.execute({dataSources:i,schema:this.schema,config:this.singleVisualConfig,additionalFilters:null,dataWindow:t}))||o.error?(r=void 0,o&&o.error&&(r=o.error.getDetails(this._localizationService)),this.onError(r)):this.dataProxy.execute(o.options).then((function(e){a.isError=!1;var e={dataView:e&&e.dataReaderResult?e.dataReaderResult.dataView:null},t=a.lastCategoryValue;try{var i=n.RealTimeModelUtility.getLastDateOrNumericCategoryValue(e.dataView);if(null!=t&&null!=i&&t.valueOf()>=i.valueOf())return;a.lastCategoryValue=i}catch(e){}a.setData(e,o.transforms,a.config.$visualContainer.config.singleVisual.visualType),a.isLoading=!1}),(function(e){e instanceof l||(e=e&&e.getDetails(a._localizationService),a.onError(e))})),[2]}}))}))},e.prototype.onError=function(e){e=e||(new t).getDetails(this._localizationService),this.setErrorDetails(e)},e.prototype.getDatasources=function(){return __awaiter(this,void 0,r.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getRealTimeModelId()];case 1:return(t=e.sent())?[2,n.RealTimeModelUtility.getRealTimeDataSource(t.id,t.originalModelId)]:[2,void 0]}}))}))},Object.defineProperty(e.prototype,"singleVisualConfig",{get:function(){return this.config.$visualContainer.config.singleVisual},set:function(e){this.config.$visualContainer.config.singleVisual=e,this.onDataChanged()},enumerable:!1,configurable:!0}),e.prototype.isDataStale=function(){return!1},e.prototype.initialize=function(){return __awaiter(this,void 0,r.Promise,(function(){var t,i=this;return __generator(this,(function(e){return t=a.ContractUtils.getMasterLayoutPosition(this.contract),this.size={rowSpan:t.height,colSpan:t.width},[2,this.getDatasources().then((function(e){if(e)return i.conceptualSchemaProxy.get(e).then((function(e){return i.fixUpSchema(e),i.schema=e,i.getRealTimeModelId().then((function(e){i.realTimeDataService.subscribe(e,i)}))}))}))]}))}))},e.prototype.unsubscribe=function(){return __awaiter(this,void 0,r.Promise,(function(){var t=this;return __generator(this,(function(e){return[2,this.getRealTimeModelId().then((function(e){if(e&&e.tableName)return t.realTimeDataService.unsubscribe(e,t)}))]}))}))},e.prototype.fixUpSchema=function(e){for(var e=e.schema(a.constants.RealTimeDataSourceName).entities,t=0,i=e[0].properties;t<i.length;t++){var o=i[t];o.type!==r.ValueType.fromDescriptor({numeric:!0})&&o.type!==r.ValueType.fromDescriptor({integer:!0})||(o.kind=1)}},e.prototype.getSchemaTableName=function(){var e=this.getRealTimeConceptualSchema();if(e)return e=e.entities,_.head(e).name},e.prototype.getRealTimeConceptualSchema=function(){if(this.schema)return this.schema.schema(a.constants.RealTimeDataSourceName)},e.prototype.setErrorDetails=function(e){this.errorDetails=e,this.errorText=e.message,this.isError=!0},n.RealTimeTileModel=e})(powerbi=powerbi||{}),(function(a){var i,e,n;i=a.dataServices||(a.dataServices={}),e=i.models||(i.models={}),n=e.RealTimeModel,(e=e.RealTimeModelUtility||(e.RealTimeModelUtility={})).getRealTimeDataSource=function(e,t){if(e&&!(e<0))return a.explore.contracts.createDataSourceArray([{id:e,type:a.data.tabular.type,name:i.constants.RealTimeDataSourceName,tabular:{modelId:null!=t?t:e}}])},e.convertToColumnsDefinition=function(e){if(e=a.data.tabular.getColumnsMetadata(e)){for(var t=[],i=0,o=e;i<o.length;i++){var r=o[i];t.push({name:r.name,dataType:n.convertToRealTimeDataType(a.ValueType.fromDescriptor(r.type))})}return t}},e.getLastDateOrNumericCategoryValue=function(e){if(e=e&&e.categorical)return e=(e=_.head(e.categories))&&e.values,!_.isEmpty(e)&&(e=_.last(e))&&!_.isBoolean(e)&&(_.isDate(e)||_.isNumber(e))?e:void 0}})(powerbi=powerbi||{}),(function(t){var e;function i(e){this.contract=e,this.exploration={contract:void 0,exploreCanvas:void 0,sections:[]},this.isError=!1,this.tilesUpdated=!1}e=(e=t.dataServices||(t.dataServices={})).models||(e.models={}),i.prototype.canResizeTo=function(e){return e.rowSpan===t.common.GridLayoutConstants.gridItemMediumLandscapeRowSpan||e.colSpan===t.common.GridLayoutConstants.gridItemSmallLandscapeColSpan},i.prototype.getErrorLocId=function(e,t){return""},e.ReportTileModel=i})(powerbi=powerbi||{}),(function(t){var e;function i(e){this.contract=e}e=(e=t.dataServices||(t.dataServices={})).models||(e.models={}),Object.defineProperty(i.prototype,"imageUrl",{get:function(){return this._imageUrl},set:function(e){e&&(0!==e.indexOf("data:")?this._imageUrl=jsCommon.Utility.getAbsoluteUri(e):this._imageUrl=e)},enumerable:!1,configurable:!0}),i.prototype.canResizeTo=function(e){return e.rowSpan===t.common.GridLayoutConstants.gridItemLargeLandscapeRowSpan||e.colSpan===t.common.GridLayoutConstants.gridItemLargeLandscapeColSpan},i.prototype.getErrorLocId=function(e,t){return""},e.SsrsTileModel=i})(powerbi=powerbi||{}),(function(e){var r,a,t,i,n,s,o,l,c;function u(e){return!_.isEmpty(e)&&0===e.toLowerCase().indexOf(t.DashboardIntraDomainNavigationPrefix)}function d(e){return!_.isEmpty(e)&&0===e.toLowerCase().indexOf(t.ReportIntraDomainNavigationPrefix)}function p(e){return!_.isEmpty(e)&&0===e.toLowerCase().indexOf(t.RdlReportIntraDomainNavigationPrefix)}function h(e){return!_.isEmpty(e)&&0===e.toLowerCase().indexOf(t.WorkbookIntraDomainNavigationPrefix)}function m(e){return u(e)||d(e)||p(e)||h(e)}function g(e,t,i){this.forceOpenCustomLinksInNewTab=i,this.isSelected=!1,this.hasConversation=!1,this.hasSpotlight=!1,this.contract=e,this.tileHeaderSize=1,this.layoutPosition={},this.localizationService=t,this.themeName="Light",this.tileStyles={},this.tileHeaderStyles={},this.tileBackground={}}r=e.dataServices||(e.dataServices={}),t=r.models||(r.models={}),i=jsCommon.ArrayExtensions,n=jsCommon.DateExtensions,s=e.common.utils.DateFormatter,o=e.common.helpers.ModelConverterHelper,l=jsCommon.UrlUtils,(e=t.IntraDomainNavigationType||(t.IntraDomainNavigationType={}))[e.Dashboard=0]="Dashboard",e[e.Report=1]="Report",e[e.RdlReport=2]="RdlReport",t.getDashboardGuidFromUrl=function(e){if(!(_.isEmpty(e)||e.length<t.DashboardIntraDomainNavigationPrefix.length)&&u(e))return e.substr(t.DashboardIntraDomainNavigationPrefix.length)},t.IsDashboardIntraDomainPrefix=u,t.IsReportIntraDomainPrefix=d,t.IsRdlReportIntraDomainPrefix=p,t.IsWorkbookIntraDomainPrefix=h,t.IsValidIntraDomainPrefix=m,t.DashboardIntraDomainNavigationPrefix="/dashboards/",t.ReportIntraDomainNavigationPrefix="/reports/",t.RdlReportIntraDomainNavigationPrefix="/rdlreports/",t.WorkbookIntraDomainNavigationPrefix="/workbooks/",(e=a=t.TileConstants||(t.TileConstants={})).SubtitleHeight=10,e.TileDefaultPadding=10,e.RegularHeaderHeight=50,e.SmallHeaderHeight=42,e.LargeHeaderHeight=65,e.sensitivityDesktopBannerHeight=44,e.sensitivityMobileBannerHeight=40,e.sensitivityMobileExpendBannerHeight=64,e.VisualVerticalMargin=20,e.VisualHorizontalMargin=20,e.VisualSmallVerticalMargin=8,Object.defineProperty(g.prototype,"gridLayouts",{get:function(){return this.contract.$layoutConfig.layouts},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"id",{get:function(){return this.contract.id},set:function(e){this.contract.id=e},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"objectId",{get:function(){return this.contract.objectId},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"details",{get:function(){switch(this.type){case r.contracts.TileType.composite:return this.composite;case r.contracts.TileType.iframe:return this.iframe;case r.contracts.TileType.image:return this.image;case r.contracts.TileType.model:return this.model;case r.contracts.TileType.ssrs:return this.ssrs;case r.contracts.TileType.workbook:return this.workbook;case r.contracts.TileType.report:return this.reportTile;case r.contracts.TileType.realTime:return this.realTime;default:return null}},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"shouldBeIncludedInTelemetryMeasurement",{get:function(){return this.details&&!!this.details.shouldBeIncludedInTelemetryMeasurement},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"isTemporary",{get:function(){return this.id<=0},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"isTileLoading",{get:function(){return this.composite?this.composite.isLoading&&!this.composite.isError:this.isLoading},enumerable:!1,configurable:!0}),g.prototype.calculateLayout=function(e,t){var i,o=this.getHeaderSizeByType(this.tileHeaderSize);_.isNil(this.currentViewPort)||!_.isNil(e)||_.isNil(t)||(e=this.currentViewPort),this.compositeTile&&e&&(e=e,i=2===this.tileHeaderSize,_.isNil(t)||_.isNil(this.currentViewPort)?(i?this.hasTitle()?e.height-=o:1!==(this.composite&&this.composite.config&&this.composite.config.layoutType)&&(e.height-=a.TileDefaultPadding):this.hasTitle()&&(this.hasSubtitle()?e.height-=o:e.height-=o-a.SubtitleHeight),this.currentViewPort=e):0<t&&((o={width:this.currentViewPort.width,height:this.currentViewPort.height}).height-=t,o.height<=0||(e=o)),this.compositeTile.calculateLayout(e,i))},g.prototype.getTileHeight=function(){return this.hasTitle()?this.getHeaderSizeByType(this.tileHeaderSize):0},g.prototype.applyLayout=function(e,t){this.compositeTile&&this.compositeTile.applyLayout(e,t)},g.prototype.invalidateLayout=function(){this.tryPopulateLayoutPositionValues()&&this.gridLayoutContext.onLayoutInvalidated()},g.prototype.tryPopulateLayoutPositionValues=function(){var e;return!(!this.gridLayoutContext||this.gridLayoutContext.isLayoutUpdateLocked||(e=this.gridLayoutContext.getActiveLayout(),(e=i.extendWithId(this.contract.$layoutConfig.layouts).withId(e))&&e.position&&(this.layoutPosition=_.cloneDeep(e.position)),0))},g.prototype.applyChanges=function(){var e,t;this.contract&&this.gridLayoutContext&&(e=_.cloneDeep(this.layoutPosition),t=this.contract.$layoutConfig,r.TileUtils.addOrUpdateLayoutPosition(t,e,this.gridLayoutContext.getActiveLayout()),this.contract.layoutConfig=JSON.stringify(this.contract.$layoutConfig))},g.isValidUrl=function(e,t){return!_.isEmpty(e)&&(l.isValidHttpUrl(e,!1)||t&&m(e))},g.prototype.getDisplayText=function(){return this.displayText||(this.compositeTile?this.compositeTile.heading1:"")},g.prototype.getSubDisplayText=function(){if(this.displayText&&this.subDisplayText)return this.subDisplayText;if(this.compositeTile){var e=this.compositeTile.config;if(!this.displayText&&e&&!_.isEmpty(e.heading3))return e.heading3}return""},g.prototype.shouldPlaceBulletSeperator=function(){return this.displayText&&0<this.displayText.length&&this.subDisplayText&&0<this.subDisplayText.length&&this.config&&this.config.lastRefreshTimeEnabled},Object.defineProperty(g.prototype,"hrefTarget",{get:function(){return this.action.openInSameTab&&!this.forceOpenCustomLinksInNewTab?"_self":"_blank"},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"lastRefreshTimeInLocaleString",{get:function(){var e=o.convertRefreshTimeToJsDateTime(this.contract.tileDataUpdatedTime),t="";return e?t=e.toLocaleString():this.datasetModel&&(t=this.datasetModel.lastRefreshTimeInLocaleString),t||""},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"formattedTime",{get:function(){var e;return(e=this.workbook?(e=this.contract.tilePackage)?o.convertRefreshTimeToJsDateTime(e.lastRefreshTime):null:o.convertRefreshTimeToJsDateTime(this.contract.tileDataUpdatedTime))?this.cachedRefreshTime&&e.getTime()===this.cachedRefreshTime.getTime()?this.cachedRefreshString:(this.cachedRefreshTime=e,this.cachedRefreshString=this.getFormattedDateString(e)):this.datasetModel?this.datasetModel.lastRefreshTimeInLocaleString:void 0},enumerable:!1,configurable:!0}),g.prototype.getFormattedDateString=function(e){var t=c,i=n.isContainedInTimeFrame,o=n.isMomentPresent();return o&&i(e,t.Minute,t.MaxMinuteThreshold,!1)?s.getPrettyRelativeDate(e,this.localizationService):o&&i(e,t.Day,t.SameDayThreshold,!0)?n.GetTime(this.localizationService.currentLanguageLocale,e):o&&i(e,t.Day,t.YesterdayThreshold,!0)?this.localizationService.format("DashboardTile_YesterdayTemplate",[n.GetTime(this.localizationService.currentLanguageLocale,e)]):o&&i(e,t.Day,t.WeekThreshold,!0)?n.GetDayWithTime(this.localizationService.currentLanguageLocale,e):n.GetFullDateWithTime(this.localizationService.currentLanguageLocale,e)},g.prototype.setDatasetModelAndPackageInfo=function(e,t){e&&(this.datasetModel=e,t)&&(this.datasetModel.packagePublishStatus=t.publishOrRefreshStatus)},g.prototype.hasTitle=function(){return(!this.config||!this.config.hideTitle)&&(!_.isEmpty(this.displayText)||this.compositeTile&&!_.isEmpty(this.compositeTile.heading1))},g.prototype.hasSubtitle=function(){var e=this.config;return(!e||!e.hideTitle)&&(!_.isEmpty(this.subDisplayText)||e&&e.lastRefreshTimeEnabled)},g.prototype.lastRefreshTimeInLocaleWithLabel=function(){if(this.config&&this.config.lastRefreshTimeEnabled)return this.localizationService.format("Refreshed",[this.formattedTime])},g.prototype.setTileHeaderSize=function(e){this.tileHeaderSize!==e&&(this.tileHeaderSize=e,this.invalidateLayout())},Object.defineProperty(g.prototype,"compositeTile",{get:function(){return this.composite||this.realTime},enumerable:!1,configurable:!0}),g.prototype.hasLayoutDefinition=function(e){return!!i.extendWithId(this.contract.$layoutConfig.layouts).withId(e)},g.prototype.hasLayoutPosition=function(e){return!!r.ContractUtils.getLayoutPosition(this.contract,e)},g.prototype.removeLayoutPosition=function(e){return void 0===e&&(e=1),this.hasLayoutDefinition(e)&&(this.addLayout({id:e,position:null},e),this.resetTileLayoutSizeAndPosition()),this.getCurrentTileLayoutDescriptor()},g.prototype.resetTileLayoutSizeAndPosition=function(){this.layoutPosition.x=null,this.layoutPosition.y=null,this.layoutPosition.height=null,this.layoutPosition.width=null,this.gridLayoutContext=null},g.prototype.removeLayoutDefinition=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!0),this.hasLayoutDefinition(t)&&(_.remove(this.contract.$layoutConfig.layouts,(function(e){return e.id===t})),e)&&this.resetTileLayoutSizeAndPosition(),this.getCurrentTileLayoutDescriptor()},g.prototype.applyLayoutSize=function(e,t,i){this.compositeTile&&(this.compositeTile.size={colSpan:e.colSpan,rowSpan:e.rowSpan}),this.applyLayout(t,i)},g.prototype.getCurrentTileLayoutDescriptor=function(e,t,i){e=e||this.contract.$layoutConfig;return r.TileUtils.getCurrentTileLayoutDescriptor(this.contract,e,t,i)},g.prototype.buildLayoutDescriptor=function(){var e=_.cloneDeep(this.layoutPosition),t=_.cloneDeep(this.contract.$layoutConfig),i=(r.TileUtils.addOrUpdateLayoutPosition(t,e,this.gridLayoutContext.getActiveLayout()),this.composite&&this.composite.contract&&this.composite.contract.query),e=i&&r.TileUtils.getTileQueryAfterResize(i,e),o=null;return i&&e&&(this.composite.contract.query.modelQuery.sq=JSON.stringify(e),o=JSON.stringify(this.composite.contract.query)),r.TileUtils.getCurrentTileLayoutDescriptor(this.contract,t,i,o)},g.prototype.addLayout=function(e,t){return this.removeLayoutDefinition(t),this.contract.$layoutConfig.layouts.push(e),this.getCurrentTileLayoutDescriptor()},g.prototype.getHeaderSizeByType=function(e){switch(e){case 0:return a.LargeHeaderHeight;case 2:return a.SmallHeaderHeight;default:return a.RegularHeaderHeight}},e=g,t.Tile=e,(e=c=c||{}).Minute="minute",e.Day="day",e.MaxMinuteThreshold=15,e.SameDayThreshold=0,e.YesterdayThreshold=1,e.WeekThreshold=6})(powerbi=powerbi||{}),(function(t){var e;function i(e,t){this.contract=e,this.tileModel=t}e=(e=t.dataServices||(t.dataServices={})).models||(e.models={}),i.prototype.canResizeTo=function(e){return e.rowSpan===t.common.GridLayoutConstants.gridItemMediumLandscapeRowSpan||e.colSpan===t.common.GridLayoutConstants.gridItemSmallLandscapeColSpan},i.prototype.getErrorLocId=function(e,t){var i,o=[];switch(e){case 10:i="WorkbookTile_GeneralError";break;case 11:i="WorkbookTile_FileNotFound";break;case 12:i="WorkbookTile_ObjectNotFound",o=this.contract.$config.workbookTile?[this.contract.$config.workbookTile.item]:["pinned object"];break;case 13:i="WorkbookTile_Unauthorized";break;default:return""}return t.format(i,o)},i.prototype.hasImages=function(){return this.hasWorkbookTileConfig&&this.tileModel.config.workbookTile.images&&0<this.tileModel.config.workbookTile.images.length},Object.defineProperty(i.prototype,"images",{get:function(){return this.hasWorkbookTileConfig?this.tileModel.config.workbookTile.images:null},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"hasWorkbookTileConfig",{get:function(){return!!this.tileModel&&!!this.tileModel.config&&!!this.tileModel.config.workbookTile},enumerable:!1,configurable:!0}),e.WorkbookTileModel=i})(powerbi=powerbi||{}),(function(e){var i;function t(e){if(e&&e.modelQuery&&e.modelQuery.sq){var t,i;try{t=JSON.parse(e.modelQuery.sq)}catch(e){}if(t)return e=null,(i=t).dataQuery&&i.dataQuery.Commands&&0<i.dataQuery.Commands.length?e=t.dataQuery:(i=t).Commands&&0<i.Commands.length?e=t:t.defn&&(e={Commands:[{SemanticQueryDataShapeCommand:{Query:t.defn,Binding:t.shape}}]}),e}}function o(e,t){e.$layoutConfig,e.$layoutConfig.layouts;e=i.extendWithId(e.$layoutConfig.layouts).withId(t);return e?e.position:null}e=e.dataServices||(e.dataServices={}),i=jsCommon.ArrayExtensions,(e=e.ContractUtils||(e.ContractUtils={})).findContentProviderId=function(e,t){if(e)for(var i=e.length,o=0;o<i;o++)if(e[o].id===t)return e[o].contentProviderId;return null},e.convertToSemanticQueryWithDataShapeBinding=function(e){return(e=t(e))&&e.Commands&&0<e.Commands.length?{defn:(e=e.Commands[0].SemanticQueryDataShapeCommand).Query,shape:e.Binding}:null},e.convertToTileDataQuery=t,e.createMasterLayoutConfig=function(e){return{layouts:[{id:0,position:e=void 0===e?{}:e}]}},e.getMasterLayoutPosition=function(e){return e=o(e,0)},e.getLayoutPosition=o,e.reportTypeToString=function(e){switch(e){case 0:return"pbix";case 1:return"rdl";default:return"unknown"}}})(powerbi=powerbi||{}),(function(e){var i,o;e=e.dataServices||(e.dataServices={}),i=jsCommon.DateExtensions,o=jsCommon.Utility,(e.DateUtils||(e.DateUtils={})).convertDate=function(e){var t=o.getDateFromWcfJsonString(e,!0);return t=t||i.parseIsoDate(e)}})(powerbi=powerbi||{}),(function(o){var i,e,t,r,a,n;function s(e){return e&&5===e.category}function l(e){return 7===e.category||6===e.category||3===e.category}function c(e){return e.originalPackageId||(e.packageIds&&1===e.packageIds.length?e.packageIds[0]:void 0)}function u(e,t){if(e)return(t=t.getAppInstance(e))&&t.providerContract.providerKey}function d(e){return!(e.icon||_.isEmpty(e.iconUrl)&&_.isEmpty(e.localAppLogoImageData))}function p(e,t){if(d(e))return e.localAppLogoImageData||(e.iconUrl?a.urlCombine(t,e.iconUrl):void 0)}function h(t,e){e=_.find(e.packages,(function(e){return e.contract.folderId===t&&e.contract.serviceAppObjectId}));if(e)return e.id}function m(e,t){e=t.findPackage(e);if(e&&e.contract&&e.contract.folderId)return h(e.contract.folderId,t)}i=o.dataServices||(o.dataServices={}),t=jsCommon.Color,r=o.common.models.Model,a=jsCommon.Utility,n=i.models.Workbook,(e=i.AppUtils||(i.AppUtils={})).isOrgApp=s,e.isOrgAppInstance=function(e,t){return(t=t.getAppInstance(e))&&s(t.providerContract)},e.isParameterizedApp=l,e.isParameterizedAppInstance=function(e,t){return(t=t.getAppInstance(e))&&l(t.providerContract)},e.getDashboardAppGUID=function(e,t){if(e&&e.contract)return u(e.getUniquePackageId&&e.getUniquePackageId(),t)},e.getDashboardAppGUIDByContract=function(e,t){if(e)return u(c(e),t)},e.getUniquePackageId=c,e.getResourceAppGUID=function(e,t){if(e)return u(e.packageId,t)},e.getAppGUIDByPackageId=u,e.convertDisplayDate=function(e,t){return(e=i.DateUtils.convertDate(e))&&e.toLocaleDateString(t.currentLanguageLocale,{month:"short",day:"numeric",year:"numeric"})},e.hasAppLogoImage=d,e.getAppLogoImageUrl=p,e.getAppLogoImageUrlStyle=function(e,t){if(d(e))return"url(".concat(p(e,t),")")},e.getAppHeaderFontColor=function(e){return e?125<.299*(e=t.parseColorString(e)).R+.587*e.G+.144*e.B?"#000":"#FFF":"inherit"},e.getAppHeaderBackgroundColor=function(e){if(e)return t.calculateHighlightColor(t.parseColorString(e),.8,.2)},e.getAppContentModelObjectId=function(e){return e instanceof r?e.dbName:e instanceof n?e.uniqueId:e.objectId},e.getAppAuthor=function(e){if(e=jsCommon.JsonExtensions.tryParseJSON(e.providerConfig))return e.author},e.getServiceAppWorkspacePackageIdByFolderId=h,e.getServiceAppWorkspacePackageId=m,e.isServiceApp=function(e,t){return null!=m(e,t)},e.findContentProviderName=function(e,t){var i="Unknown";return e&&t&&(6===t?i="Excel Workbook":7===t?i="Power BI Designer File":17===t?i="OrgContent":60===t?i="CSV File":(e=_.find(e,{id:t}))&&(i=e.clientCategory===o.common.contracts.ContentProviderClientCategory.Organizational?"OrgContent":e.displayText)),i}})(powerbi=powerbi||{}),(function(r){var e,t,o;function D(e,t,i){var o=e[e.length-1];!_.isEmpty(e)&&t>=o.startPosition&&t<o.startPosition+o.size?t+i>o.startPosition+o.size&&(o.size=t+i-o.startPosition):e.push({startPosition:t,size:i})}function I(e,t,i){return 1<e.length&&i&&t<=o}e=r.dataServices||(r.dataServices={}),t=r.common.helpers.ModelConverterHelper,o=3,(e=e.DashboardUtils||(e.DashboardUtils={})).isWriteable=function(e){return 2==(2&e.permissions)},e.notifyReadOnly=function(e,t,i,o){return e="NotifiedReadOnlyDashboard"+e.id,(o=o||!r.common.sessionStorageService.getData(e))&&(t.notify({title:i.get("Warning_Title"),message:i.get("DashboardReadOnlyWarning_Message"),notificationType:1}),r.common.sessionStorageService.setData(e,!0)),o},e.isQnaSupportedModel=function(e){return!!e&&t.getIsQnaSupported(e)},e.getDashboardModels=function(e,t){var i=[];if(e){var o=[],r=e.modelIds,r=(_.isEmpty(r)||(o=r.slice(0)),e.tiles);if(_.map(r,(function(e){null!=e.modelId&&o.push(e.modelId)})),!_.isEmpty(o))for(var o=_.uniq(o),a=0,n=o.length;a<n;a++){var s=_.filter(t,(function(e){return e.id===o[a]}));_.isEmpty(s)||i.push(s[0])}}return i},e.orderItems=function(e,t){for(var i=_.filter(e,(function(e){var t;return 0<(null==(t=e.pos)?void 0:t.x)&&0<(null==(t=e.pos)?void 0:t.y)})),o=[],r=_.sortBy(i,(function(e){e=e.pos;return 1e3*e.y+e.x})),a=0,n=r;a<n.length;a++)D(o,(s=n[a].pos).y,s.height);for(var s,l=[],i=_.sortBy(i,(function(e){e=e.pos;return 1e3*e.x+e.y})),c=0,u=i;c<u.length;c++)D(l,(s=u[c].pos).x,s.width);for(var d=(function(t,i){var e=_.isEmpty(t)?-1/0:_.maxBy(t,(function(e){return e.size})).size,o=_.isEmpty(i)?-1/0:_.maxBy(i,(function(e){return e.size})).size,r=_.every(t,(function(e){return e.size===t[0].size})),a=_.every(i,(function(e){return e.size===i[0].size}));r=I(t,e,r)||!I(i,o,a)&&e<=o?0:1;return r})(o,l),p=0===d?o:l,i=0===d?i:r,h=[],m=0,g=0,y=p;g<y.length;g++){for(var f=y[g],v=m+1;v<f.startPosition;v++)h.push(void 0);for(var T=f.startPosition;T<f.startPosition+f.size;T++)h.push(f.startPosition),m=T}for(var b=_.groupBy(i,(function(e){e=0===d?e.pos.y:e.pos.x;return h[e-1]})),S=[],C=0,w=p;C<w.length;C++)f=w[C],S=S.concat(b[f.startPosition]);return r=_.map(S,(function(e){return e.item})),t&&(i=_.filter(e,(function(e){var t;return!(0<(null==(t=e.pos)?void 0:t.x)&&0<(null==(t=e.pos)?void 0:t.y))})),p=_.map(i,(function(e){return e.item})),r.push.apply(r,p)),r},e.containsLayout=function(e,t,i){if(!i||!i.tiles)return!1;switch(e){case 0:return _.some(i.tiles,(function(e){return e.hasLayoutDefinition(t)}));case 1:return _.some(i.tiles,(function(e){return e.hasLayoutPosition(t)}))}},e.markTilesAsNewIfNeeded=function(e){for(var t=[],i=0,o=e.tiles;i<o.length;i++){var r=o[i];r.hasLayoutDefinition(1)?r.shouldNewBadgeAppear=!1:t.push(r.addLayout({id:1,position:null},1))}return t},e.calcDashboardScrollbarWidth=function(){var e=document.createElement("div"),t=(e.style.visibility="hidden",e.style.overflow="scroll",document.body.appendChild(e),document.createElement("div")),t=(e.appendChild(t),e.offsetWidth-t.offsetWidth);return e.parentNode.removeChild(e),0<t?t:8}})(powerbi=powerbi||{}),(function(e){var t,o,i,r,a;t=e.dataServices||(e.dataServices={}),r=t.contracts,e=e.visuals.plugins,a="__default__",t=t.TileDefaultSizesUtils||(t.TileDefaultSizesUtils={}),o={},(i={})[r.TileType[r.TileType.report]]=6,i[e.card.name]=2,i[e.animatedNumber.name]=2,i[e.textbox.name]=2,i[a]=3,o[1]=i,t.getRowSpan=function(e,t){var i;return(t=o[t=void 0===t?1:t])?t[i=!t[i=r.TileType[e.type]]&&e.composite&&(e=e.composite)?e.visual.type:i]||t[a]:1}})(powerbi=powerbi||{}),(function(h){var m,i,c,r,o,l,g,t;function e(){this.rScriptCount=0,this.pythonScriptCount=0}function y(e,t,i,o,r,a,n,s){s=s.execute({dataSources:e,schema:r,config:t,additionalFilters:null,dataWindow:i}),a=a.getPinData({name:"tile",config:{singleVisual:t},layouts:void 0},0,e,{},null,null,s,r),a.realTimeDataWindow=i,t=n.capabilities(l.getVisualType(a));return m.models.TileFactory.createTileForPinData(a,t,o)}m=h.dataServices||(h.dataServices={}),r=jsCommon.ArrayExtensions,o=jsCommon.JsonExtensions,l=h.explore.contracts.PinData,g=m.contracts.TileType,t=jsCommon.Version,i=m.TileUtils||(m.TileUtils={}),Object.defineProperty(e.prototype,"hasScriptVisuals",{get:function(){return 0<this.rScriptCount||0<this.pythonScriptCount},enumerable:!1,configurable:!0}),c=e,i.ScriptVisualCounts=c,i.getUpdatedContract=y,i.UpdateRealTimeTile=function(r,a,n,s,l,c,u,d,p){return __awaiter(this,void 0,h.Promise,(function(){var t,i,o;return __generator(this,(function(e){switch(e.label){case 0:return[4,(t=r.realTime).getDatasources()];case 1:return o=e.sent(),o=y(o,a,n,s,l,c,u,d),(i=o.$config)?(i.hideTitle=r.config.hideTitle,r.config=i,r.realTime.config=i.realTimeVisual,(i=r.contract).query=o.query,i.modelId=o.modelId,r.isTemporary&&(i=m.ContractUtils.getMasterLayoutPosition(i),o=m.ContractUtils.getMasterLayoutPosition(o),i.width=o.width,i.height=o.height,o={colSpan:i.width,rowSpan:i.height},r.calculateLayout(h.common.GridLayoutConstants.getDefaultGridItemViewport(o)),r.invalidateLayout()),t.singleVisualConfig=a):p.logEvent(h.telemetry.DashboardTileError,{tileType:g[g.realTime],message:"Invalid tile config object"}),[2]}}))}))},i.getVisualType=function(e){return(e=e&&(e.visualContainer||e.realTimeVisual))&&e.$visualContainer?e.$visualContainer.config.singleVisual.visualType:void 0},i.tileContainsScriptVisuals=function(e,t){return i.isScriptVisualTile(e,t)||i.countTileScriptVisuals(e,t).hasScriptVisuals},i.isScriptVisualTile=function(e,t){return e&&e.type===g.composite&&t.isScriptVisual(i.getVisualType(e.config))},i.countTileScriptVisuals=function(e,t){var i=new c,o=e&&e.reportTile&&e.reportTile.exploration&&e.reportTile.exploration.sections;if(o&&e.type===g.report)for(var r=0,a=o;r<a.length;r++)for(var n=0,s=a[r].contract.visualContainers;n<s.length;n++){var l=s[n],l=h.explore.util.VisualContainerUtils.getVisualType(l);if(l&&t&&t.isScriptVisual(l))switch(h.explore.util.ScriptVisualsUtil.getScriptVisualType(l)){case 0:i.rScriptCount++;break;case 1:i.pythonScriptCount++}}return i},i.tileTrackerFn=function(e,t){return"tile_"+e.id+"_dash_"+t},i.createDefaultPhoneByTile=function(e,t,i){var o=m.TileDefaultSizesUtils.getRowSpan(i,1),r=i.addLayout({id:1,position:{y:e,x:t,width:6,height:o}},1);return i.layoutPosition.y=e,i.layoutPosition.x=t,i.layoutPosition.height=o,i.layoutPosition.width=6,r},i.getTileErrorDetailsFromQueryResultError=function(e,t){if((e=o.tryParseJSON(e.errorDetail))&&!_.isEmpty(e.DataShapes)){e=e.DataShapes[0]["odata.error"];if(e)return new h.DsrClientError(e).getDetails(t)}},i.convertTileLayoutConfig=function(e){if(e.$layoutConfig)return e.$layoutConfig;var t={x:e.col,y:e.row,width:e.colSpan,height:e.rowSpan},i=void 0;if(e.layoutConfig)try{i=JSON.parse(e.layoutConfig);r.extendWithId(i.layouts).withId(0).position=t}catch(e){}else i={layouts:[{id:0,position:t}]};return i},i.addOrUpdateLayoutPosition=function(e,t,i){var o=(e=r.extendWithId(e.layouts)).withId(i);o||e.push(o={id:i,position:{}}),o.position=t},i.getCurrentTileLayoutDescriptor=function(e,t,i,o){return{id:e.id,row:null,col:null,rowSpan:null,colSpan:null,layoutConfig:JSON.stringify(t),query:o?i:null,updatedQuery:o,modelId:e.modelId,objectId:e.objectId}},i.getTileQueryAfterResize=function(e,t){if(e=m.ContractUtils.convertToTileDataQuery(e)){for(var i=t.width*h.common.GridLayoutConstants.defaultGridWidth,o=t.height*h.common.GridLayoutConstants.defaultGridHeight,r=!1,a=0,n=e.Commands;a<n.length;a++){var s,l,c=n[a],u=c.ScriptVisualCommand;u&&(s=u.ViewportWidthPx,l=u.ViewportHeightPx,s===i&&l===o||(u.ViewportWidthPx=i,u.ViewportHeightPx=o,c.ScriptVisualCommand=u,r=!0))}return r?e:void 0}},i.deserializeTileConfig=function(e){return e=null==(e=o.tryParseJSON(e))?{version:t.ZeroStr}:e}})(powerbi=powerbi||{}),(function(e){var t,i,o;t=e.dataServices||(e.dataServices={}),i=jsCommon.EnumExtensions,o=e.common.contracts.PackageType,(t=t.PermissionsUtils||(t.PermissionsUtils={})).isPackageTemplateInstance=function(e){return!(!e||e.packageType!==o.AppInstance||!e.contentProviderId&&!e.serviceContentProviderId)},t.canReshare=function(e){return i.hasFlag(e,6)},t.hasWriteFlag=function(e){return jsCommon.EnumExtensions.hasFlag(e,2)}})(powerbi=powerbi||{}),(function(e){(e=(e=e.dataServices||(e.dataServices={})).events||(e.events={})).syncServiceDashboardEditedEvent={name:"syncServiceDashboardEdited",type:4},e.syncServiceDashboardDeepEditedEvent={name:"syncServiceDashboardDeepEdited",type:4},e.syncServiceTilesAddedOrUpdated={name:"syncServiceTilesAddedOrUpdated",type:4},e.syncServiceCustomTilesUpdate={name:"syncServiceCustomTilesUpdate",type:4},e.syncServiceTileDeleted={name:"syncServiceTileDeleted",type:4}})(powerbi=powerbi||{}),(function(e){var t,o,r,a;t=(t=e.dataServices||(e.dataServices={})).models||(t.models={}),o=e.dataServices.ContractUtils,r=e.dataServices.models.RealTimeTileModel,a=e.dataServices.contracts.TileType,t.convertRealTimeTile=function(e,t){var i;if(e&&e.type===a.realTime)return i=t.tileModelConverter.convertTileConfig(e),t.tileModelConverter.convertTileLayoutConfig(e),t=new r(e,t.visualPlugin,t.visualPluginOps,t.featureSwitchService,t.geolocationService,t.geocoder,t.promiseFactory,t.moduleLoader,t.telemetryService,t.themeService,t.authenticationService,t.localizationService,t.visualHostTooltipService),i&&i.realTimeVisual&&(t.config=i.realTimeVisual),t.displayText=e.displayText,t.subDisplayText=e.subDisplayText,i=o.getMasterLayoutPosition(e),t.size={rowSpan:i.height,colSpan:i.width},t}})(powerbi=powerbi||{}),(function(o){var r,a,n,s,l,i,c,g;function e(e,t,i,o,r,a,n,s,l,c,u,d,p,h,m){this.geolocationService=e,this.telemetryService=t,this.visualPlugins=i,this.visualPluginOps=o,this.featureSwitchService=r,this.geocoder=a,this.promiseFactory=n,this.moduleLoader=s,this.tileConfigUpgraderService=l,this.explorationSerializer=c,this.themeService=u,this.authenticationService=d,this.localizationService=p,this.visualHostTooltipService=h,this.licenseUIManagerFactory=m}r=o.dataServices||(o.dataServices={}),a=r.models||(r.models={}),n=jsCommon.GzipUtility,s=jsCommon.PerfTimer,l=r.contracts.TileType,i=jsCommon.Utility,c=o.dataServices.TileUtils,a.createTileModelConverter=function(e,t,i,o,r,a,n,s,l,c,u,d,p,h,m){return new g(e,t,i,o,r,a,n,s,l,c,u,d,p,h,m)},e.prototype.convertCompositeTile=function(e){if(!e||e.type!==l.composite)return null;var t,i=this.convertTileConfig(e);if(this.convertTileLayoutConfig(e),!i||!i.visualContainer)return null;(t=new a.SingleVisualCompositeTileModel(e,this.visualPlugins,this.visualPluginOps,this.featureSwitchService,this.geolocationService,this.geocoder,this.promiseFactory,this.moduleLoader,this.telemetryService,this.themeService,this.authenticationService,this.localizationService,this.visualHostTooltipService,this.licenseUIManagerFactory)).config=i.visualContainer,t.displayText=e.displayText,t.subDisplayText=e.subDisplayText;var i=r.ContractUtils.getMasterLayoutPosition(e);return t.size={rowSpan:i.height,colSpan:i.width},t.isLoading=a.TileFactory.isTileLoading(e),e.queryResultError&&(t.isError=!0,i=e.queryResultError,this.telemetryService.logEvent(o.telemetry.DashboardTileError,{tileType:l[l.composite],message:jsCommon.StringExtensions.format("{0}:{1} with rootActivityId:{2}, modelId:{3} and tileId:{4}",jsCommon.EnumExtensions.toString(r.contracts.QueryResultErrorType,i.type),i.errorDetail,i.rootActivityId,e.modelId.toString(),e.id.toString())}),(e=c.getTileErrorDetailsFromQueryResultError(i,this.localizationService))?(t.errorDetails=e,t.errorText=e.message):t.errorText=this.localizationService.get("Tile_ErrorText")),t},e.prototype.convertTileData=function(t){if(!t.tileDataSet){var e=this.convertTileConfig(t);try{t.tileDataSet=this.parseTileData(t,e.tileDataType)}catch(e){throw this.telemetryService.logEvent(o.telemetry.DashboardTileError,{tileType:l[l.composite],message:jsCommon.StringExtensions.format("DsrParseError:{0} with modelId:{1} and tileId:{2}",e.message,t.modelId.toString(),t.id.toString())}),i.ensureError(e)}}return t.tileDataSet},e.prototype.convertTileConfig=function(e){if(!(i=e.$config)){var t=s.start("Parse tile config");try{var i,o=(i=e.$config=c.deserializeTileConfig(e.config)).visualContainer||i.realTimeVisual,r=(this.deserializeVisualContainer(o),o||i.visual);this.deserializeModelExtensions(r),this.tileConfigUpgraderService.upgrade(e.id,i,e.query)}catch(e){}finally{t()}}return i},e.prototype.convertTileLayoutConfig=function(e){var t;return e.$layoutConfig||(t=c.convertTileLayoutConfig(e),e.$layoutConfig=t,e.layoutConfig=JSON.stringify(t)),e.$layoutConfig},e.prototype.deserializeVisualContainer=function(e){e&&e.visualContainer&&!e.$visualContainer&&(e.$visualContainer=this.explorationSerializer.deserializeCanvasItem(e.visualContainer))},e.prototype.deserializeModelExtensions=function(e){e&&e.modelExtensions&&!e.$modelExtensions&&(e.$modelExtensions=this.explorationSerializer.deserializeModelExtensions(e.modelExtensions))},e.prototype.parseTileData=function(e,t){var i,o,r=s.start("Parse tile data");try{return e.tileDataBinaryBase64Encoded?(i=n.uncompress(e.tileDataBinaryBase64Encoded),o=JSON.parse(i)):e.tileData&&(o=JSON.parse(e.tileData)),{type:t,data:o}}finally{r()}},g=e})(powerbi=powerbi||{});;
"use strict";var powerbi,__awaiter=this&&this.__awaiter||function(e,n,s,c){return new(s=s||Promise)(function(o,t){function r(e){try{i(c.next(e))}catch(e){t(e)}}function a(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?o(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,a)}i((c=c.apply(e,n||[])).next())})},__generator=this&&this.__generator||function(r,a){var i,n,s,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(o){return function(e){var t=[o,e];if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,n&&(s=2&t[0]?n.return:t[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,t[1])).done)return s;switch(n=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,n=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(s=0<(s=c.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))c.label=t[1];else if(6===t[0]&&c.label<s[1])c.label=s[1],s=t;else{if(!(s&&c.label<s[2])){s[2]&&c.ops.pop(),c.trys.pop();continue}c.label=s[2],c.ops.push(t)}}t=a.call(r,c)}catch(e){t=[6,e],n=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}};!(function(t){var o=t.telemetry||(t.telemetry={}),e=jsCommon.Utility,r=t.telemetryEventFactory,a=t.telemetryBaseEventFactory,i=t.telemetry.EventFactories;e?e.generateGuid:Function.prototype,o.DashboardRenameReportEventName="PBI.Dashboard.RenameReport",o.DashboardRenameReport=i[o.DashboardRenameReportEventName]=function(e){return r({name:o.DashboardRenameReportEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DashboardRenameReportLoggers})},o.DashboardDeleteReportEventName="PBI.Dashboard.DeleteReport",o.DashboardDeleteReport=i[o.DashboardDeleteReportEventName]=function(e){return r({name:o.DashboardDeleteReportEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DashboardDeleteReportLoggers})},o.DashboardInitializeNavigationPaneReportsEventName="PBI.Dashboard.InitializeNavigationPaneReports",o.DashboardInitializeNavigationPaneReports=i[o.DashboardInitializeNavigationPaneReportsEventName]=function(e){return r({name:o.DashboardInitializeNavigationPaneReportsEventName,info:e,category:t.TelemetryCategory.Verbose,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DashboardInitializeNavigationPaneReportsLoggers})},o.DashboardInitializeNavigationPaneModelsEventName="PBI.Dashboard.InitializeNavigationPaneModels",o.DashboardInitializeNavigationPaneModels=i[o.DashboardInitializeNavigationPaneModelsEventName]=function(e){return r({name:o.DashboardInitializeNavigationPaneModelsEventName,info:e,category:t.TelemetryCategory.Verbose,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DashboardInitializeNavigationPaneModelsLoggers})},o.DashboardRenameDatasetEventName="PBI.Dashboard.RenameDataset",o.DashboardRenameDataset=i[o.DashboardRenameDatasetEventName]=function(e){return r({name:o.DashboardRenameDatasetEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DashboardRenameDatasetLoggers})},o.DashboardUpdateModelQnaFeaturesEventName="PBI.Dashboard.UpdateModelQnaFeatures",o.DashboardUpdateModelQnaFeatures=i[o.DashboardUpdateModelQnaFeaturesEventName]=function(e){return r({name:o.DashboardUpdateModelQnaFeaturesEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DashboardUpdateModelQnaFeaturesLoggers})},o.DashboardUpdateFeaturedQuestionsEventName="PBI.Dashboard.UpdateFeaturedQuestions",o.DashboardUpdateFeaturedQuestions=i[o.DashboardUpdateFeaturedQuestionsEventName]=function(e){return r({name:o.DashboardUpdateFeaturedQuestionsEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DashboardUpdateFeaturedQuestionsLoggers})},o.DashboardDeleteDatasetEventName="PBI.Dashboard.DeleteDataset",o.DashboardDeleteDataset=i[o.DashboardDeleteDatasetEventName]=function(e){return r({name:o.DashboardDeleteDatasetEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DashboardDeleteDatasetLoggers})},o.DashboardAddUpdateDashboardEventName="PBI.Dashboard.AddUpdateDashboard",o.DashboardAddUpdateDashboard=i[o.DashboardAddUpdateDashboardEventName]=function(e){return r({name:o.DashboardAddUpdateDashboardEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DashboardAddUpdateDashboardLoggers})},o.DashboardInitializeNavigationPaneWorkbooksEventName="PBI.Dashboard.InitializeNavigationPaneWorkbooks",o.DashboardInitializeNavigationPaneWorkbooks=i[o.DashboardInitializeNavigationPaneWorkbooksEventName]=function(e){return r({name:o.DashboardInitializeNavigationPaneWorkbooksEventName,info:e,category:t.TelemetryCategory.Verbose,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DashboardInitializeNavigationPaneWorkbooksLoggers})},o.DashboardUpdateLocalWorkbookNeverShowExplanationEventName="PBI.Dashboard.UpdateLocalWorkbookNeverShowExplanation",o.DashboardUpdateLocalWorkbookNeverShowExplanation=i[o.DashboardUpdateLocalWorkbookNeverShowExplanationEventName]=function(e){return r({name:o.DashboardUpdateLocalWorkbookNeverShowExplanationEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DashboardUpdateLocalWorkbookNeverShowExplanationLoggers})},o.DashboardRenameWorkbookEventName="PBI.Dashboard.RenameWorkbook",o.DashboardRenameWorkbook=i[o.DashboardRenameWorkbookEventName]=function(e){return r({name:o.DashboardRenameWorkbookEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DashboardRenameWorkbookLoggers})},o.DashboardRemoveWorkbookEventName="PBI.Dashboard.RemoveWorkbook",o.DashboardRemoveWorkbook=i[o.DashboardRemoveWorkbookEventName]=function(e){return r({name:o.DashboardRemoveWorkbookEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DashboardRemoveWorkbookLoggers})},o.DashboardGetWorkbookWopiAccessInformationEventName="PBI.Dashboard.GetWorkbookWopiAccessInformation",o.DashboardGetWorkbookWopiAccessInformation=i[o.DashboardGetWorkbookWopiAccessInformationEventName]=function(e){return r({name:o.DashboardGetWorkbookWopiAccessInformationEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DashboardGetWorkbookWopiAccessInformationLoggers})},o.DashboardWorkbookEmbeddingExternalSuccessEventName="PBI.Dashboard.WorkbookEmbeddingExternalSuccess",o.DashboardWorkbookEmbeddingExternalSuccess=i[o.DashboardWorkbookEmbeddingExternalSuccessEventName]=function(e){return r({name:o.DashboardWorkbookEmbeddingExternalSuccessEventName,info:e,category:t.TelemetryCategory.Verbose,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DashboardWorkbookEmbeddingExternalSuccessLoggers})},o.DashboardWorkbookEmbeddingExternalFailureEventName="PBI.Dashboard.WorkbookEmbeddingExternalFailure",o.DashboardWorkbookEmbeddingExternalFailure=i[o.DashboardWorkbookEmbeddingExternalFailureEventName]=function(e){return r({name:o.DashboardWorkbookEmbeddingExternalFailureEventName,info:e,category:t.TelemetryCategory.CriticalError,loggers:o.DashboardWorkbookEmbeddingExternalFailureLoggers})},o.DashboardImportResourcePackagesOnLoadEventName="PBI.Dashboard.ImportResourcePackagesOnLoad",o.DashboardImportResourcePackagesOnLoad=i[o.DashboardImportResourcePackagesOnLoadEventName]=function(e){return r({name:o.DashboardImportResourcePackagesOnLoadEventName,info:e,category:t.TelemetryCategory.Verbose,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DashboardImportResourcePackagesOnLoadLoggers})},o.DashboardGetNavigationPanePackageEventName="PBI.Dashboard.GetNavigationPanePackage",o.DashboardGetNavigationPanePackage=i[o.DashboardGetNavigationPanePackageEventName]=function(e){return r({name:o.DashboardGetNavigationPanePackageEventName,info:e,category:t.TelemetryCategory.Verbose,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DashboardGetNavigationPanePackageLoggers})},o.PermissionsObjectNotFoundEventName="PBI.Permissions.ObjectNotFound",o.PermissionsObjectNotFound=i[o.PermissionsObjectNotFoundEventName]=function(e){return r({name:o.PermissionsObjectNotFoundEventName,info:e,category:t.TelemetryCategory.CriticalError,loggers:o.PermissionsObjectNotFoundLoggers})},o.AppsGetAppEventName="PBI.Apps.GetApp",o.AppsGetApp=i[o.AppsGetAppEventName]=function(e){return r({name:o.AppsGetAppEventName,info:e,category:t.TelemetryCategory.Verbose,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.AppsGetAppLoggers})},o.AppsUninstallAppEventName="PBI.Apps.UninstallApp",o.AppsUninstallApp=i[o.AppsUninstallAppEventName]=function(e){return r({name:o.AppsUninstallAppEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.AppsUninstallAppLoggers})},o.TileConfigUpgradeTileConfigEventName="PBI.TileConfig.UpgradeTileConfig",o.TileConfigUpgradeTileConfig=i[o.TileConfigUpgradeTileConfigEventName]=function(e){return r({name:o.TileConfigUpgradeTileConfigEventName,info:e,category:t.TelemetryCategory.Verbose,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.TileConfigUpgradeTileConfigLoggers})},o.MobileAuthoringDashboardOpenedFromFlyoutEventName="PBI.MobileAuthoring.DashboardOpenedFromFlyout",o.MobileAuthoringDashboardOpenedFromFlyout=i[o.MobileAuthoringDashboardOpenedFromFlyoutEventName]=function(e){return r({name:o.MobileAuthoringDashboardOpenedFromFlyoutEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.MobileAuthoringDashboardOpenedFromFlyoutLoggers})},o.PermissionsUpdateArtifactVisibilityEventName="PBI.Permissions.UpdateArtifactVisibility",o.PermissionsUpdateArtifactVisibility=i[o.PermissionsUpdateArtifactVisibilityEventName]=function(e){return r({name:o.PermissionsUpdateArtifactVisibilityEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.PermissionsUpdateArtifactVisibilityLoggers})},o.BaseDatapoolEventEventName="BaseDatapoolEvent",o.BaseDatapoolEvent=i[o.BaseDatapoolEventEventName]=function(e){return a({info:e,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"]})},o.DatapoolDeleteDatapoolEventName="PBI.Datapool.DeleteDatapool",o.DatapoolDeleteDatapool=i[o.DatapoolDeleteDatapoolEventName]=function(e){return r({name:o.DatapoolDeleteDatapoolEventName,baseEvent:o.BaseDatapoolEvent(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:o.DatapoolDeleteDatapoolLoggers})},o.DatapoolUpdatePropertiesEventName="PBI.Datapool.UpdateProperties",o.DatapoolUpdateProperties=i[o.DatapoolUpdatePropertiesEventName]=function(e){return r({name:o.DatapoolUpdatePropertiesEventName,baseEvent:o.BaseDatapoolEvent(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:o.DatapoolUpdatePropertiesLoggers})},o.HttpRequestThrottledEventName="PBI.Http.RequestThrottled",o.HttpRequestThrottled=i[o.HttpRequestThrottledEventName]=function(e){return r({name:o.HttpRequestThrottledEventName,info:e,category:t.TelemetryCategory.Verbose,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.HttpRequestThrottledLoggers})},o.DatasetGetSharedDatasetsEventName="PBI.Dataset.GetSharedDatasets",o.DatasetGetSharedDatasets=i[o.DatasetGetSharedDatasetsEventName]=function(e){return r({name:o.DatasetGetSharedDatasetsEventName,info:e,category:t.TelemetryCategory.Verbose,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DatasetGetSharedDatasetsLoggers})},o.DatasetGetReadonlySharedDatasetsEventName="PBI.Dataset.GetReadonlySharedDatasets",o.DatasetGetReadonlySharedDatasets=i[o.DatasetGetReadonlySharedDatasetsEventName]=function(e){return r({name:o.DatasetGetReadonlySharedDatasetsEventName,info:e,category:t.TelemetryCategory.Verbose,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.DatasetGetReadonlySharedDatasetsLoggers})},o.UserInfoPreviousTenantIdEventName="PBI.UserInfo.PreviousTenantId",o.UserInfoPreviousTenantId=i[o.UserInfoPreviousTenantIdEventName]=function(e){return r({name:o.UserInfoPreviousTenantIdEventName,info:e,category:t.TelemetryCategory.Verbose,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.UserInfoPreviousTenantIdLoggers})}})(powerbi=powerbi||{}),(function(e){var t=e.dataServices||(e.dataServices={}),i=e.common.NotifyCollection,a=e.common.contracts.PackageType,n=(t.createAppService=function(e,t,o,r){return new n(e,t,o,r)},o.prototype.ensureAppsInitialization=function(){return this.appStore.ensureAppsInitialization()},o.prototype.getAppByGUID=function(t){var e=_.find(this.appInstances,(function(e){return e.objectId===t}));return e&&e.providerContract},Object.defineProperty(o.prototype,"appInstances",{get:function(){return this.instances.items},enumerable:!1,configurable:!0}),o.prototype.onInstanceAdded=function(e){var t,o=this,r=this.promiseFactory;return e.packageType!==a.AppInstance?r.reject():null!=(t=this.getAppInstance(e.id))?r.resolve(t):(e.contentProviderRefId,this.appStore.loadMetadata(e.contentProviderRefId,e.id).then((function(e){return r.resolve(o.onAppAdded(e.App,_.find(e.packages,(function(e){return e.packageType===a.AppInstance}))))})))},o.prototype.getAppInstance=function(e){return this.getAppInstanceInternal(e)},o.prototype.getAppInstanceInternal=function(t){return _.find(this.instances.items,(function(e){return e.packageId===t}))},o.prototype.onAppsUpdated=function(e,t){for(var o=[],r=this.packageIdToAppMap,a=this.dataServiceModelMerger,i=this.dataServiceModelConverter,n=0;n<e.length;n++){var s=e[n],c=t[n],d=r[c.id];d?d.providerContract!==s&&a.mergeInstalledAppModel(d,s,c):d=i.convertInstalledAppModel(s,c),o.push(d)}this.instances.setItems(o),this.packageIdToAppMap=_.keyBy(o,(function(e){return e.packageId}))},o.prototype.onAppAdded=function(e,t){var o=this.packageIdToAppMap[t.id];return o||(o=this.dataServiceModelConverter.convertInstalledAppModel(e,t),this.instances.addItem(o),this.packageIdToAppMap[t.id]=o)},o.prototype.isAppCategory=function(e){return this.appStore.isAppCategory(e)},o);function o(e,t,o,r){var a=this;this.promiseFactory=e,this.dataServiceModelConverter=t,this.appStore=o,this.dataServiceModelMerger=r,this.instances=new i,this.packageIdToAppMap={},this.appStore.installedApps.subscribe((function(e){a.onAppsUpdated(e.apps,e.packages)}))}t.createMockAppService=function(e){return new r(e)},s.prototype.ensureAppsInitialization=function(){return this.promiseFactory.reject()},s.prototype.appsAfterFolderSwitchPromise=function(){return this.promiseFactory.resolve()},s.prototype.getAppByGUID=function(e){return null},s.prototype.isAppCategory=function(e){return!1},s.prototype.onInstanceAdded=function(e){return this.promiseFactory.reject(null)},s.prototype.getAppInstance=function(e){return null};var r=s;function s(e){this.promiseFactory=e}})(powerbi=powerbi||{}),(function(e){var t=e.dataServices||(e.dataServices={}),o=e.common.NotifyCollection,r=(t.createDashboardCollectionService=function(){return new r},Object.defineProperty(a.prototype,"dashboards",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e),this.map=_.keyBy(e,(function(e){return e.objectId}))},enumerable:!1,configurable:!0}),a.prototype.findDashboardByObjectId=function(e){return this.map[e]},a.prototype.onAdded=function(e){for(var t=0,o=this.listeners;t<o.length;t++){var r=o[t];r.onDashboardAdded&&r.onDashboardAdded(e)}},a.prototype.onDeleted=function(e){for(var t=0,o=this.listeners;t<o.length;t++){var r=o[t];r.onDashboardDeleted&&r.onDashboardDeleted(e)}},a.prototype.onReset=function(){for(var e=0,t=this.listeners;e<t.length;e++){var o=t[e];o.onDashboardsReset&&o.onDashboardsReset()}},a.prototype.addDashboard=function(e){this.collection.addItem(e),this.map[e.objectId]=e},a.prototype.removeDashboard=function(t){var e=this.collection.deleteItems((function(e){return e.id===t}));0!==e.length&&delete this.map[_.first(e).objectId]},a.prototype.subscribe=function(e){this.listeners.length<1&&this.collection.subscribe(this),this.listeners.push(e)},a.prototype.unsubscribe=function(e){_.pull(this.listeners,e),this.listeners.length<1&&this.collection.unsubscribe(this)},a);function a(){this.listeners=[],this.collection=new o,this.map={}}})(powerbi=powerbi||{}),(function(e){var r=e.dataServices||(e.dataServices={}),f=(r.createDashboardDataService=function(e,t,o,r,a,i,n,s,c,d,l,p,u,h,m,b){return new f(e,t,o,r,a,i,n,s,c,d,l,p,u,m,b)},t.prototype.registerRefreshStateListener=function(e){_.includes(this.refreshStateListeners,e)||this.refreshStateListeners.push(e)},t.prototype.unregisterRefreshStateListener=function(e){_.remove(this.refreshStateListeners,e)},t.prototype.onDashboardTileRefreshStarted=function(e){this.activeDashboardId===e&&0===this.refreshState&&this.notify(1,e)},t.prototype.onDashboardTileRefreshFinished=function(e){var t=this;this.activeDashboardId===e&&1===this.refreshState&&(this.notify(2,e),this.$timeout((function(){return t.notify(0,e)}),3e3))},t.prototype.notify=function(e,t){this.refreshState=e;for(var o=0,r=this.refreshStateListeners;o<r.length;o++)r[o].onStateChange(this.refreshState,t)},Object.defineProperty(t.prototype,"dashboards",{get:function(){return this.dashboardCollectionService.dashboards},set:function(e){this.dashboardCollectionService.dashboards=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeDashboard",{get:function(){return this.activeDashboardObjectId?this.findDashboardByGUID(this.activeDashboardObjectId):null},set:function(e){e?(this.activeDashboardId=e.id,this.activeDashboardObjectId=e.objectId):(this.activeDashboardId=-1,this.activeDashboardObjectId=null),this.dashboardStore.select(e?e.contract:null),this.refreshState=0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeDashboardContainsQnaSupportedModel",{get:function(){return!_.isEmpty(this.activeDashboardQnaModels)},enumerable:!1,configurable:!0}),t.prototype.setActiveNoLoad=function(e){e?(this.activeDashboardId=e.id,this.activeDashboardObjectId=e.objectId):(this.activeDashboardId=-1,this.activeDashboardObjectId=null),this.dashboardStore.select(e?e.contract:null,!0),this.refreshState=0},Object.defineProperty(t.prototype,"displayName",{get:function(){return this.activeDashboard?this.activeDashboard.displayName:""},enumerable:!1,configurable:!0}),t.prototype.addDashboard=function(e){e&&!this.findDashboardByGUID(e.objectId)&&this.dashboardCollectionService.addDashboard(e)},t.prototype.deleteTile=function(e,t){var r=this,a=this.promiseFactory.defer(),i=this.findDashboard(e);return i?this.tryUpdateTile(i,t,(function(e,t){var o;0<=e&&0<=t?(o=i.contract.tiles[e],i.contract.tiles.splice(e,1),i.tiles.splice(t,1),r.updateQnAEnabledWhenNoTilesOnDashboard(i),i.hasModel(o.modelId)||r.dashboardHttpService.addDashboardRequestToBatch(r.promiseFactory,i.id,!1,0).done((function(e){r.modelMerger.mergeDashboardShallow(i,e.dashboards[0]),r.updateActiveDashboardModels(),a.resolve(null)})).fail((function(){a.reject()}))):a.resolve(null)})):a.resolve(null),a.promise},t.prototype.dropDashboardfromMemoryIfNotActive=function(e){var t=this.activeDashboard;return!(t&&t.id===e||(this.findDashboard(e)&&this.dashboardStore.unloadDashboardTiles(e),0))},t.prototype.findDashboard=function(t){return _.find(this.dashboards,(function(e){return e.id===t}))},t.prototype.findDashboardByGUID=function(e){return this.dashboardCollectionService.findDashboardByObjectId(e)},t.prototype.findDashboardsByPackageId=function(t){var e=this.dashboards;if(e)return _.filter(e,(function(e){return!(!e.contract||!e.contract.originalPackageId)&&e.contract.originalPackageId===t}))},t.prototype.retrieveDashboardForApp=function(t,o){return _.find(this.dashboards,(function(e){return e.getUniquePackageId()===t&&e.contract.originalDashboardObjectId===o}))},t.prototype.tryUpdateTile=function(e,t,o){var r;e&&(r=e.getTileContractIndex(t),t=e.getTileIndex(t),o(r,t),e.scheduleDelayedLayout(this.activeDashboard!==e))},t.prototype.updateActiveDashboardModels=function(){var e=this.activeDashboard&&this.activeDashboard.contract;this.updateActiveDashboardModelsInternal(e)},t.prototype.updateActiveDashboardModelsInternal=function(o){return __awaiter(this,void 0,e.Promise,(function(){var t=this;return __generator(this,(function(e){switch(e.label){case 0:return o=o||this.activeDashboard&&this.activeDashboard.contract,[4,this.modelService.modelsPromise];case 1:return e.sent(),this.activeDashboardModels=r.DashboardUtils.getDashboardModels(o,this.modelService.getModelContracts()),this.activeDashboardQnaModels=_.filter(this.activeDashboardModels,(function(e){return r.DashboardUtils.isQnaSupportedModel(e)&&t.permissionService.isExplorableModelContract(e)})),this.updateIsQnaEnabled(),[2]}}))}))},t.prototype.getActiveDashboardModelRefreshDisabledReason=function(){var e=this.activeDashboardModels;if(!_.isEmpty(e))for(var t=this.modelService,o=0,r=e;o<r.length;o++){var a=r[o],a=t.findModel(a.id,a.packageId);if(a){a=a.getRefreshDisabledReason();if(0!==a)return a}}return 0},t.prototype.updateIsQnaEnabled=function(){this.activeDashboard?void 0!==this.activeDashboard.qnaEnabled?this.isQnaEnabled=this.activeDashboard.qnaEnabled:this.isQnaEnabled=this.activeDashboardContainsQnaSupportedModel:this.isQnaEnabled=!1},t.prototype.onModelUpdated=function(e,t){this.modelService.findModel(e,t)&&this.updateActiveDashboardModels()},t.prototype.getDashboards=function(){var e=this;return this.dashboardsDeferred.promise.then((function(){return e.dashboards}))},t.prototype.setQnaEnabled=function(e,t){e=this.findDashboard(e);e&&(e.qnaEnabled=t,this.updateIsQnaEnabled())},t.prototype.subscribe=function(e){this.dashboardCollectionService.subscribe(e)},t.prototype.unsubscribe=function(e){this.dashboardCollectionService.unsubscribe(e)},t.prototype.onDeleted=function(e){this.dashboardCollectionService.onDeleted(e)},t.prototype.dashboardsAfterFolderSwitchPromise=function(){return this.dashboardsAfterFolderSwitchDeferred.promise},t.prototype.updateQnAEnabledWhenNoTilesOnDashboard=function(e){_.isEmpty(e.tiles)&&(e.qnaEnabled=!1)},t);function t(e,t,o,r,a,n,i,s,c,d,l,p,u,h,m){var b=this;this.dashboardHttpService=e,this.groupStore=t,this.promiseFactory=o,this.modelConverter=r,this.modelMerger=a,this.modelService=n,this.dashboardCollectionService=i,this.$timeout=s,this.dashboardStore=c,this.appMetadataService=d,this.permissionService=l,this.datasetRefreshListener=u,this.reportStore=m,this.refreshStateListeners=[],this.dashboardCollectionService=i,this.dashboardsDeferred=o.defer(),this.isQnaEnabled=!1,this.datasetRefreshListener.addModelUpdateListener(this),this.refreshState=0,this.appMetadataService.getAppMetadata().then((function(){b.dashboardStore.selectedDashboard.subscribe((function(e){b.activeDashboardId=e?e.id:b.activeDashboardId,b.activeDashboardObjectId=e?e.objectId:b.activeDashboardObjectId,b.updateActiveDashboardModelsInternal(e)}))})),this.dashboardsAfterFolderSwitchDeferred=this.promiseFactory.defer(),this.appMetadataService.getAppMetadata().then((function(){b.groupStore.selectedFolderId$.subscribe((function(){b.dashboardsAfterFolderSwitchDeferred.resolve(),b.dashboardsAfterFolderSwitchDeferred=b.promiseFactory.defer()})),p.ensureReportsInitialization().then((function(){b.dashboardStore.dashboards.subscribe((function(e){var o,r,a,i=_.keyBy(b.dashboards,(function(e){return e&&e.objectId}));b.dashboards=_.filter(e,(function(e){return!!e})).map((function(e){var t=i[e.objectId];return t?(b.modelMerger.mergeDashboardShallow(t,e),t):(_.isEmpty(o)&&(o=_.map(n.models,(function(e){return e.contract})),b.reportStore.reports.subscribe((function(e){r=e})),a=_.map(h.workbooks,(function(e){return e.contract}))),b.modelConverter.convertDashboard(e,o,r,a))})),b.dashboardsAfterFolderSwitchDeferred.resolve(),b.dashboardsDeferred.resolve(b)}))}))}),(function(){b.dashboardsDeferred.reject(),b.dashboardsAfterFolderSwitchDeferred.reject()}))}r.DashboardDataService=f})(powerbi=powerbi||{}),(function(v){var i=v.dataServices||(v.dataServices={}),n=v.dataServices.contracts.TileType,f=(i.createDashboarSyncService=function(e,t,o,r,a,i,n,s,c,d,l,p,u,h,m,b){return new f(e,t,o,r,a,i,n,s,c,d,l,p,u,h,m,b)},e.prototype.onTilesAddedOrUpdated=function(e,t){var o=this.promiseFactory;return this.customTilesUpdate?(this.customTilesUpdate(e,t),o.resolve(null)):this.dashboardDataService.dropDashboardfromMemoryIfNotActive(e)?o.resolve(null):void this.addOrUpdateActiveDashboardTiles(e,t)},e.prototype.addOrDeepEditDashboard=function(t){var o=this,r=this.telemetryService.startEvent(v.telemetry.DashboardAddUpdateDashboard),a=this.promiseFactory.defer();return this.dashboardHttpService.addDashboardRequestToBatch(this.promiseFactory,t,!1,0).done((function(e){o.addOrUpdateDashboard(e),o.rootScope.$emit(i.constants.updateDashboardContainerEventName,[e]),o.dashboardDataService.onDashboardTileRefreshFinished(t),r.resolve(),a.resolve(null)})).fail((function(){r.reject(),a.reject(null)})),a.promise},e.prototype.onDashboardShallowEdit=function(e){var e=e.dashboards[0],t=this.dashboardDataService.findDashboard(e.id);t&&(this.modelMerger.mergeDashboardShallow(t,e),this.rootScope.$emit(i.constants.onDashboardShallowEditEventName,t,e))},e.prototype.onDashboardDeepEdit=function(e){this.rootScope.$emit(i.constants.addOrUpdateDashboardEventName,e),this.rootScope.$emit(i.constants.updateDashboardContainerEventName,[e]),this.dashboardDataService.onDashboardTileRefreshFinished(e.dashboards[0].id)},e.prototype.addOrUpdateCustomVisualTile=function(e,t,o){var r=this;this.isResourcePackageInCache(e)?this.addOrUpdateTile(t,o,this.modelService.getModelContracts()):this.resourcePackageListenerService.getAndLoadVisualPlugin(e).then((function(){r.addOrUpdateTile(t,o,r.modelService.getModelContracts())}))},e.prototype.addOrUpdateDashboard=function(e){var t=e.dashboards[0],t=(this.dashboardStore.addOrUpdate(t),this.rootScope.$emit(i.constants.addOrUpdateDashboardEventName,e),this.modelConverter.convertDashboard(t,e.models,e.reports));this.dashboardDataService.onDashboardTileRefreshFinished(t.id)},e.prototype.addOrUpdateTile=function(a,i,n,s){var c=this;a&&(n=n||[],this.updateModelsIfRequired(a,i),this.dashboardDataService.tryUpdateTile(a,i.id,(function(e,t){var o=c.reportService.findReport(i.reportId),r=null;0<=e?(a.contract.tiles[e]=i,0<=t&&(r=a.tiles[t],c.modelMerger.mergeTile(r,i,n,null,c.workbookService.getWorkbookContracts(),c.reportService.reports))):(r=s||c.modelConverter.convertTile(i,n,null,c.workbookService.getWorkbookContracts()),a.contract.tiles.push(i),a.tiles.push(r)),r&&(r.invalidateLayout(),o)&&(r.report=o)})))},e.prototype.registerAndUpdateTile=function(e,t){var o=this.dashboardDataService.findDashboard(e);if(t.resourcePackageIds&&0<t.resourcePackageIds.length)for(var r=t.resourcePackageIds.length,a=0;a<r;++a)this.addOrUpdateCustomVisualTile(t.resourcePackageIds[a],o,t);else this.featureSwitchService.featureSwitches.consumePublicCvsWithoutRps?this.ensurePublicCVsAndAddOrUpdateTile(o,t):this.addOrUpdateTile(o,t,this.modelService.getModelContracts())},e.prototype.ensurePublicCVsAndAddOrUpdateTile=function(e,t){var o,r=this,a=this.modelConverter.convertTile(t,this.modelService.getModelContracts(),null,this.workbookService.getWorkbookContracts()),i=a.type===n.composite&&(null==(o=null==(o=null==(o=null==(o=null==(o=a.config)?void 0:o.visualContainer)?void 0:o.$visualContainer)?void 0:o.config)?void 0:o.singleVisual)?void 0:o.visualType);i?this.publicCustomVisualService.getPublicVisualTypes([i]).then((function(e){if(e[0])return e=r.publicCustomVisualService.createPublicResourcePackageByName(i),r.resourcePackageListenerService.loadVisualPlugin([e])})).finally((function(){r.addOrUpdateTile(e,t,r.modelService.getModelContracts(),a)})):this.addOrUpdateTile(e,t,this.modelService.getModelContracts(),a)},e.prototype.addOrUpdateActiveDashboardTiles=function(a,e,i){var n=this;if(this.dashboardDataService.selectedDashboardTile){var t=(e=0===e.length?this.dashboardDataService.activeDashboard.tiles.map((function(e){return e.id})):e).indexOf(this.dashboardDataService.selectedDashboardTile.id);if(0<=t&&(e.splice(t,1),0===e.length))return this.promiseFactory.resolve(null)}return this.dashboardHttpService.batchGetTiles(a,e,void 0,!0).then((function(e){var t=e.data;if(!_.isEmpty(t))for(var o=0,r=t.length;o<r;++o)n.registerAndUpdateTile(a,t[o]);i&&n.dashboardDataService.onDashboardTileRefreshFinished(a)}))},e.prototype.updateModelsIfRequired=function(t,e){var o=this,r=t.getTileContractIndex(e.id),a=-1!==r&&2===e.publishState&&1===t.contract.tiles[r].publishState;!a&&t.hasModel(e.modelId)||this.dashboardHttpService.addDashboardRequestToBatch(this.promiseFactory,t.id,!1,0).done((function(e){a&&(o.modelMerger.mergeDashboardTiles(t,e),o.rootScope.$emit(i.constants.mergeDashboardContainerModelsReportsAndPackagesEventName,e),o.modelMerger.mergeModelContentProviderId(e.models,e.packages)),o.modelMerger.mergeDashboardShallow(t,e.dashboards[0]),o.dashboardDataService.updateActiveDashboardModels()}))},e.prototype.isResourcePackageInCache=function(t){var e=this.resourcePackagesService.getAllPackages();return _.some(e,(function(e){return e.id===t}))},e);function e(e,t,o,r,a,i,n,s,c,d,l,p,u,h,m,b){var f=this;this.rootScope=e,this.dashboardDataService=t,this.dashboardHttpService=o,this.modelConverter=r,this.modelMerger=a,this.modelService=i,this.promiseFactory=n,this.reportService=s,this.resourcePackageListenerService=c,this.resourcePackagesService=d,this.telemetryService=l,this.workbookService=p,this.dashboardStore=u,this.globalEventBridge=h,this.featureSwitchService=m,this.publicCustomVisualService=b,this.globalEventBridge.createChannelSubscriptionManager().subscribe(v.dataServices.events.syncServiceDashboardEditedEvent,(function(e,t){return f.onDashboardShallowEdit(t)})).subscribe(v.dataServices.events.syncServiceDashboardDeepEditedEvent,(function(e,t){return f.onDashboardDeepEdit(t)})).subscribe(v.dataServices.events.syncServiceTilesAddedOrUpdated,(function(e,t){return f.addOrUpdateActiveDashboardTiles(t.dashboardId,t.tileIds,t.isDataChange)})).subscribe(v.dataServices.events.syncServiceTileDeleted,(function(e,t){return f.dashboardDataService.deleteTile(t.dashboardId,t.tileId)}))}i.DashboardSyncService=f})(powerbi=powerbi||{}),(function(a){var e=a.dataServices||(a.dataServices={}),i=window,s=(e.createHostAppMetadataService=function(e,t,o,r,a,i,n){return new s(e,t,o,r,a,i,n)},n.prototype.getAppMetadata=function(){return this.getAppMetadataDeferred.promise},n.prototype.requestAppMetadata=function(e,t){var o=this,r=this.telemetryService.startEvent(this.eventFactory),t=this.httpService.powerbiRequestOptions(r.event,"DashboardHostGetAppMetadata",{isAdminRequest:t});t.params={preferReadOnlySession:"true"},this.httpService.get("powerbi/metadata/app",t).then((function(e){e=e.data;i.initialDashboardContainer=e,o.editableFeatureSwitchService.registerFeatureSwitches(e.featureSwitches),o.getAppMetadataDeferred.resolve(e),r.resolve()}),(function(e){o.getAppMetadataDeferred.reject(null),r.reject(a.errorDetailsHelper.getTelemetryErrorDetails(e.error,e.status)),o.errorCallback&&o.errorCallback(n.pageRefreshErrorMessage)}))},n.pageRefreshErrorMessage="GetAppMetadataRequestFailed",n);function n(e,t,o,r,a,i,n){this.promiseFactory=e,this.telemetryService=t,this.eventFactory=o,this.editableFeatureSwitchService=r,this.httpService=a,this.errorCallback=i,this.getAppMetadataDeferred=this.promiseFactory.defer(),this.requestAppMetadata(r,n)}})(powerbi=powerbi||{}),(function(e){var t=e.dataServices||(e.dataServices={}),o=e.common.NotifyCollection,r=(t.createPackageCollectionService=function(){return new r},Object.defineProperty(a.prototype,"packages",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e),this.idToPackageMap=_.keyBy(e,(function(e){return e.id}))},enumerable:!1,configurable:!0}),a.prototype.findPackage=function(e){return this.idToPackageMap[e]},a.prototype.subscribe=function(e){_.isEmpty(this.listeners)&&this.subscribeToCollectionEvents(),this.listeners.push(e)},a.prototype.unsubscribe=function(e){_.remove(this.listeners,e),_.isEmpty(this.listeners)&&this.unsubscribeToCollectionEvents()},a.prototype.subscribeToCollectionEvents=function(){var e=this;this.collectionListener={onAdded:function(t){return e.notifyListeners((function(e){return e.onPackageAdded(t)}))},onDeleted:function(t){return e.notifyListeners((function(e){return e.onPackageDeleted(t)}))},onReset:function(){return e.notifyListeners((function(e){return e.onPackagesReset()}))}},this.collection.subscribe(this.collectionListener)},a.prototype.unsubscribeToCollectionEvents=function(){this.collection.unsubscribe(this.collectionListener),this.collectionListener=null},a.prototype.notifyListeners=function(e){var t=this.listeners;if(!_.isEmpty(t)&&e)for(var o=t.length-1;0<=o;o--)e(t[o])},a);function a(){this.collection=new o,this.listeners=[],this.packages=[]}})(powerbi=powerbi||{}),(function(e){var t=e.dataServices||(e.dataServices={}),o=e.common.contracts.PackageType,a=(t.createPackageService=function(e,t,o,r){return new a(e,t,o,r)},r.prototype.ensurePackagesInitialization=function(){return this.packagesInitializationDeferred.promise},Object.defineProperty(r.prototype,"packages",{get:function(){return this.packageCollectionService.packages},enumerable:!1,configurable:!0}),r.prototype.findPackage=function(e){return this.packageCollectionService.findPackage(e)},r.prototype.getInstalledOrgPackage=function(t){return _.find(this.packages,(function(e){return e.contract&&e.contract.contentProviderRefId&&e.contract.contentProviderRefId===t&&e.packageType===o.AppInstance}))},r.prototype.initPackages=function(){var o=this;this.packagesInitializationDeferred=this.promiseFactory.defer(),this.packageStore.packages.subscribe((function(e){e=e.map((function(t){var e=_.find(o.packages,(function(e){return e.id===t.id}));return e?(e.contract!==t&&o.mergePackage(e,t),e):o.packageModelConverter.convertPackage(t)}));o.packageCollectionService.packages=e})),this.packagesInitializationDeferred.resolve(this)},r.prototype.mergePackage=function(e,t){e&&t&&(e.contract=t,e.contentProviderId=t.contentProviderId,e.id=t.id,e.lastRefreshTime=t.lastRefreshTime,e.latestVersion=t.latestVersion,e.name=t.name,e.publishOrRefreshStatus=t.publishOrRefreshStatus,e.version=t.version,e.originalPackageId=t.originalPackageId||e.originalPackageId,e.packageType=t.packageType||e.packageType,e.getPermissionsCallback=function(){return t&&t.permissions})},r);function r(e,t,o,r){this.packageModelConverter=e,this.packageCollectionService=t,this.promiseFactory=o,this.packageStore=r,this.initPackages()}t.PackageService=a})(powerbi=powerbi||{}),(function(o){var r=o.dataServices||(o.dataServices={}),a=o.common.helpers.UserInfoHelper,s=(r.createReportService=function(e,t,o,r,a,i,n){return new s(e,t,o,r,a,i,n)},e.prototype.subscribeReports=function(){var o=this;this.appMetadataService.getAppMetadata().then((function(){o.groupStore.selectedFolderId$.subscribe((function(){o.reportsAfterFolderSwitchDeferred.resolve(),o.reportsAfterFolderSwitchDeferred=o.promiseFactory.defer()})),o.reportStore.reports.subscribe((function(e){o.reportCollectionService.reports=e.map((function(t){var e=_.find(o.reportCollectionService.reports,(function(e){return e.objectId===t.objectId}));return e?(o.mergeReport(e,t),e):o.modelConverter.convertReport(t)})),o.reportsDeferred.resolve(o),o.reportsAfterFolderSwitchDeferred.resolve()})),o.reportStore.selectedReport.subscribe((function(e){o.currentActiveReport=e?{id:e.id,displayName:e.displayName,guid:e.objectId,modelId:e.modelId}:null}))}))},e.prototype.ensureReportsInitialization=function(){return this.reportsDeferred.promise},Object.defineProperty(e.prototype,"reports",{get:function(){return this.reportCollectionService.reports},set:function(e){this.reportCollectionService.reports=e},enumerable:!1,configurable:!0}),e.prototype.getReports=function(){return this.reportsDeferred.promise.then((function(e){return e.reports}))},e.prototype.onReportDeleted=function(e){e=this.findReport(e);e&&(this.reportStore.delete(e.contract,!0),this.reportCollectionService.onDeleted(e))},e.prototype.getReportContracts=function(){return this.reports.map((function(e){return e.contract}))},e.prototype.addReport=function(e){this.reportCollectionService.addReport(e),this.reportStore.ensure(e.contract)},e.prototype.deleteReport=function(e){var e=this.findReportByGUID(e),t=this.telemetryService.startEvent(o.telemetry.DashboardDeleteReport,{reportType:e?r.ContractUtils.reportTypeToString(e.reportType):"",reportId:e?e.id:-1,reportObjectId:e?e.objectId:void 0});this.reportStore.delete(e,!1,t),this.reportCollectionService.onDeleted(e)},e.prototype.getReportModels=function(e){var t,o=this;return e?(this.reportStore.getReportsByGroupId(e).subscribe((function(e){t=e.map((function(e){return o.modelConverter.convertReport(e)}))})),t):this.reports},e.prototype.findReport=function(t,e){return null!=t?_.find(this.getReportModels(e),(function(e){return e.id===t})):null},e.prototype.findReportByGUID=function(t,e){return null!=t?_.find(this.getReportModels(e),(function(e){return e.objectId===t})):null},e.prototype.findReportsByPackageId=function(t){return _.filter(this.reports,(function(e){return e.packageId===t}))},e.prototype.subscribe=function(e){this.reportCollectionService.subscribe(e)},e.prototype.unsubscribe=function(e){this.reportCollectionService.unsubscribe(e)},e.prototype.mergeArtifactOwnerInfo=function(e,t){e.ownerFullname=a.getFullName(t.givenName,t.familyName),e.ownerMail=t.emailAddress,t.userObjectId&&(e.ownerUserObjectId=t.userObjectId),t.groupObjectId&&(e.ownerGroupObjectId=t.groupObjectId),e.contract.ownerInfo||(e.contract.ownerInfo=t)},e.prototype.mergeReport=function(e,t){e&&t&&(e.contract=t,e.id=t.id||e.id,e.objectId=t.objectId||e.objectId,e.modelId=t.modelId||e.modelId,e.reportUrl=t.reportUrl||e.reportUrl,e.getPermissionsCallback=function(){return t.permissions},e.packagePublishStatus=t.packagePublishStatus||e.packagePublishStatus,e.name=t.name||e.name,e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,e.fileName=t.fileName||e.fileName,e.packageId=t.packageId||e.packageId,e.packageVersion=t.packageVersion||e.packageVersion,e.contentProviderId=t.contentProviderId||e.contentProviderId,e.isHidden=t.isHidden,t.ownerInfo)&&this.mergeArtifactOwnerInfo(e,t.ownerInfo)},e);function e(e,t,o,r,a,i,n){this.telemetryService=e,this.modelConverter=t,this.appMetadataService=o,this.promiseFactory=r,this.reportCollectionService=a,this.reportStore=i,this.groupStore=n,this.reportsDeferred=this.promiseFactory.defer(),this.reportsAfterFolderSwitchDeferred=this.promiseFactory.defer(),this.subscribeReports()}r.ReportService=s})(powerbi=powerbi||{}),(function(e){var t=e.dataServices||(e.dataServices={}),o=e.common.NotifyCollection,r=(t.createReportCollectionService=function(){return new r},Object.defineProperty(a.prototype,"reports",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e)},enumerable:!1,configurable:!0}),a.prototype.findReportContract=function(t){return _.find(this.reports,(function(e){return e.id===t})).contract},a.prototype.onAdded=function(e){for(var t=0,o=this.listeners;t<o.length;t++){var r=o[t];r.onReportAdded&&r.onReportAdded(e)}},a.prototype.onDeleted=function(e){for(var t=0,o=this.listeners;t<o.length;t++){var r=o[t];r.onReportDeleted&&r.onReportDeleted(e)}},a.prototype.onReset=function(){for(var e=0,t=this.listeners;e<t.length;e++){var o=t[e];o.onReportsReset&&o.onReportsReset()}},a.prototype.addReport=function(e){this.collection.addItem(e)},a.prototype.removeReport=function(t){this.collection.deleteItems((function(e){return e.id===t}))},a.prototype.subscribe=function(e){this.listeners.length<1&&this.collection.subscribe(this),this.listeners.push(e)},a.prototype.unsubscribe=function(e){_.pull(this.listeners,e),this.listeners.length<1&&this.collection.unsubscribe(this)},a);function a(){this.listeners=[],this.collection=new o}})(powerbi=powerbi||{}),(function(e){var t=e.dataServices||(e.dataServices={}),o=e.common.models.Model,r=e.common.NotifyCollection,a=(t.createModelCollectionService=function(){return new a},Object.defineProperty(i.prototype,"models",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e),this.modelsMap={};for(var t=0,o=e;t<o.length;t++){var r=o[t];this.modelsMap[r.uniqueId]=r}},enumerable:!1,configurable:!0}),i.prototype.getModelContracts=function(){return _.map(this.models,(function(e){return e.contract}))},i.prototype.onAdded=function(e){for(var t=0,o=this.listeners;t<o.length;t++){var r=o[t];r.onModelAdded&&r.onModelAdded(e)}},i.prototype.onDeleted=function(e){for(var t=0,o=this.listeners;t<o.length;t++){var r=o[t];r.onModelDeleted&&r.onModelDeleted(e)}},i.prototype.onReset=function(){for(var e=0,t=this.listeners;e<t.length;e++){var o=t[e];o.onModelsReset&&o.onModelsReset()}},i.prototype.findModel=function(e,t){return this.modelsMap[o.getUniqueId(e,t)]},i.prototype.addModel=function(e){this.collection.addItem(e),this.modelsMap[e.uniqueId]=e},i.prototype.subscribe=function(e){this.listeners.length<1&&this.collection.subscribe(this),this.listeners.push(e)},i.prototype.unsubscribe=function(e){_.pull(this.listeners,e),this.listeners.length<1&&this.collection.unsubscribe(this)},i);function i(){this.listeners=[],this.collection=new r,this.modelsMap={}}})(powerbi=powerbi||{}),(function(n){var o=n.dataServices||(n.dataServices={}),r=jsCommon.EnumExtensions,a=n.common.helpers.ModelConverterHelper,l=(o.createModelService=function(e,t,o,r,a,i,n,s,c,d){return new l(e,t,o,r,a,i,n,s,c,d)},Object.defineProperty(e.prototype,"models",{get:function(){return this.modelCollectionService.models},set:function(e){this.modelCollectionService.models=e},enumerable:!1,configurable:!0}),e.prototype.pushModel=function(e){this.modelCollectionService.addModel(e)},Object.defineProperty(e.prototype,"modelsPromise",{get:function(){return this._modelsDeferred.promise},enumerable:!1,configurable:!0}),e.prototype.updateDatasetCollection=function(e){var t=[];if(!_.isEmpty(e))for(var o=0,r=e.length;o<r;++o)t.push(this.dataSetConverter.convertModel(e[o]));this.modelCollectionService.models=t},e.prototype.mergeDatasetCollection=function(e){if(!_.isEmpty(e))for(var t=_.keyBy(this.models,"id"),o=0,r=e;o<r.length;o++){var a=r[o];t[a.id]?this.updateContractModel(a):this.pushModel(this.dataSetConverter.convertModel(a))}},e.prototype.getModelContracts=function(){return this.modelCollectionService.getModelContracts()},e.prototype.updateContractModel=function(e){var t;e&&(e.permissions,t=this.findModel(e.id,e.packageId))&&(this.mergeModel(t,e),this.datasetRefreshListener.applyModelUpdated(t.id,t.packageId))},e.prototype.addContractModel=function(e){!e&&this.modelExists(e.id,e.packageId)||(e.isNew=!0,e=this.dataSetConverter.convertModel(e),this.addModel(e))},e.prototype.addModel=function(e){e&&!this.modelExists(e.id,e.packageId)&&this.modelCollectionService.addModel(e)},e.prototype.deleteModel=function(e,t){t=this.findModels(e,t);if(!_.isEmpty(t))for(var o=0,r=t;o<r.length;o++){var a=r[o],i=this.telemetryService.startEvent(n.telemetry.DashboardDeleteDataset);this.modelExists(e,a.packageId)?this.datasetStore.delete(a.contract,!1,i):i.resolve()}},e.prototype.modelExists=function(t,o){return-1<_.findIndex(this.models,(function(e){return e.id===t&&e.packageId===o}))},e.prototype.getModelRefreshSchedule=function(e,t){return this.findModel(e,t).contract.refreshSchedule},e.prototype.findModel=function(e,t,o){e=this.findModels(e);if(!_.isEmpty(e))return 1===e.length?e[0]:null==t||!(t=this.getModelByPackageId(e,t))&&o?(t=_.find(e,(function(e){return r.hasFlag(e.getPermissions(),7)})))||e[0]:t},e.prototype.findModels=function(t,o){var e=this.userExplorableModels;return o?_.filter(e,(function(e){return e.id===t&&e.packageId===o})):_.filter(e,(function(e){return e.id===t}))},e.prototype.findModelByDBName=function(t,o){var e=this.userExplorableModels,r=o?_.find(e,(function(e){return e.dbName===t&&e.packageId===o})):this.findFirstOwnedModelByDBName(t);return r=r||o?r:_.find(e,(function(e){return e.dbName===t}))},e.prototype.findFirstOwnedModelByDBName=function(t){return _.find(this.userExplorableModels,(function(e){return e.dbName===t&&7==(7&e.getPermissions())}))},e.prototype.findFirstExplorableModelByDBName=function(t){var o=this;return _.find(this.userExplorableModels,(function(e){return e.dbName===t&&o.permissionService.isExplorableModel(e)}))},e.prototype.findModelsByPackageId=function(e){return this.getModelsByPackageId(this.userExplorableModels,e)},Object.defineProperty(e.prototype,"editableModels",{get:function(){var t=this;return _.filter(this.models,(function(e){return t.editableModel(e)}))},enumerable:!1,configurable:!0}),e.prototype.editableModel=function(e){return null!=e&&!e.contract.isHidden&&o.PermissionsUtils.canReshare(e.getPermissions())&&null==e.contract.originalModelId},e.prototype.isExplorableNonLegacySampleModel=function(e){var t=e.getPermissions();return e.contentProviderId!==o.constants.samplesContentProviderId&&(this.permissionService.isExplorableModel(e)||r.hasFlag(t,17))},e.prototype.isActionAllowed=function(e,t){return!(this.isInsightAppEnabled&&r.hasFlag(e.deniedActions,t))},Object.defineProperty(e.prototype,"copyAndEditModels",{get:function(){var t=this;return _.filter(this.models,(function(e){return t.isExplorableNonLegacySampleModel(e)}))},enumerable:!1,configurable:!0}),e.prototype.renameModel=function(e,t,o){_.isEmpty(e.trim())||(t=this.findModel(t,o))&&t.contract.displayName!==e&&(o=this.telemetryService.startEvent(n.telemetry.DashboardRenameDataset),this.datasetStore.rename(t.contract,e,o))},e.prototype.updateModelQnaFeatures=function(e,t){var o=this.promiseFactory.defer(),r=this.telemetryService.startEvent(n.telemetry.DashboardUpdateModelQnaFeatures,{cortanaValue:t.cortanaEnabled,qnaValue:t.powerBIQnaEnabled,lsdlSharingPermission:t.lsdlSharingPermission});return this.modelHttpService.updateModelQnaFeatures(e,t,r.event).then((function(){r.resolve(),o.resolve({})}),(function(){r.reject(),o.reject()})),o.promise},e.prototype.updateFeaturedQuestions=function(e,t){var o=this.promiseFactory.defer(),r=this.telemetryService.startEvent(n.telemetry.DashboardUpdateFeaturedQuestions,{count:t.length});return this.modelHttpService.updateFeaturedQuestions(e,t,r.event).then((function(){r.resolve(),o.resolve({})}),(function(){r.reject(),o.reject()})),o.promise},Object.defineProperty(e.prototype,"userExplorableModels",{get:function(){return this.sharedDatasetDiscoveryEnabled?this.completeUsableModelList:this.models},enumerable:!1,configurable:!0}),e.prototype.getModelByPackageId=function(e,t){return _.find(e,(function(e){return e.packageId===t}))},e.prototype.getModelsByPackageId=function(e,t){return _.filter(e,(function(e){return e.packageId===t}))},e.prototype.subscribe=function(e){this.modelCollectionService.subscribe(e)},e.prototype.unsubscribe=function(e){this.modelCollectionService.unsubscribe(e)},e.prototype.subscribeDataset=function(){var a=this;this.appMetadataService.getAppMetadata().then((function(){a.datasetStore.datasets.subscribe((function(e){var r=a.modelCollectionService;r.models=e.map((function(e){var t=e.dataset,o=r.findModel(t.id,t.packageId);return o?o.contract!==t&&a.mergeModel(o,t):o=a.dataSetConverter.convertModel(t),o.categories=e.categories,o})),a.completeUsableModelList=_.concat(a.models,a.explorableDatasets),a._modelsDeferred.resolve(a.modelCollectionService.models)}))}))},e.prototype.subscribeExplorableDatasets=function(){var r=this;this.datasetStore.explorableDatasets.subscribe((function(e){var o=_.keyBy(r.explorableDatasets,(function(e){return e.id}));r.explorableDatasets=_.map(e,(function(e){var t=o[e.id];return t?t.contract!==e&&r.mergeModel(t,e):t=r.dataSetConverter.convertModel(e),t})),r.completeUsableModelList=_.concat(r.models,r.explorableDatasets)}))},e.prototype.populateSharedModelInfo=function(){var e;return this.sharedDatasetDiscoveryEnabled?(e=this.promiseFactory.defer(),this.datasetStore.loadShared(e),e.promise):this.promiseFactory.reject()},e.prototype.isLinked=function(e,t){var o;return!!e&&(null==(o=e.folderId)||o!==t)&&(null==o&&null!=t||(o&&t?o!==t:(t=e.permissions,(null!=o||!r.hasFlag(t,2))&&r.hasFlag(t,8))))},e.prototype.mergeModel=function(e,t){var o=this;e&&t&&(e.contract=t,e.id=t.id||e.id,e.isNew=t.isNew||e.isNew,e.getPermissionsCallback=function(){return o.permissionService.getModelEffectivePermissions(t)},e.name=t.name||e.name,e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,e.fileName=t.fileName||e.fileName,e.packageId=t.packageId||e.packageId,e.packageVersion=t.packageVersion||e.packageVersion,e.contentProviderId=t.contentProviderId||e.contentProviderId,e.packagePublishStatus=(null!=t.packagePublishStatus?t:e).packagePublishStatus,e.isRefreshInProgress=t.currentRefreshStartingTime&&a.convertRefreshTimeToJsDateTime(t.currentRefreshStartingTime).getTime()+18e5>Date.now(),e.cloudRlsEnabled=t.cloudRlsEnabled,e.realTimeMode=t.realTimeMode,e.isHidden=e.isHidden&&t.isHidden)},e);function e(e,t,o,r,a,i,n,s,c,d){var l=this;this.telemetryService=e,this.dataSetConverter=t,this.modelHttpService=o,this.appMetadataService=r,this.promiseFactory=a,this.modelCollectionService=i,this.permissionService=n,this.asyncFeatureSwitchService=s,this.datasetStore=c,this.datasetRefreshListener=d,this.explorableDatasets=[],this.completeUsableModelList=[],this._modelsDeferred=this.promiseFactory.defer(),this.asyncFeatureSwitchService.getFeatureSwitches().then((function(e){l.isInsightAppEnabled=e.insightApps,l.sharedDatasetDiscoveryEnabled=e.sharedDatasetDiscovery,l.subscribeDataset(),l.sharedDatasetDiscoveryEnabled&&l.subscribeExplorableDatasets()}))}o.ModelService=l})(powerbi=powerbi||{}),(function(m){var e,i,t,n,a,h;function o(e,t,o,r,a,i,n,s,c,d,l,p,u){this.asyncFeatureSwitchService=i,this.workbookStore=u,this.workbookCollectionService=l,this.telemetryService=t,this.rootScope=e,this.errorService=o,this.workbookHttpService=r,this.localizationService=a,this.promiseFactory=n,this.tutorialDataStore=s,this.compile=c,this.localFileService=d,this.permissionService=p,this.wopiDataTTL=new Array,this.deferredWopiData=Array(),this.workbooksDeferred=n.defer(),this.replaceWorkbookScope=this.rootScope.$new(),this.replaceWorkbookScope.shouldReplaceLocalWorkbook=!1}e=m.dataServices||(m.dataServices={}),n=m.common.constants,(t=i=e.EwaNamedItemType||(e.EwaNamedItemType={}))[t.NamedRange=0]="NamedRange",t[t.Parameter=1]="Parameter",t[t.Table=2]="Table",t[t.PivotTable=3]="PivotTable",t[t.Chart=4]="Chart",t[t.WebExtension=5]="WebExtension",e.createWorkbookService=function(e,t,o,r,a,i,n,s,c,d,l,p,u){return new h(e,t,o,r,a,i,n,s,c,d,l,p,u)},a=".xlsx,.xlsm",Object.defineProperty(o.prototype,"workbooks",{get:function(){return this.workbookCollectionService.workbooks},set:function(e){this.workbookCollectionService.workbooks=e},enumerable:!1,configurable:!0}),o.prototype.postUploadWorkbookErrorMessage=function(e){this.postErrorForWorkbook(e,"UploadExcel_FailedToUploadWorkbook_Title","UploadExcel_FailedToUploadWorkbook_Message")},o.prototype.postReplaceWorkbookErrorMessage=function(e){this.postErrorForWorkbook(e,"UploadExcel_FailedToReplaceWorkbook_Title","UploadExcel_FailedToReplaceWorkbook_Message")},o.prototype.postErrorForWorkbook=function(e,t,o){var r,a=e.headers(m.common.PowerBIErrorHeader);a&&(r=(r=m.common.KnownContentProviderErrors[n.excelContentProviderId])&&r[a])&&r.messageId&&(o=r.messageId),this.errorService.error(this.localizationService.get(o),o,{requestId:e.requestId,statusCode:e.status.toString(),title:this.localizationService.get(t)})},o.prototype.replaceLocalWorkbook=function(e){var t=this,e=this.findWorkbookByUniqueId(e),o=(this.replaceWorkbookScope.workbookToUpdate=e,this.promiseFactory.defer()),r=function(){t.localFileService.chooseLocalFile(o,a)};o.promise.then((function(e){t.getUserConsentToReplace(r,e)})),r=function(){t.replaceWorkbook()},this.localFileService.chooseLocalFile(o,a)},o.prototype.showReplaceWorkbookTutorialIfNeeded=function(e){var t=this;this.neverShowUpdateExplanation=this.tutorialDataStore.hasKey(o.UpdateLocalWorkbookExplanation),this.neverShowUpdateExplanation?e():this.showInputDialog("ReplaceLocalWorkbook_Title","ReplaceLocalWorkbook_Message","ReplaceLocalWorkbook_ReplaceFile","UploadReplace_CancelButton",e,"Generic_DontShowThisAgain",(function(){t.neverShowUpdateExplanation=!t.neverShowUpdateExplanation}))},o.prototype.getUserConsentToReplace=function(e,t){t&&(t=(this.replaceWorkbookScope.localWorkbookToUpload=t).name,this.replaceWorkbookScope.workbookToUpdate&&this.replaceWorkbookScope.workbookToUpdate.displayNameWithExtension.toLowerCase()!==t.toLowerCase()?this.showInputDialog("ReplaceLocalWorkbook_DifferentName_Title","ReplaceLocalWorkbook_DifferentName_Message","ReplaceLocalWorkbook_ReplaceFile","UploadReplace_CancelButton",e):this.showReplaceWorkbookTutorialIfNeeded(e))},o.prototype.showInputDialog=function(e,t,o,r,a,i,n){var s,c=this,d=this.errorService.control(),r=[new InJs.ModalDialogAction(this.localizationService.get(o),function(){d.hideDialog(),c.dismissExplanationPermanentlyIfNeeded(),a()}),new InJs.ModalDialogAction(this.localizationService.get(r),function(){d.hideDialog()})],i=(i&&(s=new InJs.ModalDialogAction(this.localizationService.get(i),function(){n()})),this.localizationService.get(e)),e=this.localizationService.get(t);d.showCustomDialog(i,angular.element("<div></div>").text(e),r,(function(e){e.parent().find('input[value="'+c.localizationService.get(o)+'"]').focus()}),!1,null,null,null,null,null,null,null,null,null,s)},o.prototype.dismissExplanationPermanentlyIfNeeded=function(){var e;this.neverShowUpdateExplanation&&(e=this.telemetryService.startEvent(m.telemetry.DashboardUpdateLocalWorkbookNeverShowExplanation),this.tutorialDataStore.setKey(o.UpdateLocalWorkbookExplanation,!0,e))},o.prototype.replaceWorkbook=function(){this.replaceWorkbookScope.shouldReplaceLocalWorkbook=!0,this.updateLocalWorkbookElement||(this.updateLocalWorkbookTemplate=angular.element(o.HtmlTemplateUpdate),this.updateLocalWorkbookElement=this.compile(this.updateLocalWorkbookTemplate)(this.replaceWorkbookScope),$("body").append(this.updateLocalWorkbookElement)),this.replaceWorkbookScope.$applyAsync()},o.prototype.finishReplacingLocalWorkbook=function(){this.replaceWorkbookScope.shouldReplaceLocalWorkbook=!1},o.prototype.onWorkbookDeleted=function(o,r){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.workbookStore.findById(o,r)];case 1:return t=e.sent(),this.workbookStore.delete(t,!0),[2]}}))}))},o.prototype.getWorkbookContracts=function(){return this.workbookCollectionService.getWorkbookContracts()},Object.defineProperty(o.prototype,"copyAndEditWorkbooks",{get:function(){var t=this.permissionService;return _.filter(this.workbooks,(function(e){e=t.getWorkbookEffectivePermissions(e.contract);return 2==(2&e)||17==(17&e)}))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"editAndReShareWorkbooks",{get:function(){var t=this.permissionService;return _.filter(this.workbooks,(function(e){e=t.getWorkbookEffectivePermissions(e.contract);return 2==(2&e)&&4==(4&e)}))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"lastUpdatedTimestamp",{get:function(){return this._lastUpdatedTimestamp},enumerable:!1,configurable:!0}),o.prototype.ensureWorkbookInitialization=function(){return this.workbooksDeferred.promise},o.prototype.findWorkbook=function(t,o){return o?_.find(this.workbooks,(function(e){return e.id===t&&e.packageId===o})):_.find(this.workbooks,(function(e){return e.id===t&&e.isOwner()}))},o.prototype.findWorkbookByEtagHash=function(t){return _.find(this.workbooks,(function(e){return e.contract.etagHash===t}))},o.prototype.findWorkbookByUniqueId=function(t){return _.find(this.workbooks,(function(e){return e.uniqueId===t}))},o.prototype.getWorkbookUniqueId=function(e){return e.uniqueId},Object.defineProperty(o.prototype,"originalWorkbooks",{get:function(){var t=this.permissionService;return _.filter(this.workbooks,(function(e){return e.isOwner()&&t.isOriginalWorkbook(e)}))},enumerable:!1,configurable:!0}),o.prototype.renameWorkbook=function(e,t,o){_.isEmpty(e.trim())||(t=this.findWorkbook(t,o))&&(o=this.telemetryService.startEvent(m.telemetry.DashboardRenameWorkbook),this.workbookStore.rename(t.contract,e,o))},o.prototype.removeWorkbook=function(r,a,i,n){return __awaiter(this,void 0,m.Promise,(function(){var t,o;return __generator(this,(function(e){switch(e.label){case 0:return t=this.telemetryService.startEvent(m.telemetry.DashboardRemoveWorkbook,{storageProvider:i,contentProvider:n}),[4,this.workbookStore.findById(r,a)];case 1:return o=e.sent(),this.workbookStore.delete(o,!1,t),[2]}}))}))},o.prototype.haveWorkbookEmbedAccessData=function(e){var t=this.deferredWopiData[e],e=this.wopiDataTTL[e];return!(!t||e&&!(e>(new Date).getTime()))},o.prototype.getWorkbookEmbedAccessData=function(t,e,o){var r,a,i=this;return r=o?this.telemetryService.startChildEvent(o,m.telemetry.DashboardGetWorkbookWopiAccessInformation):this.telemetryService.startEvent(m.telemetry.DashboardGetWorkbookWopiAccessInformation),(this.haveWorkbookEmbedAccessData(t)?(r.resolve(),this.deferredWopiData[t]):(o=this.promiseFactory.defer(),this.deferredWopiData[t]=o,this.wopiDataTTL[t]=null,a=!1,this.workbookHttpService.getWorkbookWopiData(t,r.event).then((function(e){e.data&&e.data.accessToken&&e.data.url?(e=e.data,i.wopiDataTTL[t]=e.accessTokenTtl,i.deferredWopiData[t].resolve(e),r.resolve()):a=!0}),(function(){a=!0})).finally((function(){a&&(i.deferredWopiData[t].reject(),i.deferredWopiData[t]=null,r.reject())})),o)).promise},o.prototype.createExcelWebAppEmbedUrlParams=function(e,t){e=[{key:"dsdiv",value:e},{key:"dswp",value:"1"},{key:"dsts",value:"None"},{key:"dsat",value:"1"},{key:"dspti",value:"1"},{key:"dsfl",value:"1"},{key:"dsacs",value:this.asyncFeatureSwitchService.featureSwitches.ffxlChartSelectionEnabled?"1":"0"},{key:"dsrc",value:"pplr"}];return t&&e.push({key:"dssc",value:t}),e.map((function(e){return"&"+e.key+"="+e.value})).join("")},o.prototype.embedWorkbook=function(o,r,a,i,n,s,c,d,e,l){var p,t,u,h=this;if(null!==r&&null!==a)return p=this.promiseFactory.defer(),t=this.promiseFactory.defer(),u=e?"&wdPublishedInPbiHint=true":"",t.promise.then((function(){var e=h.createExcelWebAppEmbedUrlParams(r.targetDiv,l),e=a+"&access_token="+i+"&access_token_ttl="+n+e+u,t=h.promiseFactory.defer();t.promise.then((function(e){e.getSucceeded()?(h.telemetryService.logEvent(m.telemetry.DashboardWorkbookEmbeddingExternalSuccess,{etagHash:o,correlationId:e.getCorrelationId(),storageProvider:s,permissions:d,contentProvider:c}),p.resolve({ewaControl:e.getReturnValue(),window:r})):(h.telemetryService.logEvent(m.telemetry.DashboardWorkbookEmbeddingExternalFailure,{etagHash:o,errorCode:e.getCode(),errorDescription:e.getDescription(),correlationId:e.getCorrelationId(),storageProvider:s,permissions:d,contentProvider:c}),p.reject())}),(function(){h.telemetryService.logEvent(m.telemetry.DashboardWorkbookEmbeddingExternalFailure,{etagHash:o,errorCode:-1,storageProvider:s,permissions:d,contentProvider:c}),p.reject()})),r.loadEwaScripts(e,t)})),r.loadEvent=t,r.loaded&&t.resolve(null),p.promise},o.prototype.getDefaultTileTitle=function(e,t){var o=e.sheetName;return o?t+=", "+o.replace(/\''/g,"'"):1<(o=e.item.split("!")).length&&(t+=", "+o[0].substr(1,o[0].length-2)),t},o.prototype.getDefaultTileSubtitle=function(e){var t=e.split("!");return 1<t.length?t[1]:e},o.prototype.getTileSelectionQuery=function(e,t,o,r){var a="";return o===i.Chart&&r&&(a="Sheets('"+r+"')/"),a+=this.getNamedItemTypeAsString(o)+"('",e?a+=e:t&&(a+=t),encodeURIComponent(a+"')")},o.prototype.encodeImageTileQueryString=function(e){e=encodeURI(e);return e=(e=(e=e.replace(/\'/g,"%27")).replace(/\(/g,"%28")).replace(/\)/g,"%29")},o.prototype.getNamedItemTypeAsString=function(e){switch(e){case i.NamedRange:return"Ranges";case i.Parameter:return"Parameters";case i.Table:return"Tables";case i.PivotTable:return"PivotTables";case i.Chart:return"Charts"}return"Ranges"},o.prototype.getWorkbookTilePreviewImageUrl=function(o){var r=this,a=this.promiseFactory.defer();return this.getWorkbookEmbedAccessData(o.workbookId,o.packageId).then((function(e){var t;o.$config.workbookTile?(t=e.url.replace(/ExcelJs.ashx/i,"/XlRestInternal.aspx"),t+="&framemode=proxy&wdRestQuery=$format=image&wdRestPart=Model/"+r.encodeImageTileQueryString(r.getTileSelectionQuery(o.$config.workbookTile.item,o.$config.workbookTile.activeSelection,o.$config.workbookTile.itemType,o.$config.workbookTile.sheetName))+"&access_token="+e.accessToken+"&access_token_ttl="+e.accessTokenTtl,a.resolve(t)):a.reject()}),(function(){a.reject()})),a.promise},o.prototype.getWorkbookTileBestImageUrl=function(e){if(e.hasImages()){var t=e.images,o=-1,r=-1,a=e.tileModel.layoutPosition,i=m.common.GridLayoutConstants.getDefaultGridItemViewport({colSpan:a.width,rowSpan:a.height}),n=Number.MAX_VALUE,s=Number.MIN_VALUE,a=window.devicePixelRatio;if(i.width=i.width*a,i.height=i.height*a,e.keepOriginalContentSize)return t[0].imageUrl,jsCommon.Utility.getAbsoluteUri(t[0].imageUrl);for(var c=0;c<t.length;c++){t[c].width>s&&(s=t[c].width,r=c);var d=t[c].width-i.width,l=t[c].height-i.height,d=Math.max(d,l);0<=d&&d<n&&(n=d,o=c)}return t[o=-1===o?r:o].imageUrl,jsCommon.Utility.getAbsoluteUri(t[o].imageUrl)}return e.image?"data:image/png;base64,"+e.image:""},o.prototype.setModelDynamicImageUrl=function(e){e.dynamicImageUrl=this.getWorkbookTileBestImageUrl(e),e.dynamicImageUrl||(e.dynamicImageUrl=e.previewImageUrl)},o.prototype.getWorkbooks=function(){return this.workbooksDeferred.promise.then((function(e){return e.workbooks}))},o.prototype.subscribe=function(e){this.workbookCollectionService.subscribe(e)},o.prototype.unsubscribe=function(e){this.workbookCollectionService.unsubscribe(e)},o.HtmlTemplateUpdate="<content-provider-local-file selected-file='localWorkbookToUpload' is-update-from-element-flow='true' ng-if='shouldReplaceLocalWorkbook' element-to-update='workbookToUpdate'></content-provider-local-file>",o.UpdateLocalWorkbookExplanation="updateLocalWorkbookExplanation",h=o,e.WorkbookService=h})(powerbi=powerbi||{}),(function(e){var t=e.dataServices||(e.dataServices={}),o=e.common.NotifyCollection,r=(t.createWorkbookCollectionService=function(){return new r},Object.defineProperty(a.prototype,"workbooks",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e)},enumerable:!1,configurable:!0}),a.prototype.getWorkbookContracts=function(){return _.map(this.workbooks,(function(e){return e.contract}))},a.prototype.addWorkbook=function(e){this.collection.addItem(e)},a.prototype.removeWorkbook=function(t,o){var e=this.collection.deleteItems((function(e){return e.id===t&&e.packageId===o}));return _.head(e)},a.prototype.onAdded=function(e){for(var t=0,o=this.listeners;t<o.length;t++){var r=o[t];r.onWorkbookAdded&&r.onWorkbookAdded(e)}},a.prototype.onDeleted=function(e){for(var t=0,o=this.listeners;t<o.length;t++){var r=o[t];r.onWorkbookDeleted&&r.onWorkbookDeleted(e)}},a.prototype.onReset=function(){for(var e=0,t=this.listeners;e<t.length;e++){var o=t[e];o.onWorkbooksReset&&o.onWorkbooksReset()}},a.prototype.subscribe=function(e){this.listeners.length<1&&this.collection.subscribe(this),this.listeners.push(e)},a.prototype.unsubscribe=function(e){_.pull(this.listeners,e),this.listeners.length<1&&this.collection.unsubscribe(this)},a);function a(){this.listeners=[],this.collection=new o}})(powerbi=powerbi||{}),(function(y){var a,e;function t(){e||(angular.module("powerbi.dataServices",[]),y.common.initializeAngularModule(),angular.module("powerbi.dataServices",["powerbi.common","powerbi.visualHost"]).factory("dashboardCollection",[function(){return y.dataServices.createDashboardCollectionService()}]).factory("modelCollection",[function(){return y.dataServices.createModelCollectionService()}]).factory("packageCollection",[function(){return y.dataServices.createPackageCollectionService()}]).factory("reportCollection",[function(){return y.dataServices.createReportCollectionService()}]).factory("workbookCollection",[function(){return y.dataServices.createWorkbookCollectionService()}]).factory("reportService",["telemetryService","reportModelConverter","appMetadataService","promiseFactory","reportCollection","reportStore","groupStore",function(e,t,o,r,a,i,n){return y.dataServices.createReportService(e,t,o,r,a,i,n)}]).factory("workbookService",["$rootScope","telemetryService","errorService","workbookHttpService","localizationService","asyncFeatureSwitchService","promiseFactory","tutorialDataStore","$compile","localFileService","workbookCollection","permissionService","workbookStore",function(e,t,o,r,a,i,n,s,c,d,l,p,u){return y.dataServices.createWorkbookService(e,t,o,r,a,i,n,s,c,d,l,p,u)}]).factory("modelService",["telemetryService","datasetModelConverter","modelHttpService","appMetadataService","promiseFactory","modelCollection","permissionService","asyncFeatureSwitchService","datasetStore","datasetRefreshListener",function(e,t,o,r,a,i,n,s,c,d){return y.dataServices.createModelService(e,t,o,r,a,i,n,s,c,d)}]).factory("dashboardDataService",["dashboardHttpService","groupStore","promiseFactory","dataServiceModelConverter","dataServiceModelMerger","modelService","dashboardCollection","$timeout","dashboardStore","appMetadataService","permissionService","reportService","datasetRefreshListener","notificationToast","workbookService","reportStore",function(e,t,o,r,a,i,n,s,c,d,l,p,u,h,m,b){return y.dataServices.createDashboardDataService(e,t,o,r,a,i,n,s,c,d,l,p,u,h,m,b)}]).factory("dashboardSyncService",["$rootScope","dashboardDataService","dashboardHttpService","dataServiceModelConverter","dataServiceModelMerger","modelService","promiseFactory","reportService","resourcePackageListenerService","resourcePackagesService","telemetryService","workbookService","dashboardStore","globalEventBridge","featureSwitchService","publicCustomVisualService",function(e,t,o,r,a,i,n,s,c,d,l,p,u,h,m,b){return y.dataServices.createDashboarSyncService(e,t,o,r,a,i,n,s,c,d,l,p,u,h,m,b)}]).factory("dataServiceModelConverter",["visualHostAuthenticationService","explorationSerializer","featureSwitchService","geocoder","geolocationService","localizationService","moduleLoader","permissionService","promiseFactory","reportModelConverter","telemetryService","themeService","tileConfigUpgraderService","visualHostTooltipServiceFactory","visualPlugin","appModelConverter","$injector","datasetModelConverter","packageModelConverter",function(e,t,o,r,a,i,n,s,c,d,l,p,u,h,m,b,f,v,g){return y.dataServices.models.createDataServiceModelConverter(e,t,o,r,a,i,n,s,c,d,l,p,u,h.create(),y.explore.services.createVisualPluginOps(m,o),m,b,f,v,g)}]).factory("dataServiceModelMerger",["dataServiceModelConverter","permissionService",function(e,t){t=y.dataServices.models.createDataServiceModelMerger(e,t);return e.setModelMerger(t),t}]).factory("packageService",["packageModelConverter","packageCollection","promiseFactory","packageStore",function(e,t,o,r){return y.dataServices.createPackageService(e,t,o,r)}]).factory("appService",["promiseFactory","dataServiceModelConverter","appStore","dataServiceModelMerger",function(e,t,o,r){return a.createAppService(e,t,o,r)}]),e=!0)}(a=y.dataServices||(y.dataServices={})).initializeAngularModule=t,e=!1,t()})(powerbi=powerbi||{}),(function(e){((e=e.dataServices||(e.dataServices={})).utils||(e.utils={})).generateFiltersDescription=function(e,t,o,r,a,i){var n={filtersNamesAndRestatements:[]};if(t&&!_.isEmpty(t.dataFiltersUnmerged))for(var s=r.capabilities(o.visualType),c=0,d=t.dataFiltersUnmerged;c<d.length;c++){var l=d[c];if(!l.isHidden){l=a.getFilterRestatementForOverlay(l,e,s,null,o);if(!_.isEmpty(l))for(var p=0,u=l;p<u.length;p++){var h=u[p];n.filtersNamesAndRestatements.push({displayName:h.fieldName,qualifiedDisplayName:h.fieldNameToolTip,restatement:h.restatements.join(i.get("ListJoin_Separator"))})}}}return n}})(powerbi=powerbi||{});;
"use strict";var powerbi;!(function(e){(e=(e=e.explore||(e.explore={})).events||(e.events={})).saveExploration={name:"saveExploration",type:3},e.saveAsExploration={name:"saveAsExploration",type:3}})(powerbi=powerbi||{}),(function(t){var o=t.telemetry||(t.telemetry={}),e=jsCommon.Utility,i=t.telemetryEventFactory,r=t.telemetry.EventFactories;e?e.generateGuid:Function.prototype,o.ExplorationAppBarActionEventName="PBI.ExplorationAppBar.Action",o.ExplorationAppBarAction=r[o.ExplorationAppBarActionEventName]=function(e){return i({name:o.ExplorationAppBarActionEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.ExplorationAppBarActionLoggers,logExpAssignment:!0})},o.ExplorationAppBarViewDatasetEventName="PBI.ExplorationAppBar.ViewDataset",o.ExplorationAppBarViewDataset=r[o.ExplorationAppBarViewDatasetEventName]=function(e){return i({name:o.ExplorationAppBarViewDatasetEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.ExplorationAppBarViewDatasetLoggers,logExpAssignment:!0})},o.FailureDuringModelLoadEventName="PBI.FailureDuringModelLoad",o.FailureDuringModelLoad=r[o.FailureDuringModelLoadEventName]=function(e){return i({name:o.FailureDuringModelLoadEventName,info:e,category:t.TelemetryCategory.CriticalError,loggers:o.FailureDuringModelLoadLoggers})},o.FilterMigrationPhaseTwoServiceActionEventName="PBI.FilterMigrationPhaseTwoServiceAction",o.FilterMigrationPhaseTwoServiceAction=r[o.FilterMigrationPhaseTwoServiceActionEventName]=function(e){return i({name:o.FilterMigrationPhaseTwoServiceActionEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.FilterMigrationPhaseTwoServiceActionLoggers})},o.InitializeExplorationErrorEventName="PBI.InitializeExplorationError",o.InitializeExplorationError=r[o.InitializeExplorationErrorEventName]=function(e){return i({name:o.InitializeExplorationErrorEventName,info:e,category:t.TelemetryCategory.CriticalError,loggers:o.InitializeExplorationErrorLoggers})},o.QuickExploreEventName="PBI.QuickExplore",o.QuickExplore=r[o.QuickExploreEventName]=function(e){return i({name:o.QuickExploreEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.QuickExploreLoggers})},o.QuickCreateShareReportEventName="PBI.QuickCreate.ShareReport",o.QuickCreateShareReport=r[o.QuickCreateShareReportEventName]=function(e){return i({name:o.QuickCreateShareReportEventName,info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.QuickCreateShareReportLoggers,logExpAssignment:!0})}})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).exploration||(e.exploration={})).htmlTemplate||(e.htmlTemplate={})).put=function(e){e.put("components/appBarFlyoutMenu/appBarFlyoutMenu.html",'<button class="dropdown-item {{$ctrl.menuItemClass}}" ng-click="$ctrl.openFlyout($event); $event.stopPropagation(); $event.preventDefault()" ng-disabled="$ctrl.flyoutItem.disabled" ng-class="{\'selected\': $ctrl.flyoutItem.checked}" ng-attr-data-unique-id="{{ $ctrl.flyoutItem.action ? \'appBar-\' + $ctrl.menuOverlayName + \'-\' + $ctrl.flyoutItem.action : undefined }}" role="menuitem" aria-haspopup="true"><div class="dropdown-content {{::$ctrl.flyoutItem.itemClass}}"><i class="glyphicon glyph {{::$ctrl.flyoutItem.itemClass}}" ng-class="::{\'glyph-small\': $ctrl.glyphSmall}" ng-attr-aria-hidden="true" title="{{::$ctrl.flyoutItem.tooltip || $ctrl.flyoutItem.text}}"></i><span class="dropdown-label" ng-bind="::$ctrl.flyoutItem.text" title="{{::$ctrl.flyoutItem.tooltip || $ctrl.flyoutItem.text}}"></span><span ng-if="::$ctrl.flyoutItem.description" class="dropdown-description" ng-bind="::$ctrl.flyoutItem.description"></span><i class="glyphicon pbi-glyph-chevronrightmedium glyph-small" title="{{::$ctrl.flyoutItem.tooltip || $ctrl.flyoutItem.text}}"></i></div></button>'),e.put("views/dropdowns/appBarMenu.html",'<dropdown-overlay dropdown-overlay-name="{{menuOverlayName}}" on-close="onClose()"><ul class="angular-dropdown explorationAppBarMenu active appThemeable" ng-class="{dark: getMode() === 0, themeableElement: themeable, fluentTheme: fluentThemeEnabled}" focus-trap role="menu"><li ng-repeat="item in getMenuActions() track by $index" ng-switch="::item.type" class="themeYellowDark" role="presentation"><div ng-switch-when="0"><section ng-if="item.checkbox" ng-class="[\'dropdown-item\', \'{{menuItemClass}}\', {\'selected\': item.checked}]"><div class="dropdown-content {{::item.itemClass}}"><i ng-if="item.iconType === \'Glyph\' || !item.iconType" class="glyphicon glyph {{::item.itemClass}}" ng-attr-data-unique-id="{{item.action ? \'appBarMenuIcon-\' + item.action : undefined}}" ng-class="::{\'glyph-small\': glyphSmall}"></i><pbi-office-icon ng-if="item.iconType === \'Svg\'" name="{{::item.itemClass}}" class="{{::item.itemClass}}"></pbi-office-icon><span id="{{$index}}" class="dropdown-label" ng-bind="::item.text" title="{{::item.tooltip || item.text}}"></span><span ng-if="::item.description" class="dropdown-description" ng-bind="::item.description"></span><pbi-toggle ng-model="item.checked" ng-disabled="item.disabled" no-label on-state-text="ToggleSwitchOn" off-state-text="ToggleSwitchOff" ng-change="menuActionSelected(item);" arialabelledby="{{$index}}" ng-attr-data-unique-id="{{item.action ? \'appBarMenu-\' + item.action : undefined}}" ng-attr-aria-checked="{{item.checked != null ? item.checked : undefined }}" ng-class="{\'selected\': item.checked}"></pbi-toggle></div></section> <button ng-if="!item.checkbox" class="dropdown-item {{menuItemClass}}" ng-click="menuActionSelected(item); $event.stopPropagation(); $event.preventDefault()" ng-disabled="item.disabled" ng-class="{\'selected\': item.checked}" ng-attr-aria-checked="{{item.checked != null ? item.checked : undefined }}" ng-attr-data-unique-id="{{item.action ? \'appBarMenu-\' + item.action : undefined}}" role="{{item.checked == null ? \'menuitem\' : \'menuitemradio\'}}"><div class="dropdown-content {{::item.itemClass}}"><i ng-if="item.iconType === \'Glyph\' || !item.iconType" class="glyphicon glyph {{::item.itemClass}}" ng-attr-data-unique-id="{{item.action ? \'appBarMenuIcon-\' + item.action : undefined}}" ng-class="::{\'glyph-small\': glyphSmall}"></i><pbi-office-icon ng-if="item.iconType === \'Svg\'" name="{{::item.itemClass}}" class="{{::item.itemClass}}"></pbi-office-icon><span class="dropdown-label" ng-bind="::item.text" title="{{::item.tooltip || item.text}}"></span><span ng-if="::item.description" class="dropdown-description" ng-bind="::item.description"></span></div></button></div><div ng-switch-when="1" ng-bind="::item.text" ng-attr-data-unique-id="{{ item.action ? \'appBarMenu-\' + item.action : undefined }}"></div><div ng-switch-when="2" class="dropdown-separator" role="separator"></div><app-bar-flyout-menu ng-switch-when="3" flyout-item="item" ng-attr-data-unique-id="{{ item.action ? \'appBarMenu-\' + item.action : undefined }}" menu-overlay-name="menuOverlayName" menu-item-class="menuItemClass" glyph-small="glyphSmall" get-mode="getMode()" menu-action-selected="menuActionSelected($item)"></app-bar-flyout-menu><pbi-lazy-load-modern ng-switch-when="4" [module-path]="item.lazyModulePath" [component-id]=\'item.lazyComponentId\'></pbi-lazy-load-modern></li></ul></dropdown-overlay>')}})(powerbi=powerbi||{}),(function(o){var e,i,t,r;function n(){r||(o.explore.initializeAngularModule(),angular.module("powerbi.explore").run(["scopedProvider",function(e){e.register("explorationAppBarMixins",{services:[],scopedServices:[],fn:function(){return new o.common.MixinProvider([])}})}]).run(["$templateCache",t]),r=!0)}e=(e=o.explore||(o.explore={})).exploration||(e.exploration={}),i=o.common,t=o.explore.exploration.htmlTemplate.put,e.initializeAngularModule=n,r=!(e.registerBuildingBlocksForHost=function(e){var t=[{name:"AppBarFlyoutMenu",blockType:2,consumerHostFlags:24874,factory:o.explore.components.AppBarFlyoutMenu}];i.registerBuildingBlocksForHost(e,t,{componentsTarget:"powerbi.explore.components",directivesTarget:"powerbi.explore.directives"})}),n()})(powerbi=powerbi||{}),(function(e){(e=(e=e.explore||(e.explore={})).constants||(e.constants={})).serverErrorPrefix="ServerError_",e.configureScheduledRefreshLink="https://go.microsoft.com/fwlink/?linkid=844603"})(powerbi=powerbi||{}),(function(e){function t(e,t){this.services=t}e=(e=e.explore||(e.explore={})).controllers||(e.controllers={}),t.createOptions=function(){return{additionalServices:["dropdown","overlayService"]}},t.prototype.$onDestroy=function(){this.services.dropdown.hideAll()},t.prototype.openFlyout=function(e){var t=this,o=this.menuOverlayName+"Flyout",i=this.services.overlayService.getOverlayElement(o);_.isEmpty(i.length)&&(i={menuOverlayName:o,menuItemClass:this.menuItemClass,glyphSmall:this.glyphSmall,themeable:!0,menuActionSelected:function(e){return t.menuActionSelected({$item:e})},getMenuActions:function(){return t.flyoutItem.flyoutActions},getMode:function(){return t.getMode()}},o={anchorElement:$(e.currentTarget),blurNeeded:!1,disableAnimation:!0,preferLeft:!1,horizontal:!0},this.services.dropdown.showMenu(i,"appBarMenu.html",o))},e.AppBarFlyoutMenuController=t})(powerbi=powerbi||{}),(function(e){var t;((t=e.explore||(e.explore={})).components||(t.components={})).AppBarFlyoutMenu={templateUrl:"components/appBarFlyoutMenu/appBarFlyoutMenu.html",controller:e.common.createController(t.controllers.AppBarFlyoutMenuController),bindings:{flyoutItem:"<",menuOverlayName:"<",menuItemClass:"<",glyphSmall:"<",getMode:"&",menuActionSelected:"&"}}})(powerbi=powerbi||{}),(function(e){var t,n,p,a,l;function m(e){var t;if(e)return t=(t=e.exploration)&&t.contract&&t.contract.report,e=e.options&&e.options.isUsageMetricsReport,t&&!e}function o(e,t,o,i,r){return{text:e,description:t,action:r,itemClass:"displayOption "+o,type:DropDownMenuItemType.Item,param:a.toString(n,i).toLowerCase()}}t=(t=e.explore||(e.explore={})).models||(t.models={}),a=jsCommon.EnumExtensions,l=e.visuals.shapeType.shape,(e=n=t.BasicShape||(t.BasicShape={}))[e.Rectangle=0]="Rectangle",e[e.Oval=1]="Oval",e[e.Line=2]="Line",e[e.Triangle=3]="Triangle",e[e.Arrow=4]="Arrow",(e=p=p||{}).Glyph="Glyph",e.Svg="Svg",(e=t.ExplorationAppBarViewModelFactory||(t.ExplorationAppBarViewModelFactory={})).createViewMenuActions=function(e,t,o,i,r,n,a,p,l,s){void 0===s&&(s=!0);var c=[];return(a=1===a)||c.push({text:e.get("ReportAppBar_ViewFitToPage"),action:"FitToPage",itemClass:"pbi-glyph-fittopage2",type:DropDownMenuItemType.Item,disabled:!1,checked:1===r,tooltip:e.get("ReportAppBar_ViewFitToPageDescription")},{text:e.get("FitToWidth"),action:"FitToWidth",itemClass:"pbi-glyph-fittowidth",type:DropDownMenuItemType.Item,disabled:!1,checked:2===r,tooltip:e.get("ReportAppBar_ViewFitToWidthDescription")},{text:e.get("ReportAppBar_ViewActualSize"),action:"ActualSize",itemClass:"pbi-glyph-actualsize",type:DropDownMenuItemType.Item,disabled:!1,checked:3===r,tooltip:e.get("ReportAppBar_ViewActualSizeDescription")},{action:null,type:DropDownMenuItemType.Separator}),c.push(function(e,t){t=[{text:e.get("None"),action:"HighContrastNone",itemClass:"pbi-glyph-blank",type:DropDownMenuItemType.Item,checked:null==t},{text:e.get("HighContrastMode_1"),action:"HighContrast1",itemClass:"pbi-glyph-blank",type:DropDownMenuItemType.Item,checked:"HighContrast1"===t},{text:e.get("HighContrastMode_2"),action:"HighContrast2",itemClass:"pbi-glyph-blank",type:DropDownMenuItemType.Item,checked:"HighContrast2"===t},{text:e.get("HighContrastMode_Black"),action:"HighContrastBlack",itemClass:"pbi-glyph-blank",type:DropDownMenuItemType.Item,checked:"HighContrastBlack"===t},{text:e.get("HighContrastMode_White"),action:"HighContrastWhite",itemClass:"pbi-glyph-blank",type:DropDownMenuItemType.Item,checked:"HighContrastWhite"===t}];return{text:e.get("HighContrastMode"),itemClass:"pbi-glyph-blankflyout",type:DropDownMenuItemType.Flyout,flyoutActions:t}}(e,n)),i&&(c.push({type:DropDownMenuItemType.Separator}),c.push({text:e.get("ReportAppBar_ShowSmartGuides"),action:"ShowSmartGuides",itemClass:"pbi-glyph-smartguides",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:t.getShowSmartGuides(),tooltip:e.get("ReportAppBar_ShowSmartGuidesDescription")}),c.push({text:e.get("ReportAppBar_ShowGrid"),action:"ShowGrid",itemClass:"pbi-glyph-showgrid",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:a?t.getShowGridlinesMobile():t.getShowGridlines(),tooltip:e.get("ReportAppBar_ShowGridDescription")}),c.push({text:e.get("ReportAppBar_SnapToGrid"),action:"SnapToGrid",itemClass:"pbi-glyph-snaptogrid",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:a?t.getSnapToGridMobile():t.getSnapToGrid(),tooltip:e.get("ReportAppBar_SnapToGridDescription")}),c.push({text:e.get("ReportAppBar_LockObjects"),action:"LockObjects",itemClass:"pbi-glyph-lock",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1})),c.push({type:DropDownMenuItemType.Separator}),o.featureSwitches.onObject&&(c.push({text:e.get("Data_Pane_dropdown_option"),action:"ShowDataPane",itemClass:"pbi-glyph-databaseicon",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1,tooltip:e.get("Data_Pane_dropdown_option")}),c.push({text:e.get("Format_Pane_dropdown_option"),action:"ShowFormatPane",itemClass:"chartStylesGallery",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1,tooltip:e.get("Format_Pane_dropdown_option")})),c.push({text:e.get("ReportAppBar_Selection"),action:"ShowCanvasItems",itemClass:"pbi-glyph-show",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1,tooltip:e.get("ReportAppBar_Selection")}),s&&c.push({text:e.get("ReportAppBar_Bookmarks"),action:"ShowBookmarks",itemClass:"pbi-glyph-bookmark",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1,tooltip:e.get("ReportAppBar_Bookmarks")}),i&&!a&&c.push({text:e.get("ReportAppBar_SyncGroupPane"),action:"ShowSyncGroupPane",itemClass:"pbi-glyph-filtersync",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1,tooltip:e.get("ReportAppBar_SyncGroupPane")}),i&&o.featureSwitches.reportCreationCopilot&&c.push({text:e.get("ReportAppBar_ReportCreationCopilotPane"),action:"ShowReportCreationCopilotPane",itemClass:"pbi-glyph-insight",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1,tooltip:e.get("ReportAppBar_ReportCreationCopilotPane")}),i&&p&&m(l)&&c.push({text:e.get("InsightsPane_ButtonText"),action:"GetAutomatedInsightsEdit",itemClass:"pbi-glyph-insight",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1}),c},e.createBookmarksMenuActions=function(){return[{type:DropDownMenuItemType.CustomComponent,lazyModulePath:"@powerbi/WebBookmarksUI/web-bookmarks-ui.module#WebBookmarksUIModule",lazyComponentId:"WebBookmarksComponentId"}]},e.createFileMenuActions=function(e){var t,o=e.localizationService,i=[];return e.showSave&&i.push({text:o.get("ReportAppBar_SaveToDashboard"),description:o.get("ReportAppBar_SaveToDashboardDescription"),action:"SaveToDashboard",itemClass:"pbi-glyph-save",type:DropDownMenuItemType.Item,tooltip:o.get("ReportAppBar_SaveToDashboardDescription")}),e.showSaveAs&&i.push({text:o.get("SaveAs"),description:o.get("ReportAppBar_SaveAsDescription"),action:"SaveAs",itemClass:"pbi-glyph-saveas",type:DropDownMenuItemType.Item,tooltip:o.get("ReportAppBar_SaveAsDescription")}),e.showPrint&&i.push({text:o.get("ReportAppBar_Print"),description:o.get("ReportAppBar_PrintDescription"),action:"Print",itemClass:"pbi-glyph-print",type:DropDownMenuItemType.Item,tooltip:o.get("ReportAppBar_PrintDescription")}),e.showSecurePublishToWeb&&i.push({text:o.get("Embed"),description:o.get("PublishToWebSecure_Description"),action:"SecurePublishToWeb",itemClass:"pbi-glyph-publishtoweb",type:DropDownMenuItemType.Item,tooltip:o.get("PublishToWebSecure_Description")}),e.showSharepointEmbed&&i.push({text:o.get("ReportAppBar_SharePointEmbed"),description:o.get("ReportAppBar_SharePointEmbedDescription"),action:"EmbedSharepoint",itemClass:"pbi-glyph-sharepoint",type:DropDownMenuItemType.Item,tooltip:o.get("ReportAppBar_SharePointEmbedDescription")}),e.showEmbed&&i.push({text:o.get("ReportAppBar_SnapshotEmbed"),description:o.get("ReportAppBar_SnapshotEmbedDescription"),action:"EmbedSnapshot",itemClass:"pbi-glyph-publishtoweb",type:DropDownMenuItemType.Item,tooltip:o.get("ReportAppBar_SnapshotEmbedDescription")}),e.showDiagnostics&&i.push({text:o.get("ReportAppBar_Diagnostics"),description:o.get("ReportAppBar_DiagnosticsDescription"),action:"ShowDiagnosticInfo",itemClass:"pbi-glyph-code",type:DropDownMenuItemType.Item,tooltip:o.get("ReportAppBar_DiagnosticsDescription")}),e.showPowerPoint&&i.push({text:o.get("ReportAppBar_PowerPoint"),description:o.get("ReportAppBar_PowerPointDescription"),action:"ExportPowerPoint",itemClass:"pbi-glyph-powerpoint",type:DropDownMenuItemType.Item,tooltip:o.get("ReportAppBar_PowerPointDescription"),disabled:e.isExportToPowerpointDisabled}),e.showPdf&&i.push({text:o.get("ReportAppBar_Pdf"),description:o.get("ReportAppBar_PdfDescription"),action:"ExportPdf",itemClass:"pbi-glyph-pdf",type:DropDownMenuItemType.Item,tooltip:o.get("ReportAppBar_PdfDescription"),disabled:e.isExportToPDFDisabled}),e.showDownloadReport&&(t=!e.canDownloadReport||e.downloadReportDenied,i.push({text:o.get("Download_File"),description:o.get("Download_File"),action:"DownloadReport",itemClass:"pbi-glyph-download2",type:DropDownMenuItemType.Item,disabled:t,tooltip:o.get(e.downloadReportTooltip)})),i},e.createExploreMenuActions=function(e,t){return[{text:e.get("VisualTable_Show"),action:"SeeData",itemClass:"pbi-glyph-seedata",type:DropDownMenuItemType.Item,disabled:!0,checkbox:!0,tooltip:t.isSeeDataMode?e.get("Ribbon_Tooltip_VisualTable_Disable"):e.get("Ribbon_Tooltip_VisualTable")},{type:DropDownMenuItemType.Separator},{text:e.get("DrillDownLevel"),action:"ExpandVisual",itemClass:"pbi-glyph-expand",type:DropDownMenuItemType.Item,disabled:!0,checked:!1,tooltip:e.get("DrillDownLevel_ToolTip")},{text:e.get("DrillDownLevelGrouped"),action:"ExpandVisualGrouped",itemClass:"pbi-glyph-inline-drill",type:DropDownMenuItemType.Item,disabled:!0,checked:!1,tooltip:e.get("DrillDownLevelGrouped_ToolTip")},{text:e.get("DrillUp"),action:"DrillUp",itemClass:"pbi-glyph-drillup",type:DropDownMenuItemType.Item,disabled:!0,checked:!1,tooltip:e.get("DrillUp_ToolTip")},{type:DropDownMenuItemType.Separator},{text:e.get("DrillDown"),action:"DrillDown",itemClass:"pbi-glyph-drilldowndisabled",type:DropDownMenuItemType.Item,checkbox:!0,disabled:!0,tooltip:t.isDrillDownMode?e.get("DrillMode_ToolTip"):e.get("DrillDown_ToolTip")},{text:e.get("Drillthrough"),action:"Drillthrough",itemClass:"pbi-glyph-drillthrough",type:DropDownMenuItemType.Item,checkbox:!0,disabled:!0,tooltip:t.isDrillthroughMode?e.get("DrillthroughMode_ToolTip"):e.get("Drillthrough_ToolTip")},{text:e.get("DataPointTable_Show"),action:"SeeRecords",itemClass:"pbi-glyph-drilltodetail",type:DropDownMenuItemType.Item,checkbox:!0,disabled:!0,tooltip:t.isDrillToDetailsMode?e.get("Ribbon_Tooltip_DataPointTable_On"):e.get("Ribbon_Tooltip_DataPointTable")}]},e.createBasicShapeMenuActions=function(e){return[o(e.get("ReportAppBar_ShapeRectangle"),e.get("ReportAppBar_ShapeRectangleDescription"),"shapeRectangle",n.Rectangle,"InsertShape"),o(e.get("ReportAppBar_ShapeOval"),e.get("ReportAppBar_ShapeOvalDescription"),"shapeOval",n.Oval,"InsertShape"),o(e.get("ReportAppBar_ShapeLine"),e.get("ReportAppBar_ShapeLineDescription"),"shapeLine",n.Line,"InsertShape"),o(e.get("ReportAppBar_ShapeTriangle"),e.get("ReportAppBar_ShapeTriangleDescription"),"shapeTriangle",n.Triangle,"InsertShape"),o(e.get("ReportAppBar_ShapeArrow"),e.get("ReportAppBar_ShapeArrowDescription"),"shapeArrow",n.Arrow,"InsertShape")]},e.createShapeMenuActions=function(e){for(var t=new Array,o=0,i=[{name:"ReportAppBar_ShapeRectangle",itemClass:"Rectangle_16",arg:{shapeType:l.Rectangle}},{name:"ReportAppBar_ShapeOval",itemClass:"Oval_16",arg:{shapeType:l.Oval}},{name:"Visual_Shape_TriangleIsoc",itemClass:"TriangleIsoc_16",arg:{shapeType:l.TriangleIsoc}},{name:"ReportAppBar_ShapeLine",itemClass:"LineWeb_16",arg:{shapeType:l.Line}},{name:"ReportAppBar_ShapeArrow",itemClass:"ArrowRightWeb_16",arg:{shapeType:l.Arrow}}];o<i.length;o++){var r=i[o];t.push({text:e.get(r.name),action:"InsertShape",itemClass:r.itemClass,type:DropDownMenuItemType.Item,param:r.arg,iconType:p.Svg})}return t},e.createActionButtonMenuActions=function(e,t){var o=new Array,i=[{name:"Generic_LeftArrow",itemClass:"pbi-glyph-back",arg:"leftArrow"},{name:"Generic_RightArrow",itemClass:"pbi-glyph-rightarrow",arg:"rightArrow"},{name:"Reset",itemClass:"pbi-glyph-reload",arg:"reset"},{name:"Generic_Back",itemClass:"pbi-glyph-backarrow",arg:"back"},{name:"ReportAppBar_InfoIcon",itemClass:"pbi-glyph-info",arg:"information"},{name:"Generic_Help",itemClass:"pbi-glyph-help",arg:"help"},{name:"Generic_Qna",itemClass:"pbi-glyph-qna",arg:"qna"},{name:"Generic_Bookmark",itemClass:"pbi-glyph-bookmark",arg:"bookmarks"},{name:"ReportAppBar_Blank",itemClass:"pbi-glyph-blank",arg:"blank"}];null!=t&&t.featureSwitches.applyAllSlicersButton&&(i.push({name:"ReportAppBar_ApplyAllSlicers",itemClass:"ApplyAllSlicersWeb_15x17",arg:"applyAllSlicers",iconType:p.Svg}),i.push({name:"ReportAppBar_ClearAllSlicers",itemClass:"ClearAllSlicersWeb_16",arg:"clearAllSlicers",iconType:p.Svg}));for(var r=0,n=i;r<n.length;r++){var a=n[r];o.push({text:e.get(a.name),action:"InsertActionButton",itemClass:a.itemClass,type:DropDownMenuItemType.Item,param:a.arg,iconType:a.iconType})}return null!=t&&t.featureSwitches.navigatorVisuals&&o.push(function(e){for(var t=new Array,o=0,i=[{name:"Visual_PageNavigator",itemClass:"page",arg:"page"},{name:"Visual_BookmarkNavigator",itemClass:"bookmark",arg:"bookmark"}];o<i.length;o++){var r=i[o];t.push({text:e.get(r.name),action:"InsertNavigator",itemClass:"pbi-navigator-"+r.itemClass,type:DropDownMenuItemType.Item,param:r.arg})}return{text:e.get("ReportAppBar_Navigator"),itemClass:"pbi-glyph-blankflyout",type:DropDownMenuItemType.Flyout,flyoutActions:t}}(e)),o},e.createVisualInteractionsActions=function(e,t){var o=[{text:e.get("ReportAppBar_EditVisualInteractions"),action:"EditVisualInteractionsMode",itemClass:"pbi-glyph-visualinteraction",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1,tooltip:e.get("ReportAppBar_EditVisualInteractionsDescription")}];return o.push({text:e.get("ReportAppBar_DrillFilterOtherVisuals"),action:"DrillFilterOtherVisuals",itemClass:"pbi-glyph-drillFilterOtherVisuals",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1,tooltip:e.get("ReportAppBar_DrillFilterOtherVisualsDescription")}),o},e.createAlignmentMenuActions=function(e){return[{text:e.get("ReportAppBar_Left"),description:e.get("Align_Left"),action:"AlignLeft",itemClass:"alignAction",type:DropDownMenuItemType.Item},{text:e.get("ReportAppBar_Center"),description:e.get("Align_Center"),action:"AlignCenter",itemClass:"alignAction",type:DropDownMenuItemType.Item},{text:e.get("ReportAppBar_Right"),description:e.get("Align_Right"),action:"AlignRight",itemClass:"alignAction",type:DropDownMenuItemType.Item},{text:e.get("Top"),description:e.get("Align_Top"),action:"AlignTop",itemClass:"alignAction",type:DropDownMenuItemType.Item},{text:e.get("Middle"),description:e.get("Align_Middle"),action:"AlignMiddle",itemClass:"alignAction",type:DropDownMenuItemType.Item},{text:e.get("Bottom"),description:e.get("Align_Bottom"),action:"AlignBottom",itemClass:"alignAction",type:DropDownMenuItemType.Item}]},e.createDistributeMenuActions=function(e){return[{text:e.get("ReportAppBar_Horizontal"),description:e.get("ReportAppBar_HorizontalDescription"),action:"DistributeHorizontal",itemClass:"distributeAction",type:DropDownMenuItemType.Item},{text:e.get("ReportAppBar_Vertical"),description:e.get("ReportAppBar_VerticalDescription"),action:"DistributeVertical",itemClass:"distributeAction",type:DropDownMenuItemType.Item}]},e.createReportMoreOptionsMenuItems=function(e,t,o,i,r,n,a){var p=[];return o&&p.push({text:e.get("Report_GenerateQRCode"),action:"GenerateQR",tooltip:e.get("Report_GenerateQRCode"),type:DropDownMenuItemType.Item}),t&&(o=e.get("ReportAppBar_AnalyzeInExcelMenuItem_Text"),i?r||(o=e.format("Permission_ExploreRequiredForFeature",[e.get("ReportAppBar_AnalyzeInExcelMenuItem_Text")])):o=e.get("AnalyzeInExcelDenied_Tooltip"),p.push({text:e.get("ReportAppBar_AnalyzeInExcelMenuItem_Text"),action:"AnalyzeInExcel",tooltip:o,disabled:!i||!r,type:DropDownMenuItemType.Item})),n&&m(a)&&p.push({text:e.get("AutomatedInsights_AppBar_GetInsights"),action:"GetAutomatedInsightsEdit",tooltip:e.get("AutomatedInsights_AppBar_GetInsights"),disabled:!1,type:DropDownMenuItemType.Item}),p}})(powerbi=powerbi||{}),(function(o){var i;function t(e){var t=e&&e.clientError,e=r(e);return _.includes(i.UserErrors,e)?"User":_.includes(i.ExternalErrors,e)?"External":t&&null!=t.source?t.source:"PowerBI"}function r(e){var t=e&&e.serviceError&&e.serviceError.errorCode,e=e&&e.clientError&&e.clientError.code;return t||e||o.ModelFailednoErrorInfo}(i=o.explore||(o.explore={})).UserErrors=[o.DM_GWPipeline_Gateway_CancellationError,o.DM_GWPipeline_Gateway_CancellationOrTimeoutError,o.DM_GWPipeline_Gateway_ImpersonationError,o.DM_GWPipeline_Gateway_InvalidConnectionCredentials,o.DM_GWPipeline_Gateway_TimeoutError,o.DMTS_DatasourceHasNoCredentialError,o.DMTS_NoGatewayWithAllDatasourcesToBindError,o.DMTS_MultipleGatewaysWithAllDatasourcesToBindError,o.DMTS_OAuthTokenRefreshFailedError,o.DMTS_UserNotFoundInADGraphError,o.DMTS_UserLostPermissionToDatasourceError,o.PowerBINotAuthorizedException,o.ModelSizeExceedsSharedCapacityLimit,o.TokenExpired,o.UserNotLicensed,o.RS_AccessDenied,o.RS_AccessDeniedDueToRLSGroup,o.RS_ErrorOpeningConnection,"HttpStatusCode = -1","HttpStatusCode = 401","GroupNotAccessible",o.IgnorableClientError.Code],i.ExternalErrors=[o.DM_GWPipeline_Gateway_ConnectionBrokenException,o.DM_GWPipeline_Client_GatewayUnreachable,o.DM_GWPipeline_Gateway_DataSourceAccessError,o.DM_GWPipeline_Gateway_AdomdConnectError,o.DM_GWPipeline_Gateway_UnprocessedStructureError,o.DM_GWPipeline_Gateway_MashupDataAccessError],i.getTelemetryErrorDetails=function(e){return{errorCode:r(e),errorSource:t(e)}},i.getErrorSource=t,i.getErrorCode=r})(powerbi=powerbi||{}),(function(e){function t(e,t){this.newQueryResultUpdates=[],this.explorationId=e,this.explorationProxy=t}e=(e=e.explore||(e.explore={})).helpers||(e.helpers={}),t.prototype.onNewQueryCacheResultAvailable=function(t){var o=this,e=_.find(this.newQueryResultUpdates,(function(e){return e.visualContainerId===t.visualContainerId}));e?(e.query=t.query,e.dataTransforms=t.dataTransforms):(this.newQueryResultUpdates.push(t),1===this.newQueryResultUpdates.length&&setTimeout((function(){var e={visualQueryResults:_.map(o.newQueryResultUpdates,(function(e){return{visualContainerId:e.visualContainerId,query:e.query,dataTransforms:e.dataTransforms}}))};o.explorationProxy.saveVisualContainerQueries(o.explorationId,e),o.newQueryResultUpdates=[]}),2e3))},e.VisualContainerQueryUpdater=t})(powerbi=powerbi||{});;
"use strict";var powerbi;!(function(e){(e=(e=(e=e.standaloneCommon||(e.standaloneCommon={})).constants||(e.constants={})).ScreenshotEngineActionsServiceOperationNames||(e.ScreenshotEngineActionsServiceOperationNames={})).initialize="initial",e.cancel="canceled",e.complete="complete"})(powerbi=powerbi||{}),(function(e){var n=e.standaloneCommon||(e.standaloneCommon={}),o=n.constants.ScreenshotEngineActionsServiceOperationNames,t=(n.createScreenshotEngineCommunicator=function(e,n){return new t(e,n)},r.prototype.initialize=function(){this.hostService.invokeAndForget(null,o.initialize)},r.prototype.cancel=function(){this.telemetryService.logEvent(e.telemetry.ScreenshotEngineCommunicatorScreenshotCancelled),this.hostService.invokeAndForget(null,o.cancel)},r.prototype.complete=function(){this.telemetryService.logEvent(e.telemetry.ScreenshotEngineCommunicatorScreenshotCompleted),this.hostService.invokeAndForget(null,o.complete)},r);function r(e,n){this.hostService=e,this.telemetryService=n,this.initialize()}})(powerbi=powerbi||{}),(function(o){var e;function n(){e||(o.common.initializeAngularModule(),angular.module("powerbi.standaloneCommon",["powerbi.common"]).factory("screenshotEngineCommunicator",["hostService","telemetryService",function(e,n){return o.standaloneCommon.createScreenshotEngineCommunicator(e,n)}]),e=!0)}(o.standaloneCommon||(o.standaloneCommon={})).initializeAngularModule=n,e=!1,n()})(powerbi=powerbi||{}),(function(n){var o=n.telemetry||(n.telemetry={}),e=jsCommon.Utility,t=n.telemetryEventFactory,r=n.telemetry.EventFactories;e?e.generateGuid:Function.prototype,o.ScreenshotEngineCommunicatorScreenshotCompletedEventName="PBI.ScreenshotEngineCommunicator.ScreenshotCompleted",o.ScreenshotEngineCommunicatorScreenshotCompleted=r[o.ScreenshotEngineCommunicatorScreenshotCompletedEventName]=function(e){return t({name:o.ScreenshotEngineCommunicatorScreenshotCompletedEventName,info:e,category:n.TelemetryCategory.Verbose,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.ScreenshotEngineCommunicatorScreenshotCompletedLoggers})},o.ScreenshotEngineCommunicatorScreenshotCancelledEventName="PBI.ScreenshotEngineCommunicator.ScreenshotCancelled",o.ScreenshotEngineCommunicatorScreenshotCancelled=r[o.ScreenshotEngineCommunicatorScreenshotCancelledEventName]=function(e){return t({name:o.ScreenshotEngineCommunicatorScreenshotCancelledEventName,info:e,category:n.TelemetryCategory.Verbose,optionalParameters:["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","baseVersion","isFireAndForget","inTeams","expAssignment","hostPlatformType","hostPlatformName","sanitized"],loggers:o.ScreenshotEngineCommunicatorScreenshotCancelledLoggers})}})(powerbi=powerbi||{});
this.parseTimeMarkers = this.parseTimeMarkers || {};
var marker = this.parseTimeMarkers['reportembed.bundle.min.js'] || (this.parseTimeMarkers['reportembed.bundle.min.js'] = {});
marker.endEval = window.jsCommon && window.jsCommon.performance && window.jsCommon.performance.now ? window.jsCommon.performance.now() : Date.now(); marker.isExternal = false;
